# Kimchi Invasion — Cursor Context MD (v0.57)
> 목적: 이 문서는 **Cursor 에이전트가 그대로 읽고 구현**할 수 있는 “구현 중심 컨텍스트”다.  
> 원칙: **가정 금지**(불명확하면 질문), **단계적 구현**, **UI/시스템은 단순-확장형**, **중복/누락 없이(MECE)**.

---

## 0. 목차 (이 순서대로 작성/구현)
0) 목차/문서 사용법  
1) 게임 한 줄 정의 + 핵심 재미(디자인 원칙)  
2) 플레이 루프(초반→자동화→프레스티지)  
3) 리소스/지표/용어(Glossary)  
4) 제품 라인/레시피 트리(Act1 기준 + 확장 규칙)  
5) 라인 시스템(라인 설치/철거/할당)  
6) 3레버 시스템(공급/물류/수요) 상세  
7) 자동화(인력/설비/시장/조직) — “아이템 재고” 방식  
8) UI/UX (PC 5열 오픈 / 모바일 5탭) + 인벤/창고 “녹이기” 규칙  
9) 연구 시스템(효소 기반) + 해금/제출 규칙  
10) 업적/통계/메타 진행(로그, 리플레이 동기)  
11) 엔딩/프레스티지(서울타워 → 스타김치십 발사) + 외계물질 보상  
12) Act 확장 로드맵(Act2 글로벌, Act3 우주) — 유저는 자연스럽게 넘어가게  
13) 데이터 모델/상태머신/저장 포맷(구현 가이드)  
14) 구현 체크리스트(스프린트 단위) + 테스트 포인트
15) 세계관/연출/로그북 텍스트 패키지(서사/카피 + 메뉴 UX)  
16) 구현 전 확정 질문(Decision Log) — 모호한 부분을 미리 확정  
---

# 1. 게임 한 줄 정의 + 핵심 재미(디자인 원칙)

## 1.1 한 줄 정의
**김치를 “라인(생산→물류→판매)”으로 굴리며 병목을 조정하고 자동화를 확장해, 최종적으로 서울타워에서 ‘스타김치십’을 발사한 뒤 프레스티지로 반복 성장하는 클리커/운영 게임.**

## 1.2 핵심 재미(절대 유지)
- **클리커 감성**: 초반엔 “내 클릭”이 전부다. (생산/물류/판매 모두 클릭 기반으로 시작)
- **운영 최적화 묘미**:  
  생산이 과하면 재고가 쌓이고, 물류가 약하면 이동이 막히고, 판매가 약하면 Sell 재고가 쌓인다.  
  반대로 판매가 너무 강하면 생산분이 족족 팔려 “연구/해금용 재고”가 모이지 않는다.  
  → 이 “미스매치 밸런싱”이 게임의 중심 재미다.
- **단순한 병목 축**: 병목은 복잡하게 쪼개지지 않는다.  
  핵심 병목은 3가지: `생산량(속도/배치량)`, `물류 이동`, `판매 처리`.
- **가격은 고정**: 유저가 가격을 직접 조정하지 않는다. (단가 튜닝은 밸런스에서 관리)
- **돈의 역할**: 돈은 “생산 재료”가 아니다.  
  돈은 **설비/인력/시장/조직/라인 설치/연구(일부)**에만 사용한다.
- **재고는 제품별로 따로 존재**: 각 제품은 재고/Cap이 별도로 있다.
- **인벤(자산) = 아이템**: 인력/설비/시장/조직은 “구매하면 재고에 쌓이는 아이템”이며, 라인에 장착해서 효과를 낸다.  
  라인 철거 시 장착 아이템은 **파괴되지 않고 재고로 회수**된다. (다른 라인에 재장착/판매 가능)

---

# 2. 플레이 루프(초반→자동화→프레스티지)

## 2.1 초반(완전 클리커)
초반에는 **세 가지 클릭**이 전부다.
1) **생산 클릭**: 클릭하면 해당 라인의 제품 1개 생산(또는 배치량만큼 생산).
2) **물류 클릭**: 클릭하면 재고를 `Keep(보관)` 또는 `Sell(판매대기)`로 이동.
3) **판매 클릭**: 클릭하면 Sell에서 1개 판매(또는 판매량만큼 판매) → 현금 획득.

> Keep은 “레시피/연구/해금 제출”을 위해 남겨두는 보호 재고.  
> Sell은 “판매로 소진되는 재고 풀”.

## 2.2 중반(자동화 시작: 클릭의 귀찮음을 돈으로 해결)
유저의 클릭을 대체하는 자동화 아이템이 등장한다.
- **생산 자동화**: 작업인력(속도) + 생산설비(배치량)
- **물류 자동화**: 물류인력이 Keep↔Sell로 자동 이동
- **판매 자동화**: 시장(판매속도) + 판매조직(판매량/효율) + 판매인력(자동판매 클릭)

> 자동화는 “한 번에 다”가 아니라, 항상 **가장 큰 병목을 풀어주는 레버**를 선택하도록 설계한다.

## 2.3 후반(제품 트리/연구/엔딩 빌드업)
- 상급 제품은 하위 제품을 요구하며(팩토리오 감성),  
  라인 밸런스를 잘 못 맞추면 “필요한 재고가 모이지 않거나, Sell로 흘러가버려서” 진행이 막힌다.
- **김치효소(Enzyme)**는 연구 전용 재화로, “김치류 제품”에서만 나온다.  
  따라서 후반에도 김치류 라인을 완전히 멈출 수 없다. (근본 유지)

## 2.4 엔딩 & 프레스티지(반복 성장)
- 최종 엔딩은 “서울타워에서 **스타김치십(Star Kimchi Ship)** 발사”.
- 발사 후 프레스티지로 리셋하되, **외계물질(Alien Matter, AM)**을 획득해 “근본 버프”를 얻는다.
- AM 버프는 “영구 구조물”이 아니라 **프레스티지 보상(메타 업그레이드)**만 제공한다.

---

> 여기까지가 1부(0~2장).  
> 다음 메시지에서 **3장(리소스/용어)부터** 목차 순서대로 이어서 작성한다.

# Kimchi Invasion — Cursor Context MD (v0.56) — Part 2
> 이어서: 목차 3)~5)

---

# 3. 리소스/지표/용어(Glossary)

## 3.1 주요 리소스(재화)
### (A) 현금(Cash, ₩)
- 획득: 판매(Sell 재고를 판매할 때)
- 사용: 라인 설치비, 아이템 구매(설비/인력/시장/조직), 연구(일부), 업그레이드
- 금지: 제품 생산 “재료”로 사용하지 않는다.

### (B) 김치효소(Enzyme, 🧪)
- 개념: 연구 전용 재화
- 획득: **김치류 제품** 생산/판매 과정에서만 산출 (가공식품/미래산업류에서는 기본적으로 산출 X)
- 사용: 연구 해금에만 사용(초기 설계)
- 핵심 제약: 효소 수급 때문에 김치류 라인을 완전히 멈출 수 없도록 설계한다.

### (C) 외계물질(Alien Matter, AM, ✨)
- 개념: 프레스티지 보상 재화
- 획득: 스타김치십 발사(엔딩) 후 프레스티지 시 지급
- 사용: 메타 업그레이드(근본 버프). “영구 구조물”은 만들지 않는다.

## 3.2 재고(Inventory) — 제품별 3구획
각 제품(Product)은 “총 재고”가 아니라 아래 3개의 숫자를 가진다.
- `keep_qty`: 보관(레시피/연구/제출 보호)
- `sell_qty`: 판매 대기(판매가 여기서만 소진)
- `cap`: 해당 제품의 최대 보유 가능량(keep+sell 합산 기준)

표기:
- `total_qty = keep_qty + sell_qty`
- 상태 뱃지 예시:
  - `CAP_FULL`: total_qty >= cap
  - `SELL_EMPTY`: sell_qty == 0
  - `KEEP_EMPTY`: keep_qty == 0

> “창고”는 별도 화면이 아니라, 물류 UI(keep↔sell 이동)로 관리한다.

## 3.3 라인(Line)
- 라인은 “하나의 제품”을 담당한다.
- 라인은 3개 섹션 UI를 가진다: 생산 / 물류 / 판매
- 라인에는 장착 슬롯이 있다(아이템 장착으로 성능 변화):
  - 생산: 설비(배치량), 작업인력(속도)
  - 물류: 물류인력(이동)
  - 판매: 시장(판매속도), 판매조직(판매량/효율), 판매인력(자동판매)

## 3.4 아이템(Item, 자산 재고)
- 인력/설비/시장/조직은 “업그레이드 트리”가 아니라 **구매 가능한 아이템**.
- 구매하면 `item_inventory`에 수량으로 누적
- 라인에 장착하면 해당 라인의 슬롯을 점유
- 라인 철거/제품 변경 시에도 아이템은 파괴되지 않고 재고로 회수 가능
- 아이템은 판매(환급) 가능

## 3.5 “속도/배치량/이동/판매량” 정의
- `batch`(배치량): 생산 클릭 1회당 생산되는 제품 수
- `prod_speed`(생산속도): 초당 자동 생산 횟수(작업인력 영향)
- `move_speed`(물류이동): 초당 keep↔sell로 옮기는 수량(물류인력 영향)
- `sell_speed`(판매속도): 초당 판매 “시도” 횟수(시장 영향)
- `sell_amount`(판매량/효율): 1회 판매 시 몇 개를 파는지(판매조직 영향)
- `auto_click`(자동클릭): 판매 버튼 클릭을 자동으로 누르는 느낌(판매인력)

---

# 4. 제품 라인/레시피 트리(Act1 기준 + 확장 규칙)

## 4.1 라인 분류(Act1)
### 라인 A: 김치 라인(효소 산출 라인)
1) 배추김치  
2) 깍두기  
3) 파김치  
4) 묵은지  
5) 100년숙성

### 라인 B: 식품 라인(가공식품)
1) 김치소스  
2) 김치볶음밥  
3) 김치탕수육  
4) 김치파스타  
5) 김치파인다이닝

> 이후(Act2/3) 확장: 미래산업/우주선 재료 라인은 별도 장에서 정의(목차 12).

## 4.2 가격(단가) 원칙
- 가격은 고정(유저 조정 없음)
- “현실감 유지”: 배추김치는 1원 같은 값 금지. 초반부터 5,000원 단위로 출발.
- 상위 제품 단가가 너무 비현실적으로 튀지 않도록, **현실적 범위 + 게임적 성장**을 동시에 만족하는 곡선을 사용한다.
- 최종 엔딩급 모듈/재료는 충분히 높은 단가로 플레이타임을 확보한다.
> 단가 테이블은 밸런스 파트에서 추후 숫자 확정(현재는 원칙만 고정).

## 4.3 레시피 트리 규칙(팩토리오 감성, 과복잡 금지)
### 핵심 룰
1) **상위 제품은 하위 제품을 요구**한다. (단, “돈”은 생산 재료로 섞지 않는다)
2) “납득 가능한 수준”에서 조합한다. (현실/서사 기반)
3) **각 라인의 최종제품(5번)은:**
   - 같은 라인 1~4번 제품을 요구 +  
   - “직전 라인(이전 라인) 1번 제품”을 추가로 요구한다.
   - 예) 식품라인 최종(김치파인다이닝)은 식품 1~4 + 김치라인 1번(배추김치) 요구
4) 중간 제품(2~4번)도 하위 제품을 적절히 요구한다.
5) 레시피 요구량은 “한 번에 너무 많은 품목”으로 늘리지 않는다(인지부하 방지).
   - 추천: 제품당 입력은 최대 2~3종.

### 레시피(초안) — 김치 라인
- 배추김치: (기본 생산, 재료 없음)
- 깍두기: 배추김치 일부 요구(예: 배추김치 xN)
- 파김치: 배추김치 일부 요구
- 묵은지: 배추김치 + 깍두기(또는 파김치) 중 1개 요구
- 100년숙성(최종): 배추김치 + 깍두기 + 파김치 + 묵은지 (전체 요구)

### 레시피(초안) — 식품 라인
- 김치소스: 배추김치 요구(소스 베이스 현실성)
- 김치볶음밥: 김치소스 + 배추김치(또는 깍두기)
- 김치탕수육: 김치소스 + 김치볶음밥(또는 파김치)
- 김치파스타: 김치소스 + 김치탕수육
- 김치파인다이닝(최종): 김치소스 + 볶음밥 + 탕수육 + 파스타 + 배추김치

> 위 레시피의 “구체 수량(N)”은 밸런스 단계에서 조정.  
> 지금은 **구조/의존성**만 확정한다.

## 4.4 효소 산출 규칙(확정)
- 효소는 “김치 라인 제품”에서만 산출
- 배추김치가 **금전적 이익은 낮지만 효소 산출이 최강**인 포지션
- 효소 개념은 초반부터 노출하지 않는다.
- `발효실험실` 업그레이드(연구) 이후부터 효소 채취/표시/사용이 열린다.

---

# 5. 라인 시스템(라인 설치/철거/할당)

## 5.1 라인 개념
- 라인은 “제품을 굴리는 작업대”
- 라인마다 1개 제품만 할당 가능
- 라인 수는 늘릴 수 있고, 철거도 가능
- 라인 철거/변경은 **전략 행동**이며, 자산(아이템) 회수/재배치가 가능해야 한다.

## 5.2 라인 설치
- 라인 설치비는 현금으로 지불
- 설치 시 “빈 라인(미할당)” 생성 → 제품을 선택해 할당해야 가동
- 설치비 증분 규칙(초안):
  - `cost = base_cost * (growth ^ (line_count-1))`
  - base_cost/growth는 밸런스에서 확정(원칙만 고정)

## 5.3 라인 철거
- 철거 시:
  - 라인의 제품 할당 해제
  - 라인에 장착된 아이템(설비/인력/시장/조직)은 **모두 재고로 자동 회수**
  - 제품 재고(keep/sell)는 “제품 자체의 재고”로 남는다(제품별 재고는 시스템에 유지)
- 철거 환급:
  - 설치비의 일부 환급(예: 50%) 또는 0% (향후 선택)
  - 원칙: 라인 스위칭이 공짜로 남용되지 않게 설계

## 5.4 라인 제품 변경(재할당)
- 라인에서 제품을 변경할 수 있다.
- 변경 시:
  - 장착 아이템은 기본적으로 “호환 여부”에 따라 처리
    - 호환 아이템(예: 물류인력)은 그대로 유지 가능
    - 비호환(예: 특정 제품 전용 설비)은 자동 해제(재고로 회수)
- 변경은 “라인 철거 후 재설치”보다 UX가 쉬워야 한다.

---

> 여기까지가 Part 2 (3~5장).  
> 다음 Part 3에서는 6) 3레버 시스템 상세와 7) 자동화/아이템을 “구현 규칙” 수준으로 쓴다.

# Kimchi Invasion — Cursor Context MD (v0.56) — Part 3
> 이어서: 목차 6)~7)

---

# 6. 3레버 시스템(공급/물류/수요) 상세

## 6.1 전체 구조(라인 단위)
각 라인은 아래 흐름을 가진다.

[생산] → (생산된 수량이 제품 재고에 추가) → [물류: Keep 또는 Sell로 분류/이동] → [판매: Sell에서만 판매]

- 생산은 제품 재고를 늘린다.
- 물류는 제품 재고를 `keep_qty`와 `sell_qty`로 나눈다(이동).
- 판매는 `sell_qty`를 감소시키고 현금을 증가시킨다.

## 6.2 공급 레버(Production)
공급은 2개의 레버로 표현한다. (서사/이해를 쉽게)
- **생산설비(Equipment)**: “클릭/사이클 1회당 생산량” = `batch`
- **작업인력(Workers)**: “자동 생산 속도” = `prod_speed`

### 6.2.1 생산 규칙
- 생산 클릭 시:
  - `produce(batch)` 실행
  - 단, `total_qty + batch > cap`이면 cap을 초과하지 않는 범위까지만 생산되거나, 생산 실패(정책 택1)
- 자동 생산:
  - `prod_speed`에 따라 주기적으로 생산 클릭이 자동으로 발생하는 것처럼 동작
- 생산 중단 조건:
  - 기본: `total_qty >= cap`이면 자동 생산이 중단됨(팩토리오 창고 꽉 참)
  - 클릭 생산은 “cap 도달 시 실패”로 처리

### 6.2.2 공급/병목 피드백(유저에게 보여줄 신호)
- 상태 뱃지:
  - `CAP_FULL`: 생산이 막힘(재고 꽉 참)
  - `RUNNING`: 정상 가동
- UI에서 “왜 멈췄는지” 한 줄로 설명:
  - “창고가 꽉 찼다(총재고/cap). 물류/판매를 강화해라.”

## 6.3 물류 레버(Logistics)
물류는 “재고 분류/이동” 레버다.
- **물류인력(Logistics Staff)**: 초당 Keep↔Sell 이동량 = `move_speed`
- **방향(Direction)**: Keep 우선 / Sell 우선 (유저가 선택)

### 6.3.1 물류 규칙(핵심 확정)
- 초기(클리커):
  - 유저가 물류 버튼을 클릭해 1개씩 이동(또는 `move_click_amount`)
  - 이동 방향은 유저가 클릭 시 선택(Keep로 넣기 / Sell로 보내기)
- 자동화 이후:
  - 물류인력이 정해진 방향으로 자동 이동
  - 방향 토글:
    - `KEEP_PRIORITY`: Sell→Keep 또는 생산분을 우선 Keep에 쌓도록 유도
    - `SELL_PRIORITY`: Keep→Sell 또는 생산분을 우선 Sell로 보내도록 유도
- 물류는 “신규 생산분을 어디로 둘지”가 아니라,
  - 구현 상 단순화를 위해: 생산은 일단 “미분류 풀”로 넣지 않고,
  - **생산 시 곧바로 keep 또는 sell로 들어간다**(정책 택1)
    - 정책 추천: “기본은 Keep으로 들어간다” (연구/레시피 확보에 유리)
    - 이후 물류가 Keep↔Sell로 이동시키며 밸런싱
  - 단, 이 정책은 UX/밸런스에 큰 영향 → 구현 전에 질문/확정 필요

> NOTE(중요): 위 ‘생산 직후 기본 분류(Keep 기본)’는 아직 “추천”이며,
> 실제 구현 전 유저(기획자)에게 최종 확정 질문을 한다.

### 6.3.2 물류 병목 신호
- `KEEP_EMPTY`인데 상위 제품 레시피/연구가 막히면:
  - “Keep 부족” 경고
- `SELL_EMPTY`면 판매가 못 돎:
  - “Sell 부족” 경고
- `CAP_FULL`인데 sell이 비어있으면:
  - “물류가 막혔다” 경고

## 6.4 수요 레버(Demand / Sales)
수요는 2개의 레버로 표현한다(유저 이해 매칭).
- **시장(Market)**: 판매 속도(초당 판매 시도 횟수) = `sell_speed`
  - 예시 서사 단계: 재래시장 → 슈퍼마켓 → 온라인몰 → 기업급식납품 → ...
- **판매조직(Sales Org)**: 1회 판매당 판매량/효율 = `sell_amount`
  - 예시 서사 단계: 기본 클릭 → 알바 → 계약직 → 영업팀 → 영업본부 → 해외지사

+ (보조) **판매인력(Sales Staff)**: 자동 판매 클릭(클리커 대체)

### 6.4.1 판매 규칙
- 판매는 오직 `sell_qty`에서만 차감
- 판매 클릭 시:
  - `sell(min(sell_amount, sell_qty))` 실행
- 자동 판매:
  - `sell_speed`에 따라 주기적으로 판매가 발생
  - 단, sell_qty가 0이면 판매는 발생하지 않음

### 6.4.2 수요 병목 신호
- 생산/물류가 잘 돌아도 `sell_speed`가 낮으면 Sell 재고가 쌓인다.
- `sell_speed`가 너무 높으면 생산분이 즉시 판매되어 Keep이 모이지 않는다.
- 이 “미스매치”가 게임의 재미가 되도록 경고/상태 표시를 제공한다.

---

# 7. 자동화(인력/설비/시장/조직) — “아이템 재고” 방식

## 7.1 핵심 철학(확정)
- 업그레이드는 “트리”가 아니라 **구매 가능한 아이템**
- 아이템은 재고로 쌓이며, 라인에 장착해서 효과 적용
- 라인 철거/변경 시 아이템은 재고로 회수
- 아이템은 판매(환급) 가능

## 7.2 아이템 타입(슬롯 매핑)
각 라인에는 아래 슬롯이 존재한다.

### 생산 슬롯
1) 생산설비(Equipment Slot)
- 효과: `batch` 증가 (클릭/사이클당 생산량)
- 단계(서사 기반, 5단계 이상):
  1. 엄마김치(집 냉장고)  ← “1단계(티어1)”로 취급
  2. 부녀회 김치냉장고
  3. 동네 공동 작업장
  4. 소규모 공방 설비
  5. HACCP 소규모 공장
  (이후 확장 가능)

2) 작업인력(Workers Slot)
- 효과: `prod_speed` 증가(자동 생산 속도)
- 단계(5단계 이상):
  1. 나(혼자)
  2. 가족 도움
  3. 동네 알바
  4. 작업반(팀)
  5. 교대조 운영

### 물류 슬롯
3) 물류인력(Logistics Slot)
- 효과: `move_speed` 증가(초당 Keep↔Sell 이동량)
- 단계(5단계 이상):
  1. 손수레
  2. 카트
  3. 창고 담당
  4. 물류팀
  5. 자동 분류 시스템(연구 해금)

> 추가 규칙: 유저가 “물류인력은 배치(Keep로/ Sell로)”를 원함.
- 최소 구현: 라인별 물류 방향 토글(KEEP_PRIORITY / SELL_PRIORITY)
- 확장 구현: 물류인력에 “배치 모드” 추가(예: Keep 전담 / Sell 전담)

### 판매 슬롯
4) 시장(Market Slot)
- 효과: `sell_speed` 증가(초당 판매 시도)
- 단계(5단계 이상):
  1. 동네 장터
  2. 슈퍼 납품
  3. 온라인몰
  4. 프랜차이즈 납품
  5. 기업급식/대형 유통

5) 판매조직(Sales Org Slot)
- 효과: `sell_amount` 증가(1회 판매당 판매 수량) 또는 “판매 효율” 계수
- 단계(5단계 이상):
  1. 직접 판매(기본)
  2. 알바 고용
  3. 계약직
  4. 영업팀
  5. 영업본부(해외지사 등은 Act2 확장)

6) 판매인력(Sales Staff Slot)
- 효과: 판매 버튼 자동 클릭/자동 판매 “클리커 대체”
- 단계(선택):
  1. 없음
  2. 판매사원 1명
  3. 판매사원 3명
  4. 판매팀
  5. 자동 주문 처리

## 7.3 구매/장착/판매 UX 규칙(창고/자산 화면 없이 “녹이기”)
- 아이템을 관리하는 별도 “자산 페이지”는 없다.
- 각 슬롯을 클릭하면 그 자리에서:
  - “장착 가능한 아이템 목록(보유 수량/가격)”이 드롭다운/팝오버로 열린다.
  - `[장착] [판매(환급)] [구매]`를 동일 UI에서 처리한다.
- 컬럼 상단에 “+구매” 진입점(인라인 패널) 제공:
  - 생산 컬럼 상단: 생산설비/작업인력 구매
  - 물류 컬럼 상단: 물류인력 구매
  - 판매 컬럼 상단: 시장/조직/판매인력 구매

## 7.4 “아이템 재고” 데이터 규칙
- `item_inventory[item_id] = count`
- 장착 시:
  - inventory count 감소(또는 “장착=대여”로 별도 tracking) — 정책 택1
  - 추천: 장착하면 inventory에서 1 감소, 해제하면 1 증가(직관)
- 판매 시:
  - inventory count 감소
  - 현금 증가(환급률은 밸런스에서)

## 7.5 자동화의 기본 수식(초안)
- `effective_batch = base_batch + sum(equipment_mods)`
- `effective_prod_speed = base + sum(worker_mods)`
- `effective_move_speed = base + sum(logistics_mods)`
- `effective_sell_speed = base + sum(market_mods)`
- `effective_sell_amount = base + sum(sales_org_mods)`
- 판매인력은 `auto_sell_clicks_per_sec`로 구현 가능

---

> 여기까지가 Part 3 (6~7장).  
> 다음 Part 4에서는 8) UI/UX(PC 5열 / 모바일 5탭) “구현 스펙”과
> 9) 연구(효소/발효실험실) 해금 규칙을 이어서 작성한다.

# Kimchi Invasion — Cursor Context MD (v0.56) — Part 4
> 이어서: 목차 8)~9)

---

# 8. UI/UX (PC 5열 오픈 / 모바일 5탭) + “창고/자산 녹이기” 규칙

## 8.1 UI 목표
- SeoulSurvival “유니폼”을 유지한다(카드 스타일, 정보 밀도, 버튼 톤).
- PC는 캡쳐2처럼 **5개 섹션(생산/물류/판매/연구/통계)이 동시에 열린 5열 레이아웃**.
- 모바일은 SeoulSurvival 모바일처럼 **동일한 5개 섹션을 탭으로 분리**한다(노출되는 섹션은 동일).
- “창고(제품 재고)”와 “자산(아이템 인벤)”은 별도 탭/페이지로 두지 않고,
  - 생산/물류/판매 UI 내부에서 **맥락 기반(인컨텍스트)**으로 조작 가능해야 한다.

---

## 8.2 PC 레이아웃(고정 5열)
### 8.2.1 구조
- 화면은 5개의 컬럼으로 구성:
  1) 생산
  2) 물류
  3) 판매
  4) 연구
  5) 통계

- 생산/물류/판매(1~3열)은 “라인 리스트”를 동일 순서로 렌더링한다.
- 연구/통계(4~5열)는 고정 패널(카드형). 라인 리스트를 반복 표시하지 않는다.

### 8.2.2 라인 정렬 규칙(매우 중요)
- 라인 i는 생산/물류/판매 3열에서 같은 “행”으로 대응되어야 한다.
- 따라서 구현은 아래 중 택1:
  - (A) 3열 각각에 라인 리스트를 렌더링하되, 라인 카드 높이를 고정(또는 최소 동일)으로 맞춘다.
  - (B) 3열을 하나의 그리드(row)로 묶어서 라인 카드 3개를 같은 row에 배치한다. (권장)
- 권장(B):
  - `LineRow` 컴포넌트가 있고, 내부에 3개의 카드(ProdCard/LogiCard/SalesCard)를 나란히 둔다.

### 8.2.3 헤더
- 상단 헤더에 공통 자원 표시:
  - Cash, Enzyme, AM
- 설정(⚙️)은 헤더 우측 고정(설정은 별도 모달/페이지 가능)
- 창고/자산 버튼은 **없다**(요구사항). 대신 인컨텍스트 조작으로 대체한다.

---

## 8.3 모바일 레이아웃(5탭)
### 8.3.1 구조
- 하단 탭 5개:
  - 생산 / 물류 / 판매 / 연구 / 통계
- 탭 선택 시 해당 섹션만 표시
- 생산/물류/판매 탭에는 라인 리스트가 보이며,
  - 해당 탭에 맞는 카드(ProdCard 또는 LogiCard 또는 SalesCard)만 렌더링한다.
- 연구/통계 탭은 PC의 연구/통계 패널과 동일 컴포넌트를 단독 화면으로 보여준다.

### 8.3.2 인컨텍스트 팝업 정책
- PC: 슬롯 클릭 → 팝오버/드롭다운
- 모바일: 슬롯 탭 → 바텀시트(Bottom Sheet)
- 별도 “자산/창고 페이지”는 만들지 않는다.

---

## 8.4 “창고(재고)”를 UI에 녹이는 방식(확정)
### 8.4.1 기본 원칙
- 제품 재고(keep/sell/cap)는 각 라인의 물류 카드(LogiCard)에서 항상 보인다.
- 사용자는 “물류=창고관리”로 인식한다.

### 8.4.2 LogiCard 필수 UI 요소
- 제품명/라인명
- 재고: `Keep / Sell / Cap` (항상 노출)
- 상태 뱃지:
  - CAP_FULL, SELL_EMPTY, KEEP_LOW(정의는 밸런스/임계치에 따라)
- 물류인력 슬롯(장착/해제/구매/판매 진입)
- 방향 토글:
  - Keep 우선 / Sell 우선
- 클릭 기반 물류 버튼(초반):
  - `[Keep로 이동]` `[Sell로 이동]`
  - 클릭 시 1개(또는 click_amount) 이동

### 8.4.3 “전체 재고 보기”를 별도 페이지 없이 제공(선택)
- 물류 컬럼 상단(PC) / 물류 탭 상단(모바일)에
  - `재고 요약바`를 1줄로 제공:
    - “Cap 임박 TOP3 / Keep 부족 TOP3 / Sell 부족 TOP3”
- 클릭 시 **해당 영역 안에서만** 간단 리스트가 펼쳐짐(오버레이 X, 페이지 X)

---

## 8.5 “자산(아이템 인벤)”을 UI에 녹이는 방식(확정)
### 8.5.1 기본 원칙
- 자산은 “슬롯을 클릭하는 순간에만” 노출된다.
- 유저는 현재 라인/현재 슬롯 맥락에서 필요한 아이템만 본다.

### 8.5.2 슬롯 공통 동작
슬롯 클릭/탭 시:
- 장착 가능한 아이템 목록 표시(필터 적용)
- 항목은 아래 정보 포함:
  - 아이템명, 티어, 효과 요약(+batch, +speed 등)
  - 보유 수량
  - 가격(구매)
  - 환급(판매)
- 버튼:
  - `[장착] [구매] [판매]`
- 현재 장착품은 상단에 고정 표시 + `[해제]`

> 장착/해제는 즉시 반영, 상태 저장.

### 8.5.3 컬럼별 슬롯 정의(재확인)
- 생산 카드(ProdCard):
  - 설비 슬롯(배치량)
  - 작업인력 슬롯(생산속도)
- 물류 카드(LogiCard):
  - 물류인력 슬롯(이동속도)
- 판매 카드(SalesCard):
  - 시장 슬롯(판매속도)
  - 판매조직 슬롯(판매량/효율)
  - 판매인력 슬롯(자동판매)

---

## 8.6 생산/물류/판매 카드의 “최소 UI”(정보 과밀 방지)
### 8.6.1 ProdCard 최소 요소
- 제품명/라인명
- 생산 버튼(클릭)
- 생산 상태(정상/CapFull)
- 현재 성능:
  - batch(클릭당 생산량)
  - prod_speed(초당 자동 생산)
- 슬롯 2개(설비/작업인력)

### 8.6.2 LogiCard 최소 요소
- Keep/Sell/Cap + 상태
- 물류 클릭 버튼(Keep로/Sell로)
- 물류 방향 토글
- 물류인력 슬롯

### 8.6.3 SalesCard 최소 요소
- 판매 버튼(클릭)
- 단가(고정)
- sell_speed / sell_amount 요약
- 슬롯 3개(시장/조직/판매인력)
- Sell 재고 0이면 “판매 불가” 표시

## 8.7 한/영 전환(i18n) — SeoulSurvival와 동일 UX
- 목표: SeoulSurvival처럼 **한국어/English 토글**을 제공해, ClickSurvivor 유니버스의 “기본 UX”를 통일한다.
- 위치: **설정(⚙️) 카드 상단** + (모바일) 설정 탭 상단.
- 기본값: `ko`(한국어)
- 저장: `localStorage`에 저장(예: `cs_lang = "ko" | "en"`).  
  - SeoulSurvival에서 이미 쓰는 키가 있다면 **그 키를 재사용**(유저 경험 일관성).
- 적용 범위(권장):
  1) UI 라벨/버튼/툴팁/토스트/튜토리얼
  2) 업적/통계/연구 이름 + 짧은 설명
  3) 세계관/연대표/로그북: **기본은 KO 제공**, EN은 “요약”부터 단계적으로 확장(아래 확정 질문 참고)
- 구현 방식(권장):
  - `i18n.js`에 `const dict = { ko: {...}, en: {...} }`
  - 헬퍼: `t(key, params?)` (없는 키는 ko fallback)
  - UI는 문자열 직접 하드코딩 금지: `t("ui.work")` 같은 키로만 호출



---

# 9. 연구 시스템(효소 기반) + 해금/제출 규칙

## 9.1 연구의 목적
- 단순한 “스탯 업”이 아니라,
  - 새로운 기능을 열고(예: 효소 개념 오픈, 자동화 고급 옵션)
  - 생산/물류/판매의 병목 해소 레버를 확장하는 역할

## 9.2 연구 탭 구조
- 연구는 2개 영역으로 구성:
  1) 지구 연구(Earth R&D): Act1 중심(발효/가공/유통)
  2) AM 연구소(Alien Matter Lab): 프레스티지 이후 메타 업그레이드

PC는 연구 컬럼(4열)에, 모바일은 연구 탭에 동일 컴포넌트로 표시.

## 9.3 효소(Enzyme) 오픈 게이트(확정)
- 효소는 초반부터 UI에 노출하지 않는다.
- 아래 연구(또는 업그레이드) 완료 후 “효소 시스템”이 열린다:
  - `발효실험실`(Fermentation Lab) 해금
- 발효실험실 이후:
  - 김치 라인 제품에서 효소 산출이 활성화
  - 연구 비용에 효소가 사용되기 시작
  - UI 상단에 Enzyme 리소스가 표시됨

## 9.4 연구 비용/제출 방식(팩토리오 감성의 최소 적용)
- 연구는 “재고 제출(keep에서 소비)” 방식으로 한다.
- 단, 조작은 복잡하게 만들지 않는다.
- 연구 카드에:
  - 필요 효소량
  - 필요 제품 재고량(예: 배추김치 xN)
  - `[제출]` 버튼
- 제출 시:
  - 요구량만큼 keep_qty에서 차감
  - 요구 조건을 충족하면 연구 완료

> 주의: 생산 재료로 돈을 섞지 않듯, 연구에도 “돈+재고”를 무분별하게 섞지 않는다.
> 초기 Act1 연구는 “효소 + 특정 제품 keep” 중심으로 단순화.

## 9.5 연구로 열리는 기능(예시, 확정 아님)
- 발효실험실(효소 시스템 오픈)
- 물류 고급 옵션:
  - Keep 최소치 설정(초반에는 숨기고 연구로 오픈)
  - 방향 자동 전환(상태 기반)
- 창고(cap) 관련:
  - 제품 cap 증가(보관 기술)
- 생산/판매 품질:
  - 배치량/속도 계수 업그레이드(아이템과 별개로 “기술 버프” 가능)
- 신규 제품 해금:
  - 라인 B(식품) 해금 게이트(예: 김치소스 연구)

> 연구 트리/리스트는 다음 파트에서 “Act1 최소셋”으로 구체화(Part 5에서 진행).

---

> 여기까지가 Part 4 (8~9장).  
> 다음 Part 5에서는 10) 업적/통계, 11) 엔딩/프레스티지(스타김치십), 12) Act 확장 로드맵을 작성한다.


# Kimchi Invasion — Cursor Context MD (v0.56) — Part 5
> 이어서: 목차 10)~12)

---

# 10. 업적/통계/메타 진행(로그, 리플레이 동기)

## 10.1 통계(Stats)의 목적
- 유저에게 “내가 어디에서 병목이 났는지”를 설명한다.
- 프레스티지 반복 플레이에서 성장 체감을 제공한다.
- 디버깅/밸런싱을 위한 내부 지표도 함께 축적한다.

## 10.2 통계 탭 구성(PC 5열/모바일 통계 탭 공통)
### (A) 운영 지표(병목 진단)
- 제품별:
  - 누적 생산량 / 누적 Keep 이동 / 누적 Sell 이동 / 누적 판매량
  - 현재 재고(keep/sell/cap)
  - “CAP_FULL로 멈춘 시간” 누적(병목 탐지)
- 라인별:
  - 생산 속도/배치량
  - 물류 이동속도/방향
  - 판매 속도/판매량

### (B) 재화 지표
- 총 획득 현금
- 누적 효소 획득량
- 누적 AM 획득량
- 프레스티지 횟수

### (C) 업적(Achievements)
- SeoulSurvival 유니폼처럼 업적 그리드 유지
- 업적은 “시스템 학습”을 유도(예: 물류 자동화 첫 도입, CapFull 탈출 등)

### (D) 로그북/패치노트(선택)
- 간단한 런 히스토리(프레스티지 날짜/AM 획득량/최종 매출 등)

## 10.3 업적 설계 원칙
- 단순 누적형 + 시스템 이해형을 섞는다.
- 예시:
  - “첫 판매 달성”
  - “첫 물류 이동”
  - “Sell이 비어 판매 0이 된 상태에서 생산만 1분 유지”(미스매치 학습)
  - “CAP_FULL 상태 3분 이상”(경고형 업적)
  - “물류인력 첫 장착”
  - “배추김치로 효소 1,000 획득”
  - “스타김치십 발사 1회”

---

# 11. 엔딩/프레스티지(서울타워 → 스타김치십 발사) + 외계물질 보상

## 11.1 엔딩 컨셉(확정)
- 서울타워 자체를 발사하지 않는다.
- **서울타워에서 ‘스타김치십(Star Kimchi Ship)’을 발사**한다.
- 발사는 “엔딩이자 프레스티지 트리거”다.

## 11.2 발사 조건(확정)
- “발사조건 1고정”이라는 요구사항을 반영:
  - 발사 조건은 **단일 목표**로 고정한다.
- 단일 목표(구현 친화):
  - (예시) “스타김치십 조립 완료” 또는 “필수 부품 3종 모듈 완성”
- 디테일:
  - 발사 조건의 구체 아이템/수량은 밸런스/Act 확장과 함께 확정한다.
  - 단, 조건은 항상 “복잡한 체크리스트”가 아니라 “단일 Progress Bar”로 보이게 만든다.

## 11.3 발사 진행 UX
- 통계/연구 영역에 “스타김치십 준비도” 카드가 존재:
  - 준비도 % + 필요 재료(요약)
  - `[조립/투입]` 버튼
- 조립/투입은 Keep 재고에서만 소비된다(보호 재고 개념 유지).
- 준비도 100% → `[발사]` 버튼 활성화

## 11.4 프레스티지(리셋) 규칙(확정)
- 발사 시 프레스티지 선택 UI:
  - “계속 플레이(발사만 기록)” 또는 “프레스티지(리셋 + AM 획득)”
- 프레스티지 시 리셋:
  - 현금 0
  - 제품 재고(keep/sell) 0
  - 라인 설치 상태 초기화(기본 라인 1개만)
  - 연구(지구 연구) 초기화 여부는 정책 택1:
    - 추천: “지구 연구는 대부분 초기화, 일부 QoL은 AM 메타로 옮김”
- 유지:
  - AM 메타 업그레이드(프레스티지 보상)만 유지
  - 통계의 ‘누적/최고 기록’은 유지(통계 탭에서 구분 표기)

## 11.5 AM(외계물질) 보상 설계
- AM은 프레스티지 시 지급되는 메타 재화
- 컨셉: “우주에서 가져온 외계물질로 근본적인 버프”
- AM 업그레이드 예시(영구 구조물 X, 메타 버프 O):
  - 기본 배치량 +1
  - 기본 생산속도 +x%
  - 기본 물류 이동 +x%
  - 기본 판매속도 +x%
  - 효소 획득량 +x%
  - 연구 제출 요구량 -x% (QoL)
- AM 업그레이드는 연구 탭의 “AM 연구소” 섹션에서 구매한다.

---

# 12. Act 확장 로드맵(Act1→Act2→Act3) — 유저는 자연스럽게 넘어가게

## 12.1 Act 구분 원칙(확정)
- Act는 내부 개발/기획상의 구분이다.
- 유저는 Act 전환을 “디아블로 Act처럼” 강하게 느끼지 않아야 한다.
- 따라서 전환 방식은:
  - 특정 연구/제품 해금 이후, 자연스럽게 새로운 제품군/시장/서사가 “추가”되는 형태
  - UI 구조(5열/5탭)는 유지
  - 기존 라인은 계속 의미를 가진다(특히 김치라인은 효소 때문에 유지 필요)

## 12.2 Act1: 한국 내 김치 성공기(현재 범위)
- 김치 라인 + 식품 라인 운영
- 효소 오픈(발효실험실)
- 스타김치십 발사의 “초기 빌드업” 마련

## 12.3 Act2: 글로벌(김치로 세계 식품산업 제패)
- 핵심 변화는 “수요 레버 확장”:
  - 시장 단계가 해외로 확장(해외 유통/현지 파트너/글로벌 채널)
  - 판매조직이 해외지사/글로벌 본부로 확장
- 제품 확장:
  - “세계 음식 × 김치”의 확장(이미 식품 라인에 일부 반영)
- 밸런스 원칙:
  - 글로벌로 갈수록 “판매속도”는 커지지만,
  - Keep을 모아 연구/발사 재료를 제출하는 압박도 함께 커져야 한다.

## 12.4 Act3: 우주(식품산업은 좁다. 우주로)
- 핵심 변화는 “미래산업/우주선 재료” 제품군의 추가
- 설계 원칙(이해 쉬운 빌드업):
  - 신소재 원료 → 배터리 → 반도체 → GPU → (최종: 우주선 필수 모듈/부품)
- 중요한 운영 규칙(기획 의도):
  - 미래산업 제품들은 “판매도 가능”하고,
  - “우주선 발사 재료로도 사용”하며,
  - “추가로 생산설비/자동화 강화 재료로도 사용”된다.
  - 단, 이 ‘추가 기능’은 기존 루프를 깨지 않게 “더하기(옵션)”로 제공한다.

> Act3의 구체 제품/레시피/단가/모듈 3종 세부는 밸런스 파트에서 확정한다.
> 지금은 “로드맵 원칙”만 고정.

---

> 여기까지가 Part 5 (10~12장).  
> 다음 Part 6에서는 13) 데이터 모델/상태머신/저장 포맷(구현 가이드)와
> 14) 구현 체크리스트/테스트 포인트를 작성하고 문서를 완결한다.


# Kimchi Invasion — Cursor Context MD (v0.56) — Part 6 (Final)
> 이어서: 목차 13)~14) + 구현 전 질문(가정 금지 원칙)

---

# 13. 데이터 모델/상태머신/저장 포맷(구현 가이드)

## 13.1 구현 아키텍처 원칙
- 단일 페이지(PC 5열, 모바일 5탭) 레이아웃을 중심으로 컴포넌트 재사용
- “라인(Line)”이 핵심 도메인 객체
- 모든 상태는 저장/복원 가능해야 함(브라우저 로컬 저장 우선)
- Tick 기반 시뮬레이션(예: 100ms~500ms)로 자동 생산/물류/판매 처리

## 13.2 핵심 엔티티(추천 타입)
### 13.2.1 Product
- id, name, category(김치/식품/미래)
- price(고정 단가)
- cap_base(기본 cap)
- enzyme_yield_base(효소 산출 기본, 김치류만 >0)
- recipe_inputs: [{product_id, qty}]  (팩토리오식 의존성)

### 13.2.2 Line
- id (1..N)
- assigned_product_id (nullable)
- slots:
  - equipment_item_id (nullable)
  - worker_item_id (nullable)
  - logistics_item_id (nullable)
  - market_item_id (nullable)
  - salesorg_item_id (nullable)
  - salesstaff_item_id (nullable)
- logistics_direction: KEEP_PRIORITY | SELL_PRIORITY
- ui_state(접힘/펼침 등, 선택)

### 13.2.3 ProductInventory (제품별 재고)
- product_id
- keep_qty
- sell_qty
- cap (cap_base + 연구/버프/아이템 효과 반영 결과)

### 13.2.4 Item (아이템 정의)
- item_id, type(slot_type), tier
- name, cost_cash
- refund_cash (또는 refund_rate)
- modifiers:
  - +batch
  - +prod_speed
  - +move_speed
  - +sell_speed
  - +sell_amount
  - +auto_sell_clicks
  - 기타(향후)

### 13.2.5 ItemInventory (아이템 재고)
- item_id -> count

### 13.2.6 Research
- research_id, name, status(locked/available/done)
- cost_enzyme
- cost_products_keep: [{product_id, qty}]
- effects: (효소 오픈, 신규 제품 해금, cap 증가, QoL 등)

### 13.2.7 Meta(프레스티지/AM)
- prestige_count
- alien_matter (AM)
- meta_upgrades: {upgrade_id -> level}

### 13.2.8 Currency
- cash
- enzyme
- alien_matter (또는 meta에 포함)

## 13.3 시뮬레이션(틱) 처리 순서(권장)
매 tick마다 아래 순서로 처리:
1) 자동 생산(라인별)
2) 자동 물류 이동(라인별)
3) 자동 판매(라인별)
4) 리소스/통계 누적 업데이트
5) UI 렌더

> 왜 이 순서인가:
> 생산→물류→판매 흐름을 그대로 반영해 디버깅이 쉽다.

## 13.4 클릭 액션(초반 클리커)
- produce_click(line_id):
  - cap 체크 후 생산(배치량 반영)
- logistics_click(line_id, target: KEEP|SELL):
  - keep↔sell 1개(또는 click_amount) 이동
- sell_click(line_id):
  - sell_qty에서 sell_amount만큼 판매(가능한 만큼) → cash 증가

## 13.5 자동화 처리(라인별)
각 라인에 대해 effective 값을 계산:
- batch = base + equipment_mod
- prod_speed = base + worker_mod
- move_speed = base + logistics_mod
- sell_speed = base + market_mod
- sell_amount = base + salesorg_mod
- auto_sell_clicks = base + salesstaff_mod (선택)

자동 생산:
- prod_speed에 따라 누적 시간(accumulator)로 생산 이벤트 발생
- 생산은 cap을 넘지 않도록 제한

자동 물류:
- move_speed에 따라 keep↔sell 이동
- 방향에 따라 이동 우선순위 결정
- (구현 단순화) 생산 직후 분류 정책은 14.3 질문에서 확정 필요

자동 판매:
- sell_speed에 따라 판매 이벤트 발생
- 각 이벤트에서 sell_amount만큼 판매(가능한 만큼)

## 13.6 저장/로드 포맷(권장 JSON)
- localStorage key: `kimchi_invasion_save_v1`
- 포함:
  - currencies, meta
  - lines[]
  - product_inventories[]
  - item_inventory
  - research_state
  - stats/achievements
  - version, timestamp

버전 정책:
- `save_version` 필드로 마이그레이션 가능하게

---

# 14. 구현 체크리스트(스프린트 단위) + 테스트 포인트

## 14.1 Sprint 1 — “클리커 MVP(완전 수동)”
- [ ] Product 데이터(배추김치 1개만)
- [ ] Line 1개(배추김치 고정)
- [ ] 재고(keep/sell/cap) 표시
- [ ] 생산 클릭 → 재고 증가(cap 제한)
- [ ] 물류 클릭(keep/sell 이동)
- [ ] 판매 클릭(sell 소비, cash 증가)
- [ ] PC 5열 레이아웃(기본)
- [ ] 모바일 5탭 레이아웃(기본)
테스트:
- cap 도달 시 생산이 멈추는지
- sell 0에서 판매 불가 처리

## 14.2 Sprint 2 — “아이템(자산) 슬롯 + 인컨텍스트 구매/장착/판매”
- [ ] Item 정의 1~2개(설비/작업인력)
- [ ] 슬롯 UI(ProdCard)
- [ ] 슬롯 클릭 팝오버/바텀시트로 구매/장착/판매
- [ ] 장착 시 효과 반영(batch/prod_speed)
- [ ] 라인 철거/변경 시 장착 아이템 회수(재고로)
테스트:
- 장착/해제 시 수량(count)이 정확히 변하는지
- 판매(환급) 금액 반영

## 14.3 Sprint 3 — “자동 생산/물류/판매 + 병목 시그널”
- [ ] Tick 시스템 도입
- [ ] 자동 생산(prod_speed)
- [ ] 물류인력(move_speed) + 방향 토글
- [ ] 시장/조직 기반 자동 판매(sell_speed/sell_amount)
- [ ] 상태 뱃지(CAP_FULL/SELL_EMPTY 등)
테스트:
- sell_speed가 과하면 keep이 모이지 않는 미스매치가 발생하는지
- cap_full로 생산 중단이 명확히 보이는지

## 14.4 Sprint 4 — “연구(발효실험실) + 효소 오픈”
- [ ] 연구 탭(PC 4열, 모바일 연구탭)
- [ ] 발효실험실 연구: 완료 후 enzyme 리소스 표시
- [ ] 김치류 제품 효소 산출 활성화
- [ ] 연구 제출(keep 소비 + enzyme 소비)
테스트:
- 연구 제출 시 keep가 정확히 차감되는지
- 발효실험실 전/후 UI 노출 차이가 올바른지

## 14.5 Sprint 5 — “제품/레시피 확장(김치 5, 식품 5) + 라인 추가”
- [ ] 제품 10개 추가
- [ ] 레시피 의존성 적용(상위 제품 생산 시 keep 소비)
- [ ] 라인 설치/할당/철거
- [ ] 라인별 3카드(생산/물류/판매) 대응 유지
테스트:
- 레시피 부족 시 생산 불가 처리(명확한 안내)
- 라인 정렬(3열에서 동일 행 유지)

## 14.6 Sprint 6 — “엔딩/프레스티지(스타김치십) + AM”
- [ ] 발사 조건(단일 목표) 카드
- [ ] 조립/투입(keep 소비) → 준비도%
- [ ] 발사 → 프레스티지 선택
- [ ] AM 지급/메타 업그레이드
테스트:
- 프레스티지 리셋 범위가 설계대로인지
- AM 업그레이드가 다음 런에 반영되는지

---

# 15. 구현 전 ‘확정 질문’(가정 금지 원칙에 따른 필수 확인)
아래는 구현자가 임의로 가정하면 게임성이 바뀌므로, 구현 전에 반드시 기획자에게 확인한다.


# 15. 세계관/연출/로그북 텍스트 패키지(서사/카피 + 메뉴 UX)

> 이 섹션은 “구현용”이면서 동시에 **게임의 톤&무드(손맛)**를 고정하는 텍스트 자산이다.  
> 구현 우선순위: **(1) 프롤로그 1회 노출 + 스킵**, (2) 단계 진입 팝업(짧게), (3) 설정>세계관(길게), (4) 로그북 해금형.

---

## 15.1 세계관 설정문(장문)
— “서울이 살아남는 방식은 늘 하나였다. 남는 게 아니라, 쌓는 것.”

서울은 늘 배고팠다.  
사람이 많아서가 아니라, 도시 자체가 먹어치우는 존재였기 때문이다.

월세는 사람을 먹고, 출근길은 시간을 먹고, 경쟁은 마음을 먹었다.  
그리고 남은 사람들은 결국 하나만 배웠다.

“생존은 축적이다.”

그게 SeoulSurvival의 세계였다.

누군가는 노동을 클릭했고,  
누군가는 투자로 돌렸고,  
누군가는 자본을 굴려 끝내 “서울”이라는 괴물을 길들였다고 믿었다.  
도시가 삼키는 만큼, 더 많이 뽑아내서, 더 높은 곳으로 올라가면 된다고.

그래서 서울은 위로 자랐다.  
한강을 넘어, 구름을 넘어, “타워”가 되었다.

그리고 그 타워는… 결국 발사대가 되었다.

### 1) 서울은 왜 타워를 세웠는가
SeoulSurvival의 엔딩이 단순히 “게임 끝”이 아닌 이유는,  
그 엔딩이 서울의 본능이기 때문이다.

서울은 고립을 두려워한다.  
외부에서 들어오는 것을 먹고 자라온 도시라서,  
외부가 끊기면 스스로를 갉아먹기 시작한다.

그래서 서울은 늘 해답을 하나만 만든다.

- 더 큰 시장
- 더 빠른 유통
- 더 높은 효율
- 더 거대한 시스템

SeoulSurvival에서 플레이어가 결국 도달하는 ‘서울타워’는,  
단순한 기념물이 아니라 도시 전체의 생존장치다.

서울은 타워로 세상을 향해 신호를 쏘았다.  
“우리는 아직 거래할 수 있다.”  
“우리는 아직 생산할 수 있다.”  
“우리는 아직 확장할 수 있다.”

그 신호는… 어딘가에 닿아버렸다.

### 2) 김치는 서울의 ‘다른 생존 방식’이었다
서울이 쌓는 법만 아는 도시라면,  
김치는 반대다.

김치는 버티는 법을 안다.

재료는 단순하다. 배추, 소금, 양념.  
과정은 오래 걸린다. 기다림, 숙성, 발효.  
결과는 변한다. 시간이 지날수록 다른 맛이 된다.

김치는 “오늘 잘 팔아치우기”가 아니라,  
내일을 위해 오늘을 저장하는 기술이다.

이 세계에서 김치는 단순한 음식이 아니다.  
서울이 잊어버린, 축적의 원형이다.

돈은 사라질 수 있어도,  
발효는 사라지지 않는다.

그래서 어떤 사람들은 이렇게 말하기 시작했다.

“서울이 진짜로 살아남으려면,  
돈이 아니라 김치를 굴려야 한다.”

처음엔 웃음거리였다.

“김치로 세계를 정복하겠다고?”  
“김치로 우주까지 가겠다고?”

그런데… 서울이 이미 타워를 세워버렸잖아.

### 3) 주인공의 출발: “엄마김치 좀 팔아볼까?”
이 이야기는 거창하게 시작하지 않는다.

주인공은 거대 기업의 CEO도 아니고,  
천재 과학자도 아니다.

그냥… 엄마의 냉장고를 아는 사람이다.

엄마는 늘 김치를 담가두었다.  
전쟁을 겪은 세대의 방식으로,  
“없을 때를 대비하는 마음”으로.

어느 날 주인공은 생각한다.

“엄마김치, 이거… 팔아볼까?”

그게 1단계다.  
집 냉장고에서 꺼내, 동네에 들고 나가, 판다.

처음엔 민망하다.  
내가 만든 것도 아니고, 엄마가 만든 거니까.

근데 이상하게… 팔린다.  
사람들은 그 맛을 기억한다.  
그 맛에는 ‘효율’이 아니라 ‘시간’이 들어있어서.

주인공은 처음으로 깨닫는다.

“이건 돈보다 강한 종류의 축적이다.”

### 4) 발효는 이 세계의 ‘숨은 물리법칙’이다
Kimchi Invasion의 세계에서 발효는 단순한 조리 과정이 아니다.  
발효는 물질의 상태를 바꾸는 법칙이고,  
그 법칙은 특정 조건에서 “다른 형태의 에너지”를 만든다.

그 에너지가 바로 **김치효소(enzyme)**다.

김치효소는 돈이 아니다.  
돈처럼 즉시 소비되는 게 아니라,  
“연구”를 통해 시스템을 바꾸는 재료다.

왜냐하면 효소는 “맛”이 아니라 “변화”를 만들기 때문이다.

같은 배추김치라도  
같은 설비라도  
같은 시장이라도  
효소를 이해한 시스템은 더 빨리, 더 정확히, 더 크게 작동한다.

그래서 게임에서 유저는 자연스럽게 이런 딜레마를 겪는다.

- “지금 팔아서 돈을 벌까?”
- “남겨서 효소를 모을까?”
- “더 큰 미래를 위해 지금을 묵힐까?”

이게 Kimchi Invasion의 핵심 감정선이다.

SeoulSurvival이 “지금 당장 더 벌기”의 게임이었다면,  
Kimchi Invasion은 “지금 남겨서 더 커지기”의 게임이다.

둘 다 축적이지만, 결이 다르다.

### 5) 도시의 5레버는 왜 ‘인간적’이어야 하는가
이 유니버스의 가장 중요한 특징은,  
모든 시스템이 결국 인간의 행동에서 출발한다는 점이다.

그래서 생산/물류/판매가 최초엔 전부 클릭이다.

- 손으로 만든다
- 손으로 옮긴다
- 손으로 판다

그리고 어느 순간부터 자동화를 산다.

그 자동화는 “편리함”이 아니라  
**‘스케일을 다루는 능력’**이다.

SeoulSurvival에서 자동화는 자본의 힘이었다.  
Kimchi Invasion에서 자동화는 물류의 지능이고 발효의 이해다.

여기서 재미가 생긴다.

수요 레버(시장/판매조직)가 커지면,  
공급 레버(생산설비/작업인력)가 못 따라간다.

공급이 커지면,  
물류 레버(재고/분류)가 터진다.

물류가 커지면,  
판매가 감당 못 하고 재고가 쌓인다.

그 불일치의 틈이 이 게임의 맛이고,  
유저는 그 틈을 줄이며 “사업이 커지는 느낌”을 받는다.

### 6) 세계는 왜 김치를 받아들이는가
이 세계에서 김치가 글로벌로 퍼지는 이유는 단순한 K-푸드 붐이 아니다.  
세계가 어느 순간, 비슷한 문제를 겪기 시작하기 때문이다.

- 공급망 붕괴
- 식량 가격 변동
- 전력/물류 비용 상승
- 지역 갈등
- “확실히 저장 가능한 것”의 가치 상승

김치는 그 문제들에 기묘하게 잘 맞는다.

- 단순한 재료로 만들 수 있고
- 저장성이 있고
- 맛이 강해서 적은 양으로도 가치가 생기고
- 시간이 지나도 “다른 상품”이 된다(숙성)

즉, 김치는 단순히 팔리는 음식이 아니라  
불안한 시대의 금융상품 같은 식품이 된다.

그래서 김치소스가 생기고,  
김치볶음밥이 생기고,  
김치탕수육이 생기고,  
김치파스타가 생긴다.

그 과정은 우스꽝스럽지만 납득이 된다.

사람들이 김치를 먹는 게 아니라,  
김치라는 ‘안정성’을 먹기 시작한 것이니까.

### 7) 그리고, 서울타워가 다시 등장한다
서울타워는 원래 서울이 세운 생존장치였다.  
하지만 Kimchi Invasion에서는 의미가 달라진다.

서울타워는 이제  
**“발효 문명의 발사대”**가 된다.

왜 하필 서울에서 우주로 가냐고?  
이 유니버스에서 서울은 늘  
“가장 먼저 과열되고, 가장 먼저 진화하는 도시”였으니까.

서울은 돈으로 세상을 버텼고,  
이제 김치로 세상을 확장한다.

그리고 이 둘이 만나는 지점이 바로  
**스타김치십(Star Kimchi Ship)**이다.

### 8) 외계물질(AM)은 왜 ‘리셋’을 요구하는가
스타김치십이 우주에서 가져오는 외계물질(AM)은  
단순한 신기한 광물이 아니다.

AM은 인간의 시스템과 “호환”되지 않는다.  
AM은 현실의 효율을 올리는 게 아니라,  
현실의 규칙을 바꾼다.

- 중력이 약해지면 물류가 달라지고
- 저장공간의 개념이 달라지면 재고가 달라지고
- 신호가 강해지면 수요가 달라지고
- 촉매가 생기면 생산이 달라진다

하지만 규칙이 바뀌면, 기존 시스템은 무너진다.  
그래서 프레스티지 리셋은 “벌”이 아니라  
새 규칙에서 다시 시작하는 의식이다.

대신 업적/통계는 남는다.

왜냐하면 이 유니버스에서  
성취는 돈이 아니라 기록이기 때문이다.

SeoulSurvival이 플레이타임을 기록하듯,  
Kimchi Invasion도 발효의 역사를 기록한다.

### 9) 유저가 느끼는 “Act의 자연스러운 전환”
Act는 유저가 못 느끼게 넘어간다.

- 엄마김치 → 부녀회 → 동네시장: ‘가정의 이야기’
- 소스 → 퓨전 → 파인다이닝: ‘사업의 확장’
- 신소재 → 배터리 → 반도체 → GPU: ‘기술의 진화’

그리고 마지막엔  
“식품산업은 좁다. 우주로 나가자.”가  
갑자기 튀는 게 아니라 이렇게 들린다.

“이제 우리 시스템은 지구에서 더 못 커진다.  
규칙 자체를 바꿔야 한다.”

그게 바로 외계물질(AM)의 등장이고,  
프레스티지 루프의 존재 이유다.

### 10) ClickSurvivor 유니폼: 왜 UI가 같아야 하는가
SeoulSurvival의 UI를 그대로 가져가는 건 단순한 재사용이 아니다.  
이 유니버스의 “같은 손맛”을 약속하는 장치다.

- 클릭으로 시작해 자동화로 넘어가는 손맛
- 숫자보다 “병목 해결”이 주는 성취감
- 엔딩이 끝이 아니라 다음 판의 시작이라는 구조

유저는 UI를 보는 순간 알아챈다.

“아, 이건 그 세계다.”

서울에서 살아남던 사람이,  
이번엔 김치로 확장하는 세계.

---

## 15.2 한 줄 요약(세계관 슬로건)
- 서울은 돈으로 살아남았다.  
  이제는 김치로 우주까지 간다.  
  **발효는 시간이 아니라, 문명이다.**

---

## 15.3 프롤로그 내레이션(20~30초)
- 노출: 게임 시작 시 1회(스킵 가능)

**버전 A (서정 + 유니버스 연결)**  
서울은 늘 배고픈 도시였다.  
돈을 먹고, 시간을 먹고, 사람을 먹고… 그렇게 커졌다.  
우리는 그 도시에 맞춰 살았다. 클릭하고, 벌고, 버티고, 쌓았다.  
그리고 서울은 마침내 타워를 세웠다.  
세상에 신호를 보내기 위해서. 살아있다고. 확장할 수 있다고.

그런데 그 신호는… 어딘가에 닿아버렸다.

너는 오늘, 엄마의 냉장고에서 김치를 꺼낸다.  
거창한 계획은 없다.  
“엄마김치… 팔아볼까?”

서울의 생존은 늘 하나였다.  
남는 게 아니라, 쌓는 것.

---

## 15.4 단계별 컷신/팝업 문구(라인1 단계 1~5)
- 노출: 각 단계 진입 시 1회(짧게, 게임 흐름 안 끊기게)

### 1단계: 엄마김치(집 냉장고)
- 타이틀: “엄마김치… 팔아볼까?”
- 본문:  
  “엄마 냉장고에 김치가 한가득이다.  
  일단 꺼내서, 동네에 한번 팔아보자.”

### 2단계: 부녀회(생산설비 시작)
- 타이틀: “부녀회 공동구매”
- 본문:  
  “김치가 팔린다. 진짜로.  
  이제는 ‘꺼내는’ 게 아니라, ‘담가서’ 파는 단계다.  
  부녀회가 장비를 같이 사자고 한다.”

### 3단계: 동네시장(판매 채널 오픈)
- 타이틀: “좌판을 깔았다”
- 본문:  
  “집 앞에서 팔던 김치가, 시장으로 들어왔다.  
  손님은 많아졌는데…  
  이제부터는 ‘만드는 속도’보다 ‘파는 구조’가 중요해진다.”

### 4단계: 납품/슈퍼(물류 자동화 필요)
- 타이틀: “납품이 시작됐다”
- 본문:  
  “식당에서 연락이 온다. 슈퍼에서도 납품을 원한다.  
  문제는 하나다.  
  김치가 아니라, ‘물류’가 너를 죽이기 시작한다.”

### 5단계: 온라인/브랜드(효소 오픈 + 최종 김치)
- 타이틀: “발효를 이해한 자가 이긴다”
- 본문:  
  “김치는 시간이 만든다.  
  그리고 시간은… 연구할 수 있다.  
  실험실이 열렸고, 효소가 보이기 시작한다.  
  이젠 ‘사업’이 아니라 ‘문명’이다.”

---

## 15.5 프레스티지(발사) 연출 텍스트 패키지
- 노출: 발사 버튼 클릭 시 1회(스킵 가능)

### 발사 직전(확인 팝업)
- 타이틀: “스타김치십 발사”
- 본문:  
  “서울타워 발사대가 가동된다.  
  이 발사는 모든 시스템을 초기화한다.  
  대신 우주에서 외계물질(AM) 1을 가져온다.”
- 버튼: `[발사한다] [취소]`

### 발사 직후(보상 팝업)
- 타이틀: “외계물질 회수!”
- 본문:  
  “스타김치십이 귀환했다.  
  외계물질(AM) 1을 확보했다.  
  연구 탭에서 ‘외계물질 연구소’를 열어, 근본 버프를 선택하자.”
- 버튼: `[연구 탭 열기] [닫기]`

---

## 15.6 ClickSurvivor 공식 연대표 v0.1
- 게임 내 “통계/설정 → 세계관”에 넣기 좋은 짧은 연표

1) **서울 생존기(SeoulSurvival)**  
   서울은 축적의 도시다. 사람들은 클릭으로 살아남고, 자동화로 확장한다.

2) **서울타워 건설**  
   축적의 끝에서 서울은 타워를 세운다. 더 큰 시장을 향해, 더 멀리 신호를 보내기 위해서.

3) **신호의 도달**  
   타워의 신호는 ‘어딘가’에 닿는다. 그리고 그곳에서, 서울을 바라보는 무언가가 반응한다.

4) **엄마김치의 시작(Kimchi Invasion 1단계)**  
   거대한 사건은 늘 작은 선택에서 시작된다. “엄마김치… 팔아볼까?”

5) **발효 문명의 확장**  
   김치가 팔리고, 시장이 열리고, 물류가 터지고, 연구가 시작된다.  
   효소는 돈이 아니라, 시스템을 바꾸는 재료가 된다.

6) **스타김치십 발사(프레스티지)**  
   서울타워는 발사대가 된다. 우주에서 외계물질(AM)을 가져오고, 지상 시스템은 새 규칙으로 다시 시작한다.

---

## 15.7 세계관 메뉴(로그북) UX 설계 v0.52
### 위치
- 기본 진입: `[설정 탭] > [세계관/로그북]`
- 보조 진입: `[통계 탭]` 상단 배너(1회 노출)  
  “기록을 세계관 로그로 남겼습니다” → 바로가기

### 메뉴 구조(탭 3개)
1) 세계관 요약  
2) 연대표  
3) 로그북(해금형)

### 세계관 요약(짧게/길게 토글)
- 상단 토글: `(짧게) / (길게)`  
- 기본값: 짧게
- 짧게: 6~8줄로 “서울은 축적, 김치는 발효, 타워는 발사대” 핵심만
- 길게: 장문 세계관 텍스트(섹션 단위 접기/펼치기)
  - 접기 단위 추천:
    1) 서울의 배고픔(SeoulSurvival)
    2) 엄마김치의 시작
    3) 발효=물리법칙(효소)
    4) 5레버(생산/물류/판매/창고/연구)
    5) 스타김치십과 외계물질(프레스티지)

### 연대표(유니버스 연결)
- 카드형 타임라인(세로 스크롤)
- 각 항목 카드: 제목(굵게) + 2줄 설명 + “관련 업적” 아이콘(있으면)

### 로그북(해금형, 프레스티지 진화의 핵심)
- 규칙: 플레이 진행에 따라 자동 해금(읽는 재미)
- 특히 프레스티지(발사 횟수)에 따라 로그의 ‘톤’이 바뀐다
- UI:
  - 로그 리스트(목록)
    - `[잠김]` 제목 회색 + 해금 조건 1줄
    - `[해금]` 클릭 시 전문 열람
  - 상단 필터: 전체 / 발사 관련 / 김치 사업 / 외계물질

### 로그 항목(초기 12개, 해금 조건 포함)
- L01. “엄마의 냉장고” — 해금: 게임 시작(1단계)
- L02. “부녀회 공동구매 전단지” — 해금: 2단계 진입
- L03. “시장 좌판의 규칙” — 해금: 3단계 진입
- L04. “납품은 김치가 아니라 물류다” — 해금: 물류인력 1명 고용
- L05. “발효실험실 기록 1호” — 해금: 발효실험실 해금(효소 오픈)
- L06. “김치소스는 베이스다” — 해금: 김치소스 해금(라인2 1번)
- L07. “미래산업의 첫 재료” — 해금: 라인3 첫 제품 해금(신소재)
- L08. “서울타워 기술문서(발사대 개조)” — 해금: 발사대 연구 해금
- L09. “스타김치십: 최종 조립 매뉴얼” — 해금: 스타김치십 제작 가능 상태
- L10. “외계물질(AM) 회수 보고서” — 해금: 첫 발사(프레스티지 1회)
- L11. “두 번째 발사: 신호가 되돌아오다” — 해금: 발사 2회
- L12. “다섯 번째 발사: 누군가 듣고 있다” — 해금: 발사 5회

### 프레스티지 횟수에 따른 ‘진화형 내레이션’(짧은 변화)
- 발사 0회: “신호는 닿았을 뿐이다.”
- 발사 1회: “무언가가 답장을 보냈다.”
- 발사 2회: “답장은 물질로 도착했다.”
- 발사 3회: “물질은 규칙을 바꾼다.”
- 발사 5회: “규칙을 바꾸는 자를… 누군가가 보고 있다.”

> 구현 팁: 발사 직후 팝업의 **한 줄 문구만 교체**해도 체감이 크다.

### 업적/통계와의 연결(전제: 업적/통계는 프레스티지 후에도 유지)
- 통계 탭 “발사 횟수” 증가 시: 로그북 신규 해금 토스트(예: “로그북 L11 해금!”)
- 업적 달성 시: 관련 로그 카드에 ‘메달’ 아이콘 표시

---

## 15.8 업적(Achievements) 20개 + 로그북 매핑 v0.53
- 업적은 프레스티지(발사) 이후에도 유지된다.
- 업적 달성 시: 토스트 + (연결된 로그북) 자동 해금 또는 강조 표시
- 업적은 “가이드” 역할도 해야 하므로 생산/물류/판매/연구/발사 흐름을 고르게 커버한다.

### 업적 목록(20)
- A01. 엄마의 냉장고 — 조건: 게임 시작(첫 생산 1회) / 보상: 로그북 L01 해금
- A02. 첫 판매 — 조건: 배추김치 10개 판매 / 보상: 통계 배너 “장사 시작”
- A03. 부녀회 가입 — 조건: 라인 업그레이드 A2 구매 / 보상: 로그북 L02 해금
- A04. 좌판 개시 — 조건: 재래시장 해금 / 보상: 로그북 L03 해금
- A05. 물류의 시작 — 조건: 물류인력 1명 고용 / 보상: 로그북 L04 해금
- A06. 자동판매의 시작 — 조건: 판매인력 1명 고용 / 보상: “판매 자동화” 튜토리얼 완료 체크
- A07. 발효실험실 1호 — 조건: 발효실험실 해금(효소 오픈) / 보상: 로그북 L05 해금
- A08. 소스는 베이스다 — 조건: 김치소스 해금 / 보상: 로그북 L06 해금
- A09. 첫 퓨전 — 조건: 김치탕수육 해금 / 보상: “퓨전 개수” 통계 카운트 시작
- A10. 파인다이닝 오픈 — 조건: 김치파인다이닝 해금 / 보상: “발사 준비” 체크리스트 표시
- A11. 미래 재료 1호 — 조건: 바이오신소재 해금 / 보상: 로그북 L07 해금
- A12. 클린룸 입성 — 조건: 반도체 SoC 해금 / 보상: “미래산업 생산량” 통계 별도 표기
- A13. 연산의 시대 — 조건: GPU 해금 / 보상: 발사 레시피(최종 조립) 안내 배너 1회
- A14. 타워의 문서 — 조건: 서울타워 발사대 연구 해금 / 보상: 로그북 L08 해금
- A15. 최종 조립 매뉴얼 — 조건: 스타김치십 제작 가능 상태 / 보상: 로그북 L09 해금
- A16. 첫 발사 — 조건: 발사 1회 / 보상: AM 1 + 로그북 L10 해금
- A17. 두 번째 발사 — 조건: 발사 2회 / 보상: 로그북 L11 해금
- A18. 다섯 번째 발사 — 조건: 발사 5회 / 보상: 로그북 L12 해금
- A19. 공정 최적화(팩토리오 감성) — 조건: 조건부 분류(Keep 최소치 유지) 활성화 상태로 모듈 제작 1회 / 보상: “물류 장인” 메달 + 최적화 성공 횟수
- A20. 근본은 배추김치 — 조건: 발사 직전 5분 동안 배추김치 생산 0이 아님 / 보상: “근본” 메달 + 다음 회차 시작 시 특별 한 줄 내레이션

### 로그북 매핑 요약
- L01: A01
- L02: A03
- L03: A04
- L04: A05
- L05: A07
- L06: A08
- L07: A11
- L08: A14
- L09: A15
- L10: A16
- L11: A17
- L12: A18

---



# 16. 구현 전 확정 질문(Decision Log) — 모호한 부분을 미리 확정

> 원칙: 구현 중 “일단 이렇게 하자”로 분기 나면, 나중에 데이터/밸런스/UX가 뒤엉킨다.  
> 아래 항목은 **Sprint 1 착수 전**에 결정(또는 “권장”으로 일단 고정)한다.

---

## 16.1 필수(스프린트 1 전에 확정)

## Q1) 생산 직후 기본 분류는?
- 옵션 A: 생산된 수량은 기본적으로 Keep에 들어간다(권장)
- 옵션 B: 생산된 수량은 기본적으로 Sell에 들어간다
- 옵션 C: 생산된 수량은 “미분류 버퍼”에 들어가고 물류가 분배한다(복잡도↑)

권장 이유:  
- Kimchi Invasion 핵심 감정선이 “남겨서(Keep) 더 커지기”이므로, 기본 흐름이 Keep이어야 자연스럽다.

## Q2) cap 초과 생산 처리
- 옵션 A: 초과분은 생산 실패(0개 생산)
- 옵션 B: cap 남은 만큼만 부분 생산(권장)

권장 이유:  
- 부분 생산은 “막히긴 했지만 남은 공간만큼은 돌아갔다”는 현실감 + 스트레스 완화.

## Q3) 레시피 소비 위치
- 옵션 A: 상위 제품 생산 시, 요구 재료는 Keep에서만 소비(권장)
- 옵션 B: keep+sell 합산에서 소비

권장 이유:  
- Sell은 ‘판매대기 풀’이라 레시피 재료로 쓰면 의미가 흐려진다(Keep=보호재고 콘셉트 유지).

## Q4) 라인 철거 환급
- 옵션 A: 설치비 0% 환급(가혹하지만 명확)
- 옵션 B: 설치비 일부 환급(예: 50%)(권장)

권장 이유:  
- 라인 조합을 실험하게 만들려면 완전 0%는 “한 번 설치하면 못 바꿈” 공포를 만든다.

## Q5) 저장/세이브 방식(초기 스코프)
- 옵션 A: 로컬 저장만(localStorage) — 1인 개발/초기 MVP에 최적(권장)
- 옵션 B: 로그인 연동 클라우드 저장(Supabase 등) — ClickSurvivor 공통 계정과 통합

권장: Sprint 1~2는 A로 시작 → 이후 SeoulSurvival 로그인/클라우드 구조 재사용해서 B 확장.

## Q6) 오프라인 진행(접속 종료 중 자동 생산/판매) 지원 여부
- 옵션 A: 미지원(권장, 밸런스/버그 리스크↓)
- 옵션 B: 지원(마지막 접속 시각 저장 후, 재접속 시 보정 계산)

권장: 초반은 A로 고정. 프레스티지/연구까지 안정화 후 B 검토.

## Q7) 숫자 표기(단위/포맷) 규칙
- 옵션 A: 1,000 단위 콤마 + “원” 표기(권장)
- 옵션 B: 1.2K / 3.4M 같은 축약 표기(후반 가독성↑)

권장:  
- 화면/카드에서는 축약(A/B 혼합 가능), 상세 툴팁/모달에서는 항상 원 단위 풀표기.

## Q8) 한/영(i18n) 범위(세계관 텍스트 포함)
## Q8) 한/영(i18n) 범위(세계관 텍스트 포함)
- 옵션 A: UI/튜토리얼/업적/연표 “요약”까지만 EN 제공
- 옵션 B: 장문 세계관/로그북까지 전부 EN 동시 제공(공수↑) **(확정)**

확정 이유:
- 글로벌 유저도 “서사/로그북”을 동일한 깊이로 경험하도록 설계
- ClickSurvivor 유니버스의 ‘같은 손맛’뿐 아니라 ‘같은 문장’까지 일관되게 제공

구현 원칙(권장):
- 모든 텍스트는 i18n key 기반으로 관리(하드코딩 금지)
- 장문 텍스트는 Markdown 문자열로 관리(섹션 단위 접기/펼치기), EN/KO 1:1 동기화
- 화면(카드/버튼)은 길이 차이를 고려해 줄바꿈/높이 자동 확장(UI 깨짐 방지)

---

## 16.2 중요(스프린트 2~3 전에 확정)

## Q9) 프레스티지 시 ‘지구 연구’ 초기화 정책
- 옵션 A: 대부분 초기화 + QoL 일부만 유지(권장)
- 옵션 B: 전부 유지(반복 동기 약화)
- 옵션 C: 전부 초기화(피로도↑)

권장: A. “AM 연구”가 반복 동기의 중심이 되게 만든다.

## Q10) 효소(enzyme) 정의/획득 방식 **(제품형 확정)**
- 확정: 효소는 ‘자원(숫자)’이 아니라 **‘제품(아이템)’**이다. (예: 효소 앰플/효소 팩)
- 획득: **효소 생산 라인**에서 생산한다. *(Keep 숙성도/시간 기반 효소 획득은 미사용)*
- 저장: **연구 인벤토리(별도 풀)**에 적재한다. (초기 스코프: Sell 불가 / 연구 전용)
- 소비: 연구 탭의 업그레이드/해금은 **효소 제품을 재료로 소비**한다.

권장 구현(최소 스펙):
- 입력 재료: **김치 라인 생산품(예: 배추김치)**을 투입해 효소를 생산한다.  
  - 재료 소비 위치: **Keep에서만 소비**(Q3와 일관).  
  - “Sell 풀”은 판매대기 전용으로 유지.
- 생산 레시피(예시): 배추김치 100 → 효소 앰플 1 (수치는 밸런싱으로 조정)
- 밸런싱 레버: 전환 비율(김치→효소), 효소 라인 속도/업그레이드, 연구 요구량

UI/UX 원칙:
- SeoulSurvival의 라인 카드 패턴과 동일하게: [레시피 선택] [가동/정지] [속도/인력] [입력 부족 경고]
- 효소는 “연구 전용 제품”임을 아이콘/라벨로 명확히 표기(혼동 방지)

## Q11) “조건부 분류(Keep 최소치 유지)” 같은 고급 물류 옵션의 도입 시점
- 옵션 A: Act1 후반(효소 오픈 이후) — 튜토리얼 단계적으로(권장)
- 옵션 B: Act1 초반부터 제공(학습 부담↑)

---

## 16.3 나중(Act2/3 확장 전에 확정)

## Q12) Act 전환의 UX: “유저가 못 느끼게”를 어떻게 구현할지
## Q12) Act 전환의 UX: “유저가 못 느끼게”를 어떻게 구현할지
- 옵션 A: 연구/해금 조건만 바뀌고 UI는 동일 **(확정)**
- 옵션 B: 탭/페이지가 추가됨(유니폼 깨짐)

확정 이유:
- ClickSurvivor 유니폼(같은 손맛/같은 UI)을 유지한 채로 콘텐츠만 확장
- Act 전환을 ‘화면 전환’이 아니라 ‘연구 완료로 인한 기능/레시피/라인 추가’로 체감하게 함

구현 규칙(최소):
- Act 전환은 별도 “Act 화면” 없이, 연구 완료/업적 달성 시점에 신규 카드/레시피/라인이 기존 탭에 ‘조용히 추가’
- 전환 알림은 토스트 1줄 + (선택) 로그북 1개 해금으로만 처리(스킵 가능)
- 모든 탭 구조/레이아웃은 Act1~3 동일(생산/물류/판매/연구)

추천 트리거(초안, Sprint 2~3에서 확정):
- Act1 → Act2: 연구 “소스 공정” 완료(=김치소스 생산/라인 해금)
- Act2 → Act3: 연구 “미래 공정” 완료(=신소재 1호 또는 스타김치십 조립 라인 해금)


## Q13) AM 트리(프레스티지) v0.62 확정(단일 레벨 10개)

### 확정 사항(단순화)
- 프레스티지(발사) 1회당 AM 1개를 획득한다.
- AM 업그레이드는 **총 10개**, 각 업그레이드는 **단일 레벨(1회 구매)**로 끝난다.
- 모든 업그레이드의 비용은 **1 AM**으로 통일한다.
- 따라서 **프레스티지 10회 = 업그레이드 10개 전부 구매 완료**가 된다.

> 의도: “프레스티지 = 새 규칙의 시작”은 유지하되, 초반 MVP는 트리를 단순하게 만들어 구현/밸런스 리스크를 낮춘다.
> (향후 확장 시: 업그레이드 추가(10→20) 또는 다레벨(1→5레벨)로 확장 가능)

---

### 계열 정의(라벨) — 5레버 1:1 매핑
- A: 생산(Production)
- B: 물류(Logistics)
- C: 판매(Sales)
- D: 연구(Research)
- E: 프레스티지(Meta)

---

### 업그레이드 10개(단일 레벨 효과)

#### A. 생산(Production)
A1) 더 빠른 손
- 효과: 모든 생산 라인 생산속도 +25%

A2) 원가 절감
- 효과: 레시피/공정 입력 소모량 -10% (계산 후 정수 반올림)

#### B. 물류(Logistics)
B1) 더 큰 창고
- 효과: Keep cap(수용량) +50%

B2) 분류 자동화
- 효과: 자동 분류(조건부 분류 포함) 처리 속도 +40%

#### C. 판매(Sales)
C1) 판매 조직
- 효과: 판매 처리 속도 +40%

C2) 브랜드 프리미엄
- 효과: 판매 단가(가격) +10%

#### D. 연구(Research)
- 전제: 연구 비용은 2종 비용을 전제로 한다: (1) 원(₩) (2) 효소 제품(Enzyme Vial)

D1) 연구 효율
- 효과: 연구에 필요한 효소 제품 요구량 -20%

D2) 연구비 절감
- 효과: 연구에 필요한 원(₩) 비용 -15%

#### E. 프레스티지(Meta)
E1) 시작 자본
- 효과: 프레스티지 후 시작 현금 +50%

E2) 초반 가속
- 효과: 프레스티지 후 첫 5분 동안 모든 생산속도 +25%

---

### UI 카드 표기(권장)
- 카드 제목: [아이콘] 업그레이드명
- 한 줄 설명: “(대상) (효과)”
- 버튼: [구매] (비활성 시 “AM 부족”)


## 35. 리더보드(Leaderboard) v0.65 확정

### 35.1 표기 컬럼(고정 5개)
리더보드 표는 아래 5개 컬럼만 표기한다(항상 고정).
- 닉네임(nickname)
- 스타김치십 발사횟수(prestige_count = tower_count)
- 기업가치(EV = total_assets)
- 누적 판매액(lifetime_gmv)
- 플레이타임(play_time_ms)

### 35.2 정렬/탭 정책(확정)
- 기본 정렬: EV 내림차순
- 탭(정렬 기준) 4개 제공(탭을 바꾸면 ORDER BY만 변경)
  1) EV
  2) 누적 판매액(Lifetime GMV)
  3) 발사횟수(Prestige Count)
  4) 플레이타임(Playtime)

### 35.3 기업가치(EV) 산출(확정)
- EV = 현재 현금(Current Cash, ₩) + 재고가치(Inventory Value, ₩) + 투자자산가치(Asset Value, ₩)

1) 현재 현금
- Current Cash = cash

2) 재고가치(디스카운트 없음: 확정)
- Inventory Value = Σ(품목별 수량 × 기준 판매가)
- 기준 판매가(권장): 해당 품목의 “기본 판매가(표준가)”를 사용
  - 일시 버프/이벤트 배수는 제외(순간 EV 흔들기 방지)
  - 영구 업그레이드로 인한 가격 상승은 표준가에 반영 가능

3) 투자자산가치(AM 업그레이드 가치는 EV에서 제외: 확정)
- Asset Value = Σ(설치된 라인/설비 설치비 × 철거 환급률)
- 철거 환급률: 80%(Q4 확정 값)
- 인력(직원)은 EV에 포함하지 않는다(리더보드에는 ‘발사횟수/EV/누적판매액/플레이타임’만 표기)

### 35.4 저장/집계 규칙(확정)
- lifetime_gmv(누적 판매액): 프레스티지 후에도 누적 유지
- prestige_count(발사횟수): 누적 유지
- play_time_ms(플레이타임): 누적 유지(SeoulSurvival과 동일 ms 단위)
- EV(total_assets): “현재 회차 기준”으로 계산해서 제출(표시 시점에 재계산하지 말고, 제출 시점 값 사용)

### 35.5 제출 정책(확정)
- 로그인 유저만 리더보드 등재
- 제출 타이밍(모두 구현):
  - (1) 30초 주기 자동 제출(Throttle)
  - (2) 프레스티지 직후 즉시 제출
  - (3) 탭 종료(visibilitychange / beforeunload) 시 최종 제출 시도

### 35.6 Cursor Agent 실행 지시(프롬프트형)
아래 순서로 작업한다(순서 고정).
1) 리더보드 “저장”을 RPC로 통일(권장): `submit_leaderboard_v2(...)` 또는 동등한 서버 제출 함수 사용
2) 클라이언트에서 제출 payload 계산:
   - nickname은 보내지 않는다(서버가 허브 닉네임을 붙이도록)
   - game_slug는 각 게임 상수로 고정(예: seoulsurvival / kimchi_invasion)
   - total_assets(EV) / lifetime_gmv / play_time_ms / tower_count(발사횟수)
3) 리더보드 “조회”는 공개 select로 top N 읽기
4) UI:
   - 5개 컬럼 고정 + 탭 4개(정렬 기준만 변경)
   - 내 기록(로그인 유저) 하이라이트/핀 고정은 옵션(있으면 좋음)

### 35.7 완료 기준(Definition of Done)
- (저장) 로그인 유저가 30초마다 제출해도 에러 없이 upsert 된다.
- (조회) 비로그인(anon)도 리더보드 목록을 조회할 수 있다.
- (정렬) 탭을 바꾸면 정렬이 즉시 바뀌며, 표기 컬럼은 항상 5개로 유지된다.
- (보안) user_id를 바꿔서 타인 점수를 덮어쓰는 행위가 실패한다(RLS/RPC로 방어).


## 36. Supabase 데이터 구조(멀티게임) v0.68

### 36.1 현황(현재 운영 테이블 3개)
현재 ClickSurvivor Supabase에는 아래 3개 테이블이 존재하며, 모두 `game_slug` 컬럼을 통해 “게임 구분”을 지원하는 형태다.

1) public.nickname_registry
- 목적: 닉네임 저장/중복 방지(현재는 seoulsurvival 중심 운영)
- 주요 컬럼: (id, game_slug, nickname_key, nickname_raw, user_id, created_at, updated_at)

2) public.leaderboard
- 목적: 리더보드 저장
- 주요 컬럼: (id, user_id, game_slug, nickname, total_assets(EV), play_time_ms, tower_count(발사횟수), created_at, updated_at)
- Kimchi Invasion 확정 지표를 위해 `lifetime_gmv` 컬럼이 추가로 필요

3) public.game_saves
- 목적: 게임 세이브(JSONB) 저장
- 주요 컬럼: (id, user_id, game_slug, save(jsonb), save_ts, created_at, updated_at)

---

### 36.2 목표(확정)
- 허브(ClickSurvivor)에서 설정한 닉네임이 하위 게임들과 **자동 연동**된다(닉네임 SSOT).
- SeoulSurvival / Kimchi Invasion의 **세이브/리더보드 데이터가 완전히 분리**된다.
- 기존 테이블을 최대한 유지하면서, 제약/인덱스/트리거/RLS를 추가해 운영 안정성을 올린다.
- 리더보드 표기(고정 5개): nickname / tower_count / total_assets(EV) / lifetime_gmv / play_time_ms

---

### 36.3 권장 아키텍처(바로 적용: 기존 테이블 유지 + 강화) v0.68

#### 36.3.1 닉네임 SSOT(단일 진실) 규칙
- canonical row 규칙: `nickname_registry.game_slug = 'clicksurvivor'`
- 어떤 게임에서 닉네임을 바꿔도, 트리거로 canonical row에 자동 upsert
- 리더보드는 조인 없이 빠르게 조회되도록 `leaderboard.nickname`에 스냅샷으로 저장하고,
  canonical 닉네임 변경 시 `leaderboard.nickname`도 자동 동기화(트리거)

> 결과: “허브 닉네임 1개”가 모든 게임에서 동일하게 표시된다.

#### 36.3.2 데이터 분리 규칙(게임별 1유저 1행)
- `game_saves`: (game_slug, user_id) UNIQUE
- `leaderboard`: (game_slug, user_id) UNIQUE
- 같은 user_id라도 game_slug가 다르면 다른 행으로 저장되어, 세이브/리더보드가 자연스럽게 분리된다.

#### 36.3.3 Kimchi Invasion 리더보드 컬럼 반영
- `leaderboard`에 `lifetime_gmv numeric(40,0) not null default 0` 컬럼을 추가한다.

#### 36.3.4 보안(RLS) + 제출 방식(RPC) 권장
- RLS:
  - leaderboard: SELECT는 공개(anon 포함), INSERT/UPDATE는 본인만(auth.uid())
  - nickname_registry / game_saves: 본인만 읽기/쓰기
- 제출은 RPC(서버 함수)로 통일 권장:
  - 클라이언트가 nickname을 보내지 않는다.
  - 서버가 canonical nickname을 붙여서 저장한다(조작 방지 + 구현 단순화).

---

### 36.4 적용 절차(Agent가 그대로 수행할 체크리스트)

#### Step 0) 중복 데이터 사전 점검(필수)
유니크 인덱스를 걸기 전에, 중복이 존재하는지 먼저 확인한다.

- nickname_registry (game_slug,user_id) 중복 점검:
  - 동일 user_id+game_slug가 여러 행이면, 최신(updated_at) 1행만 남기고 나머지 삭제 후 진행

- leaderboard (game_slug,user_id) 중복 점검:
  - 동일 user_id+game_slug가 여러 행이면, 최신(updated_at) 1행만 남기고 나머지 삭제 후 진행

- game_saves (game_slug,user_id) 중복 점검:
  - 동일 user_id+game_slug가 여러 행이면, 최신(updated_at) 1행만 남기고 나머지 삭제 후 진행

> 중복이 없는 게 확인되면 Step 1로 진행.

#### Step 1) SQL 마이그레이션 실행(확정)
- Supabase Dashboard → SQL Editor에서 아래 파일 내용을 실행한다.
- 파일: `supabase_migration_clicksurvivor_v0.66_from_current.sql`
- 실행으로 포함되는 것:
  - `leaderboard.lifetime_gmv` 컬럼 추가
  - (game_slug,user_id) UNIQUE 인덱스 추가(leaderboard/game_saves/nickname_registry)
  - 닉네임 canonical upsert 트리거 + leaderboard 닉네임 동기화 트리거
  - 정렬 인덱스(EV/GMV/발사/플레이타임)
  - RLS 정책
  - RPC: `submit_leaderboard_v2(...)`

#### Step 2) 실행 후 검증(필수)
- (RLS) 비로그인(anon)으로 leaderboard select가 되는지 확인
- (쓰기) 로그인 유저로만 upsert가 되는지 확인
- (닉네임) 허브에서 닉네임 변경 시 leaderboard.nickname이 함께 갱신되는지 확인
- (분리) seoulsurvival과 kimchi_invasion이 각각 다른 행으로 저장되는지 확인

#### Step 3) 클라이언트 변경(최소 변경 가이드)
- 허브:
  - nickname 저장 시 `nickname_registry.game_slug = 'clicksurvivor'`로 저장(권장)
- 각 게임:
  - save/load 쿼리에서 game_slug를 상수로 고정(게임별로 다른 slug 사용)
  - 리더보드 제출은 RPC로 통일:
    - `submit_leaderboard_v2(game_slug, total_assets, lifetime_gmv, play_time_ms, tower_count)`
  - 리더보드 조회는 `leaderboard`에서 `where game_slug = '<this_game>'`로 필터

---

### 36.5 Cursor Agent용 “작업 지시 프롬프트”(복붙 형태)
- 목표: 멀티게임 분리 + 허브 닉네임 SSOT + Kimchi Invasion 리더보드 컬럼(lifetime_gmv) 추가를 완료한다.
- 선행: Supabase SQL Editor에서 `supabase_migration_clicksurvivor_v0.66_from_current.sql` 실행.
- 코드 변경:
  1) 허브 닉네임 저장 로직을 `game_slug='clicksurvivor'`로 고정
  2) 각 게임 seoulsurvival/kimchi_invasion에서 `GAME_SLUG` 상수를 만들고,
     save/load/leaderboard 제출/조회에 항상 포함
  3) 리더보드 제출은 `submit_leaderboard_v2` RPC 호출로 통일(클라에서 nickname 제거)
  4) 리더보드 조회는 (game_slug 필터 + 탭 정렬)만 수행

- 완료 기준:
  - hub에서 바꾼 닉네임이 모든 게임 리더보드에 동일하게 반영
  - seoulsurvival과 kimchi_invasion의 세이브/리더보드가 서로 섞이지 않음
  - 리더보드 표기 5개 컬럼 충족(닉네임/발사/EV/누적판매/플레이타임)

---

### 36.6 SQL 파일
- `supabase_migration_clicksurvivor_v0.66_from_current.sql`

(참고: “클린 스키마로 새로 시작”하는 대안 설계는 별도 파일 `supabase_schema_v0.66.sql`에 존재하나,
현재 운영 데이터가 있는 상태에서는 위 마이그레이션(기존 테이블 유지 + 강화)이 우선 권장이다.)
