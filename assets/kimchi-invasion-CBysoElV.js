import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css               */const g={kimchi_1:{id:"kimchi_1",name:"ë°°ì¶”ê¹€ì¹˜",emoji:"ğŸ¥¬",price:5e3,desc:"ì—„ë§ˆì˜ ì†ë§›ì´ ë‹´ê¸´ ê¸°ë³¸ ê¹€ì¹˜"},kimchi_2:{id:"kimchi_2",name:"ê¹ë‘ê¸°",emoji:"ğŸ§Š",price:8e3,recipe:{kimchi_1:2},desc:"ì•„ì‚­ì•„ì‚­í•œ ì‹ê°ì˜ ë¬´ê¹€ì¹˜"},kimchi_3:{id:"kimchi_3",name:"ì´ê°ê¹€ì¹˜",emoji:"ğŸ¥•",price:15e3,recipe:{kimchi_1:5},desc:"ì•Œì‹¸í•œ ë§›ì˜ ë¬´ì²­ ê¹€ì¹˜"},kimchi_4:{id:"kimchi_4",name:"ë¬µì€ì§€",emoji:"ğŸº",price:25e3,recipe:{kimchi_1:3,kimchi_2:3},desc:"ê¹Šì€ ë§›ì´ ìš°ëŸ¬ë‚˜ëŠ” ìˆ™ì„± ê¹€ì¹˜"},kimchi_5:{id:"kimchi_5",name:"100ë…„ ìˆ™ì„±",emoji:"ğŸ’",price:5e4,recipe:{kimchi_1:5,kimchi_2:5,kimchi_3:2,kimchi_4:1},desc:"ë°•ë¬¼ê´€ì— ê°€ì•¼ í•  ê²ƒ ê°™ì€ ì „ì„¤ì˜ ê¹€ì¹˜"},enzyme_vial:{id:"enzyme_vial",name:"íš¨ì†Œ ì•°í”Œ",emoji:"ğŸ§ª",price:0,recipe:{kimchi_1:50},desc:"ì—°êµ¬ì— ì“°ì´ëŠ” ê³ ë†ì¶• ìœ ì‚°ê·  íš¨ì†Œ"},kimchi_sauce:{id:"kimchi_sauce",name:"ë§ŒëŠ¥ ê¹€ì¹˜ì†ŒìŠ¤",emoji:"ğŸ¥£",price:25e3,recipe:{kimchi_1:3,enzyme_vial:1},desc:"ì–´ë–¤ ìŒì‹ë„ ì„œìš¸ì˜ ë§›ìœ¼ë¡œ ë°”ê¾¸ëŠ” ë§ˆë²•ì˜ ì†ŒìŠ¤"},kimchi_fried_rice:{id:"kimchi_fried_rice",name:"ê¹€ì¹˜ë³¶ìŒë°¥",emoji:"ğŸ³",price:45e3,recipe:{kimchi_sauce:1,kimchi_2:1},desc:"ê°€ì¥ ëŒ€ì¤‘ì ì´ì§€ë§Œ ê°€ì¥ ì•ˆì •ì ì¸ ìˆ˜ìµì›"},kimchi_tangsuyuk:{id:"kimchi_tangsuyuk",name:"ê¹€ì¹˜ íƒ•ìˆ˜ìœ¡",emoji:"ğŸ–",price:12e4,recipe:{kimchi_sauce:2,kimchi_3:1},desc:"ê³ ê¸°ì™€ í•œ ëª¸ì´ ëœ ê¹€ì¹˜. í“¨ì „ ë¬¸ëª…ì˜ ì •ì ."},kimchi_pasta:{id:"kimchi_pasta",name:"ê¹€ì¹˜ íŒŒìŠ¤íƒ€",emoji:"ğŸ",price:25e4,recipe:{kimchi_sauce:2,kimchi_tangsuyuk:1},desc:"ë™ì„œì–‘ì˜ ëŒ€í™”í•©. ì´íƒˆë¦¬ì•„ë„ ì¸ì •í–ˆë‹¤."},kimchi_dining:{id:"kimchi_dining",name:"ê¹€ì¹˜ íŒŒì¸ë‹¤ì´ë‹",emoji:"ğŸ½ï¸",price:1e6,recipe:{kimchi_sauce:5,kimchi_fried_rice:2,kimchi_tangsuyuk:1,kimchi_pasta:1,kimchi_1:10},desc:"ì½”ìŠ¤ ìš”ë¦¬ì˜ ì‹œì‘ë¶€í„° ëê¹Œì§€ ê¹€ì¹˜ë‹¤."}},v={line_base_cost:1e5,line_cost_growth:2,refund_rate:.8},m={eq_mom_fridge:{id:"eq_mom_fridge",type:"equipment",name:"ì—„ë§ˆ ëƒ‰ì¥ê³ ",tier:1,cost:0,effects:{batch:1},desc:"ì§‘ì— ìˆëŠ” ëƒ‰ì¥ê³ . ê¹€ì¹˜ë¥¼ ê²¨ìš° ë³´ê´€í•œë‹¤."},eq_dimchae:{id:"eq_dimchae",type:"equipment",name:"ê¹€ì¹˜ ëƒ‰ì¥ê³ ",tier:2,cost:5e4,effects:{batch:5},desc:"ê¹€ì¹˜ ì „ìš© ëƒ‰ì¥ê³ . ìˆ™ì„±ì´ ì˜ëœë‹¤."},eq_community_work:{id:"eq_community_work",type:"equipment",name:"ë™ë„¤ ê³µë™ ì‘ì—…ì¥",tier:3,cost:2e5,effects:{batch:15},desc:"ë¶€ë…€íšŒê°€ í•¨ê»˜ ì‘ì—…í•œë‹¤."},eq_small_workshop:{id:"eq_small_workshop",type:"equipment",name:"ì†Œê·œëª¨ ê³µë°©",tier:4,cost:8e5,effects:{batch:40},desc:"ì „ë¬¸ì ì¸ ì¥ë¹„ë¥¼ ê°–ì·„ë‹¤."},eq_haccp_factory:{id:"eq_haccp_factory",type:"equipment",name:"HACCP ê³µì¥",tier:5,cost:25e5,effects:{batch:100},desc:"ìœ„ìƒê³¼ íš¨ìœ¨ì„ ëª¨ë‘ ì¡ì•˜ë‹¤."},wk_me:{id:"wk_me",type:"worker",name:"ë‚˜ (CEO)",tier:1,cost:0,effects:{prodSpeed:0},desc:"ë‚˜ í˜¼ì í•œë‹¤."},wk_mom:{id:"wk_mom",type:"worker",name:"ê°€ì¡± ë„ì›€",tier:2,cost:3e4,effects:{prodSpeed:1},desc:"ê°€ì¡±ì´ ê°€ë” ë„ì™€ì£¼ì‹ ë‹¤."},wk_alba:{id:"wk_alba",type:"worker",name:"ë™ë„¤ ì•Œë°”",tier:3,cost:15e4,effects:{prodSpeed:3},desc:"ì„±ì‹¤í•œ ì•Œë°”ìƒì„ ê³ ìš©í–ˆë‹¤."},wk_team:{id:"wk_team",type:"worker",name:"ì‘ì—…ë°˜",tier:4,cost:5e5,effects:{prodSpeed:8},desc:"ì†ë°œì´ ë§ëŠ” íŒ€ì„ ê¾¸ë ¸ë‹¤."},wk_shift:{id:"wk_shift",type:"worker",name:"êµëŒ€ì¡° ìš´ì˜",tier:5,cost:2e6,effects:{prodSpeed:20},desc:"24ì‹œê°„ ê³µì¥ì´ ëŒì•„ê°„ë‹¤."},lg_box:{id:"lg_box",type:"storage",name:"ì¢…ì´ ë°•ìŠ¤",tier:1,cost:0,effects:{moveBatch:1},desc:"ê°€ì¥ ê¸°ë³¸ì ì¸ ë³´ê´€í•¨."},lg_pallet:{id:"lg_pallet",type:"storage",name:"ë‚˜ë¬´ íŒ”ë ˆíŠ¸",tier:2,cost:2e4,effects:{moveBatch:5},desc:"ëŒ€ëŸ‰ ì´ë™ì˜ ê¸°ì´ˆ."},lg_cont_small:{id:"lg_cont_small",type:"storage",name:"ì†Œí˜• ì»¨í…Œì´ë„ˆ",tier:3,cost:1e5,effects:{moveBatch:15},desc:"ê·œê²©í™”ëœ ìš´ì†¡ ìš©ê¸°."},lg_warehouse:{id:"lg_warehouse",type:"storage",name:"ì°½ê³  êµ¬ì—­",tier:4,cost:5e5,effects:{moveBatch:40},desc:"ì²´ê³„ì ì¸ ì ì¬ ê³µê°„."},lg_center_hub:{id:"lg_center_hub",type:"storage",name:"í—ˆë¸Œ ì„¼í„°",tier:5,cost:2e6,effects:{moveBatch:100},desc:"ì´ˆëŒ€í˜• ë¬¼ë¥˜ í—ˆë¸Œ."},tr_hand:{id:"tr_hand",type:"transporter",name:"ì†ìœ¼ë¡œ ì˜®ê¸°ê¸°",tier:1,cost:0,effects:{moveSpeed:0},desc:"ì§ì ‘ ë‚˜ë¥¸ë‹¤."},tr_cart:{id:"tr_cart",type:"transporter",name:"ì†ìˆ˜ë ˆ",tier:2,cost:3e4,effects:{moveSpeed:1},desc:"ë°”í€´ê°€ ë‹¬ë ¤ì„œ í¸í•˜ë‹¤."},tr_truck:{id:"tr_truck",type:"transporter",name:"ìš©ë‹¬ íŠ¸ëŸ­",tier:3,cost:15e4,effects:{moveSpeed:3},desc:"ë„ë¡œë¥¼ ë‹¬ë¦°ë‹¤."},tr_fleet:{id:"tr_fleet",type:"transporter",name:"ë¬¼ë¥˜íŒ€",tier:4,cost:5e5,effects:{moveSpeed:8},desc:"ì „ë¬¸ ë°°ì†¡íŒ€."},tr_auto_sys:{id:"tr_auto_sys",type:"transporter",name:"ìë™ ë¶„ë¥˜ê¸°",tier:5,cost:2e6,effects:{moveSpeed:20},desc:"ë¬´ì¸ ìë™í™” ì‹œìŠ¤í…œ."},mk_neighborhood:{id:"mk_neighborhood",type:"market",name:"ë™ë„¤ ì¥í„°",tier:1,cost:0,effects:{sellAmount:1},desc:"ì•ŒìŒì•ŒìŒ íŒë‹¤."},mk_supermarket:{id:"mk_supermarket",type:"market",name:"ìŠˆí¼ ë‚©í’ˆ",tier:2,cost:5e4,effects:{sellAmount:5},desc:"ë™ë„¤ ìŠˆí¼ì— ì§„ì—´ëœë‹¤."},mk_online:{id:"mk_online",type:"market",name:"ì˜¨ë¼ì¸ëª°",tier:3,cost:2e5,effects:{sellAmount:15},desc:"ì „êµ­ì—ì„œ ì£¼ë¬¸ì´ ë“¤ì–´ì˜¨ë‹¤."},mk_franchise:{id:"mk_franchise",type:"market",name:"í”„ëœì°¨ì´ì¦ˆ",tier:4,cost:8e5,effects:{sellAmount:40},desc:"ë¸Œëœë“œ íŒŒì›Œê°€ ìƒê²¼ë‹¤."},mk_enterprise:{id:"mk_enterprise",type:"market",name:"ê¸°ì—… ê¸‰ì‹",tier:5,cost:25e5,effects:{sellAmount:100},desc:"ëŒ€ê·œëª¨ ë‚©í’ˆ ê³„ì•½."},so_solo:{id:"so_solo",type:"salesOrg",name:"ì§ì ‘ íŒë§¤",tier:1,cost:0,effects:{sellSpeed:0},desc:"ë°œë¡œ ë›´ë‹¤."},so_alba:{id:"so_alba",type:"salesOrg",name:"íŒë§¤ ì•Œë°”",tier:2,cost:3e4,effects:{sellSpeed:1},desc:"ë³´ì¡° ì¸ë ¥ì´ ìƒê²¼ë‹¤."},so_contract:{id:"so_contract",type:"salesOrg",name:"ê³„ì•½ì§ ì‚¬ì›",tier:3,cost:15e4,effects:{sellSpeed:3},desc:"ë” ë§ì´ íŒ”ì•„ì˜¨ë‹¤."},so_team:{id:"so_team",type:"salesOrg",name:"ì˜ì—…íŒ€",tier:4,cost:5e5,effects:{sellSpeed:8},desc:"ì¡°ì§ì ì¸ ì˜ì—… í™œë™."},so_hq:{id:"so_hq",type:"salesOrg",name:"ì˜ì—… ë³¸ë¶€",tier:5,cost:2e6,effects:{sellSpeed:20},desc:"ì „ëµì ì¸ ì‹œì¥ ê³µëµ."}},I={unlock_kkakdugi:{id:"unlock_kkakdugi",name:"ê¹ë‘ê¸° ë ˆì‹œí”¼ ì—°êµ¬",cost:1e5,costItems:{kimchi_1:50},type:"unlock",productId:"kimchi_2",desc:"ë¬´ë¥¼ ì°ì–´ ë§µê²Œ ë²„ë¬´ë¦¬ëŠ” ë²•ì„ ë°°ìš´ë‹¤."},unlock_chonggak:{id:"unlock_chonggak",name:"ì´ê°ê¹€ì¹˜ ë ˆì‹œí”¼ ì—°êµ¬",cost:5e5,costItems:{kimchi_2:100},prereq:"unlock_kkakdugi",type:"unlock",productId:"kimchi_3",desc:"ì‘ì€ ë¬´ì˜ ì•„ì‚­í•¨ì„ ì‚´ë¦¬ëŠ” ë¹„ë²•."},unlock_muegenji:{id:"unlock_muegenji",name:"ë¬µì€ì§€ ìˆ™ì„±ë²•",cost:1e6,costItems:{kimchi_3:100},prereq:"unlock_chonggak",type:"unlock",productId:"kimchi_4",desc:"ê¹Šì€ ë§›ì„ ë‚´ëŠ” ì¥ê¸° ìˆ™ì„± ê¸°ìˆ ."},unlock_100y:{id:"unlock_100y",name:"100ë…„ ìˆ™ì„± ë¹„ê¸°",cost:5e6,costItems:{kimchi_4:200},prereq:"unlock_muegenji",type:"unlock",productId:"kimchi_5",desc:"ê°€ë¬¸ì˜ ë¹„ë²•ì„ ë³µì›í•œë‹¤."},fermentation_lab:{id:"fermentation_lab",name:"ë°œíš¨ ì‹¤í—˜ì‹¤ êµ¬ì¶•",cost:1e6,costItems:{kimchi_1:500},prereq:"unlock_kkakdugi",type:"unlock",productId:"enzyme_vial",desc:"ê¹€ì¹˜ì—ì„œ íš¨ì†Œë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆê²Œ ëœë‹¤."},global_efficiency:{id:"global_efficiency",name:"ìœ ì‚°ê·  ê°•í™” ì—°êµ¬",cost:2e6,costEnzyme:50,prereq:"fermentation_lab",type:"buff",effects:{priceMult:1.2},desc:"ëª¨ë“  ê¹€ì¹˜ì˜ íŒë§¤ ê°€ê²©ì´ 20% ìƒìŠ¹í•œë‹¤."},unlock_sauce:{id:"unlock_sauce",name:"ë§ŒëŠ¥ ì†ŒìŠ¤ ê°œë°œ",cost:15e5,costEnzyme:30,prereq:"fermentation_lab",type:"unlock",productId:"kimchi_sauce",desc:"ëª¨ë“  ìš”ë¦¬ì˜ ë² ì´ìŠ¤ê°€ ë  ì†ŒìŠ¤ë¥¼ ê°œë°œí•œë‹¤."},unlock_rice:{id:"unlock_rice",name:"K-ë³¶ìŒë°¥ ë ˆì‹œí”¼",cost:25e5,costEnzyme:60,prereq:"unlock_sauce",type:"unlock",productId:"kimchi_fried_rice",desc:"ê¹€ì¹˜ì†ŒìŠ¤ì™€ ë°¥ì˜ ì™„ë²½í•œ ì¡°í™”."},unlock_fusion:{id:"unlock_fusion",name:"í“¨ì „ ì¤‘ì‹ ì—°êµ¬",cost:5e6,costEnzyme:100,prereq:"unlock_rice",type:"unlock",productId:"kimchi_tangsuyuk",desc:"ê¹€ì¹˜ì™€ íŠ€ê¸´ ê³ ê¸°ì˜ ë¬´ì‹œë¬´ì‹œí•œ ê²°í•©."},unlock_pasta:{id:"unlock_pasta",name:"ê¹€ì¹˜ íŒŒìŠ¤íƒ€ ì—°êµ¬",cost:1e7,costEnzyme:200,type:"unlock",productId:"kimchi_pasta",desc:"ì´íƒˆë¦¬ì•„ì˜ ë©´ê³¼ ì„œìš¸ì˜ ì†ŒìŠ¤ê°€ ë§Œë‚¬ë‹¤."},unlock_dining:{id:"unlock_dining",name:"íŒŒì¸ë‹¤ì´ë‹ ëŸ°ì¹­",cost:5e7,costEnzyme:500,type:"unlock",productId:"kimchi_dining",desc:"ê¹€ì¹˜ë¥¼ ì˜ˆìˆ ì˜ ê²½ì§€ë¡œ ëŒì–´ì˜¬ë¦°ë‹¤."},star_kimchi_ship:{id:"star_kimchi_ship",name:"ìŠ¤íƒ€ê¹€ì¹˜ì‹­ í”„ë¡œì íŠ¸",cost:1e8,costEnzyme:1e3,costItems:{kimchi_dining:10},type:"prestige",desc:"ì„œìš¸íƒ€ì›Œë¥¼ ë°œì‚¬ëŒ€ë¡œ ê°œì¡°í•˜ì—¬ ìš°ì£¼ë¡œ ê¹€ì¹˜ë¥¼ ì‹¤ì–´ ë‚˜ë¥¸ë‹¤. (ë°œì‚¬ ì‹œ ê²Œì„ ì´ˆê¸°í™” ë° AM íšë“)"}},_={am_prod_speed:{id:"am_prod_speed",name:"A1. ë” ë¹ ë¥¸ ì†",cost:1,desc:"ëª¨ë“  ìƒì‚° ë¼ì¸ ìƒì‚°ì†ë„ +25%",effects:{prodSpeedMult:1.25}},am_cost_reduce:{id:"am_cost_reduce",name:"A2. ì›ê°€ ì ˆê°",cost:1,desc:"ë ˆì‹œí”¼ ì…ë ¥ ì†Œëª¨ëŸ‰ -10%",effects:{costReduce:.1}},am_warehouse:{id:"am_warehouse",name:"B1. ë” í° ì°½ê³ ",cost:1,desc:"Keep ìˆ˜ìš©ëŸ‰(Cap) +50%",effects:{capMult:1.5}},am_auto_logi:{id:"am_auto_logi",name:"B2. ë¶„ë¥˜ ìë™í™”",cost:1,desc:"ë¬¼ë¥˜ ì†ë„ +40% (ë¶„ë¥˜ ìµœì í™”)",effects:{moveSpeedMult:1.4}},am_sales_org:{id:"am_sales_org",name:"C1. íŒë§¤ ì¡°ì§",cost:1,desc:"íŒë§¤ ì²˜ë¦¬ ì†ë„ +40%",effects:{sellSpeedMult:1.4}},am_premium:{id:"am_premium",name:"C2. ë¸Œëœë“œ í”„ë¦¬ë¯¸ì—„",cost:1,desc:"íŒë§¤ ë‹¨ê°€ +10%",effects:{priceMult:1.1}},am_res_eff:{id:"am_res_eff",name:"D1. ì—°êµ¬ íš¨ìœ¨",cost:1,desc:"ì—°êµ¬ íš¨ì†Œ ìš”êµ¬ëŸ‰ -20%",effects:{researchEnzymeReduce:.2}},am_res_cost:{id:"am_res_cost",name:"D2. ì—°êµ¬ë¹„ ì ˆê°",cost:1,desc:"ì—°êµ¬ í˜„ê¸ˆ ë¹„ìš© -15%",effects:{researchCashReduce:.15}},am_start_cash:{id:"am_start_cash",name:"E1. ì‹œì‘ ìë³¸",cost:1,desc:"í”„ë ˆìŠ¤í‹°ì§€ í›„ ì‹œì‘ í˜„ê¸ˆ +50%",effects:{startCashMult:1.5}},am_start_buff:{id:"am_start_buff",name:"E2. ì´ˆë°˜ ê°€ì†",cost:1,desc:"ì‹œì‘ í›„ 5ë¶„ê°„ ìƒì‚°ì†ë„ +25%",effects:{startBuffDuration:3e5,startBuffVal:1.25}}},L={a01:{id:"a01",title:"ì—„ë§ˆì˜ ëƒ‰ì¥ê³ ",desc:"ê²Œì„ ì‹œì‘ (ì²« ìƒì‚° 1íšŒ)",rewardLog:"l01"},a02:{id:"a02",title:"ì²« íŒë§¤",desc:"ë°°ì¶”ê¹€ì¹˜ 10ê°œ íŒë§¤",rewardBanner:"ì¥ì‚¬ ì‹œì‘"},a03:{id:"a03",title:"ë¶€ë…€íšŒ ê°€ì…",desc:"ê¹€ì¹˜ ëƒ‰ì¥ê³ (ì„¤ë¹„ T2) êµ¬ë§¤",rewardLog:"l02"},a04:{id:"a04",title:"ì¢ŒíŒ ê°œì‹œ",desc:"ë™ë„¤ ì‹œì¥(ì‹œì¥ T2) í•´ê¸ˆ",rewardLog:"l03"},a05:{id:"a05",title:"ë¬¼ë¥˜ì˜ ì‹œì‘",desc:"ë¬¼ë¥˜ ì¸ë ¥ 1ëª… ê³ ìš©",rewardLog:"l04"},a06:{id:"a06",title:"ìë™íŒë§¤ì˜ ì‹œì‘",desc:"íŒë§¤ ì•Œë°”(ì¡°ì§ T2) ê³ ìš©",rewardCheck:"íŒë§¤ ìë™í™”"},a07:{id:"a07",title:"ë°œíš¨ì‹¤í—˜ì‹¤ 1í˜¸",desc:"ë°œíš¨ì‹¤í—˜ì‹¤ í•´ê¸ˆ (íš¨ì†Œ ì˜¤í”ˆ)",rewardLog:"l05"},a08:{id:"a08",title:"ì†ŒìŠ¤ëŠ” ë² ì´ìŠ¤ë‹¤",desc:"ê¹€ì¹˜ì†ŒìŠ¤ í•´ê¸ˆ",rewardLog:"l06"},a09:{id:"a09",title:"ì²« í“¨ì „",desc:"ê¹€ì¹˜ íƒ•ìˆ˜ìœ¡ í•´ê¸ˆ",rewardCheck:"í“¨ì „ ì¹´ìš´íŠ¸"},a10:{id:"a10",title:"íŒŒì¸ë‹¤ì´ë‹ ì˜¤í”ˆ",desc:"ê¹€ì¹˜ íŒŒì¸ë‹¤ì´ë‹ í•´ê¸ˆ",rewardCheck:"ë°œì‚¬ ì¤€ë¹„"},a11:{id:"a11",title:"ë¯¸ë˜ ì¬ë£Œ 1í˜¸",desc:"ì‹ ì†Œì¬ í•´ê¸ˆ (Act3 í”„ë¦¬ë·°)",rewardLog:"l07"},a12:{id:"a12",title:"í´ë¦°ë£¸ ì…ì„±",desc:"ë°˜ë„ì²´ SoC í•´ê¸ˆ (Act3)",rewardCheck:"ë¯¸ë˜ì‚°ì—… ìƒì‚°"},a13:{id:"a13",title:"ì—°ì‚°ì˜ ì‹œëŒ€",desc:"GPU í•´ê¸ˆ (Act3)",rewardBanner:"ë°œì‚¬ ë ˆì‹œí”¼"},a14:{id:"a14",title:"íƒ€ì›Œì˜ ë¬¸ì„œ",desc:"ë°œì‚¬ëŒ€ ì—°êµ¬(ì‚¬ì‹¤ìƒ ìŠ¤íƒ€ê¹€ì¹˜ì‹­)",rewardLog:"l08"},a15:{id:"a15",title:"ìµœì¢… ì¡°ë¦½ ë§¤ë‰´ì–¼",desc:"ìŠ¤íƒ€ê¹€ì¹˜ì‹­ ì œì‘ ê°€ëŠ¥",rewardLog:"l09"},a16:{id:"a16",title:"ì²« ë°œì‚¬",desc:"ìŠ¤íƒ€ê¹€ì¹˜ì‹­ ë°œì‚¬ 1íšŒ",rewardLog:"l10",rewardAM:1},a17:{id:"a17",title:"ë‘ ë²ˆì§¸ ë°œì‚¬",desc:"ë°œì‚¬ 2íšŒ ë‹¬ì„±",rewardLog:"l11"},a18:{id:"a18",title:"ë‹¤ì„¯ ë²ˆì§¸ ë°œì‚¬",desc:"ë°œì‚¬ 5íšŒ ë‹¬ì„±",rewardLog:"l12"},a19:{id:"a19",title:"ê³µì • ìµœì í™”",desc:"ì¡°ê±´ë¶€ ë¶„ë¥˜ í™œì„±í™” + ëª¨ë“ˆ ì œì‘",rewardMedal:"ë¬¼ë¥˜ ì¥ì¸"},a20:{id:"a20",title:"ê·¼ë³¸ì€ ë°°ì¶”ê¹€ì¹˜",desc:"ë°œì‚¬ ì§ì „ ë°°ì¶”ê¹€ì¹˜ ìƒì‚° ìœ ì§€",rewardMedal:"ê·¼ë³¸"}},S={l01:{id:"l01",title:"ì—„ë§ˆì˜ ëƒ‰ì¥ê³ ",content:'ì„œìš¸ì˜ ìƒì¡´ì€ ëŠ˜ í•˜ë‚˜ì˜€ë‹¤. ë‚¨ê¸°ëŠ” ê²Œ ì•„ë‹ˆë¼, ìŒ“ëŠ” ê²ƒ. ê±°ì°½í•œ ê³„íšì€ ì—†ë‹¤. "ì—„ë§ˆê¹€ì¹˜... íŒ”ì•„ë³¼ê¹Œ?"',condition:()=>!0},l02:{id:"l02",title:"ë¶€ë…€íšŒ ê³µë™êµ¬ë§¤ ì „ë‹¨ì§€",content:"ê¹€ì¹˜ê°€ ì§„ì§œë¡œ íŒ”ë¦¬ê¸° ì‹œì‘í–ˆë‹¤. ë¶€ë…€íšŒì—ì„œ ì¥ë¹„ë¥¼ ê°™ì´ ì‚¬ìê³  í•œë‹¤. ì´ê±´ ì¥ì‚¬ê°€ ë  ê²ƒ ê°™ë‹¤.",condition:h=>h.hasAchievement("a03")},l03:{id:"l03",title:"ì‹œì¥ ì¢ŒíŒì˜ ê·œì¹™",content:'ì§‘ ì•ì—ì„œ íŒ”ë˜ ê¹€ì¹˜ê°€ ì‹œì¥ìœ¼ë¡œ ë“¤ì–´ì™”ë‹¤. ì´ì œëŠ” "ë§Œë“œëŠ” ì†ë„"ë³´ë‹¤ "íŒŒëŠ” êµ¬ì¡°"ê°€ ì¤‘ìš”í•´ì§„ë‹¤.',condition:h=>h.hasAchievement("a04")},l04:{id:"l04",title:"ë‚©í’ˆì€ ê¹€ì¹˜ê°€ ì•„ë‹ˆë¼ ë¬¼ë¥˜ë‹¤",content:'ì‹ë‹¹ì—ì„œ ì—°ë½ì´ ì˜¨ë‹¤. ë¬¸ì œëŠ” í•˜ë‚˜ë‹¤. ê¹€ì¹˜ê°€ ì•„ë‹ˆë¼ "ë¬¼ë¥˜"ê°€ ë„ˆë¥¼ ì£½ì´ê¸° ì‹œì‘í•œë‹¤.',condition:h=>h.hasAchievement("a05")},l05:{id:"l05",title:"ë°œíš¨ì‹¤í—˜ì‹¤ ê¸°ë¡ 1í˜¸",content:"ê¹€ì¹˜ëŠ” ì‹œê°„ì´ ë§Œë“ ë‹¤. ê·¸ë¦¬ê³  ì‹œê°„ì€ ì—°êµ¬í•  ìˆ˜ ìˆë‹¤. ì‹¤í—˜ì‹¤ì´ ì—´ë ¸ê³ , íš¨ì†Œê°€ ë³´ì´ê¸° ì‹œì‘í•œë‹¤.",condition:h=>h.hasAchievement("a07")},l06:{id:"l06",title:"ê¹€ì¹˜ì†ŒìŠ¤ëŠ” ë² ì´ìŠ¤ë‹¤",content:"ê¹€ì¹˜ëŠ” íŒ”ë¦¬ëŠ” ìŒì‹ì´ ì•„ë‹ˆë¼, ì•ˆì •ì ì¸ ê¸ˆìœµìƒí’ˆì´ë‹¤. ê¹€ì¹˜ì†ŒìŠ¤ê°€ ê·¸ ì¦ê±°ë‹¤.",condition:h=>h.hasAchievement("a08")},l07:{id:"l07",title:"ë¯¸ë˜ì‚°ì—…ì˜ ì²« ì¬ë£Œ",content:"ëˆ„êµ°ê°€ ê¹€ì¹˜ ìœ ì‚°ê· ìœ¼ë¡œ ì‹ ì†Œì¬ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤ê³  í–ˆë‹¤. ë§ë„ ì•ˆ ë˜ì§€ë§Œ, ì„œìš¸ì´ë‹ˆê¹Œ ê°€ëŠ¥í• ì§€ë„ ëª¨ë¥¸ë‹¤.",condition:h=>h.hasAchievement("a11")},l08:{id:"l08",title:"ì„œìš¸íƒ€ì›Œ ê¸°ìˆ ë¬¸ì„œ",content:"ì„œìš¸íƒ€ì›ŒëŠ” ì›ë˜ í†µì‹ íƒ‘ì´ ì•„ë‹ˆì—ˆë‹¤. ê·¸ êµ¬ì¡°ëŠ” ì²˜ìŒë¶€í„° ë°œì‚¬ëŒ€ë¥¼ ì—¼ë‘ì— ë‘ê³  ìˆì—ˆë‹¤.",condition:h=>h.hasAchievement("a14")},l09:{id:"l09",title:"ìŠ¤íƒ€ê¹€ì¹˜ì‹­: ì¡°ë¦½ ë§¤ë‰´ì–¼",content:"ì´ ìš°ì£¼ì„ ì€ ì—°ë£Œê°€ ì•„ë‹ˆë¼ ë°œíš¨ ê°€ìŠ¤ë¡œ ì›€ì§ì¸ë‹¤. ë†ë‹´ ê°™ì§€ë§Œ ì§„ì§œë‹¤.",condition:h=>h.hasAchievement("a15")},l10:{id:"l10",title:"ì™¸ê³„ë¬¼ì§ˆ(AM) íšŒìˆ˜ ë³´ê³ ì„œ",content:'ìŠ¤íƒ€ê¹€ì¹˜ì‹­ì´ ê·€í™˜í–ˆë‹¤. ì™¸ê³„ë¬¼ì§ˆ 1ì„ í™•ë³´í–ˆë‹¤. ì—°êµ¬ íƒ­ì—ì„œ "ì™¸ê³„ë¬¼ì§ˆ ì—°êµ¬ì†Œ"ë¥¼ ì—´ì–´ë³´ì.',condition:h=>h.hasAchievement("a16")},l11:{id:"l11",title:"ë‘ ë²ˆì§¸ ë°œì‚¬: ì‹ í˜¸ê°€ ë˜ëŒì•„ì˜¤ë‹¤",content:"ë¬´ì–¸ê°€ê°€ ë‹µì¥ì„ ë³´ëƒˆë‹¤. ë‹¨ìˆœí•œ ë°˜ì‚¬ê°€ ì•„ë‹ˆë‹¤. ëª…ë°±í•œ ì˜ë„ê°€ ë‹´ê¸´ ì‹ í˜¸ë‹¤.",condition:h=>h.hasAchievement("a17")},l12:{id:"l12",title:"ë‹¤ì„¯ ë²ˆì§¸ ë°œì‚¬: ëˆ„êµ°ê°€ ë“£ê³  ìˆë‹¤",content:"ê·œì¹™ì„ ë°”ê¾¸ëŠ” ìë¥¼... ëˆ„êµ°ê°€ê°€ ë³´ê³  ìˆë‹¤. ì´ì œ ë˜ëŒë¦´ ìˆ˜ ì—†ë‹¤.",condition:h=>h.hasAchievement("a18")}};class w{constructor(){this.cash=0,this.enzyme=0,this.am=0,this.lines=[],this.productInventory={},this.itemInventory={},this.completedResearch=[],this.amUpgrades=[],this.completedAchievements=[],this.isResetting=!1,this.startBuffEndTime=0,this.init(),this.isResetting=!1}init(){this.load(),this.lines.length===0&&this.initNewGame()}initNewGame(){this.cash=0,this.enzyme=0,this.completedResearch=[],this.productInventory={},this.itemInventory={},this.itemInventory.eq_mom_fridge=1,this.itemInventory.wk_me=1,this.itemInventory.lg_box=1,this.itemInventory.tr_hand=1,this.itemInventory.mk_neighborhood=1,this.itemInventory.so_solo=1,this.lines=[{id:1,productId:"kimchi_1",slots:{equipment:"eq_mom_fridge",worker:"wk_me",storage:"lg_box",transporter:"tr_hand",market:"mk_neighborhood",salesOrg:"so_solo"},logisticsDir:"keep"}],this.productInventory.kimchi_1={keep:0,sell:0,cap:100}}tick(e){const i=this.getAMBuffs(),s=i.prodSpeedMult*i.startBuffVal;this.lines.forEach(t=>{const o=t.productId;if(!o)return;let a=100;this.productInventory[o].cap=Math.floor(a*i.capMult);const n=t.slots.worker;if(n&&m[n]){let r=(m[n].effects.prodSpeed||0)*s;if(r>0&&(t.prodAccumulator||(t.prodAccumulator=0),t.prodAccumulator+=r*e,t.prodAccumulator>=1)){const d=Math.floor(t.prodAccumulator);this.produceAuto(t.id,d,i),t.prodAccumulator-=d}}const c=t.slots.salesOrg;if(c&&m[c]){let r=(m[c].effects.sellSpeed||0)*i.sellSpeedMult;if(r>0&&(t.sellAccumulator||(t.sellAccumulator=0),t.sellAccumulator+=r*e,t.sellAccumulator>=1)){const d=Math.floor(t.sellAccumulator);this.sellAuto(t.id,d,i),t.sellAccumulator-=d}}const l=t.slots.transporter;if(l&&m[l]){let r=(m[l].effects.moveSpeed||0)*i.moveSpeedMult;if(r>0&&(t.logiAccumulator||(t.logiAccumulator=0),t.logiAccumulator+=r*e,t.logiAccumulator>=1)){const d=Math.floor(t.logiAccumulator);this.moveAuto(t.id,d),t.logiAccumulator-=d}}}),this.checkAchievements()}moveAuto(e,i){const s=this.lines.find(c=>c.id===e);if(!s)return;const t=this.productInventory[s.productId];let o=1;const a=s.slots.storage;a&&m[a]&&(o+=m[a].effects.moveBatch||0);const n=o*i;if(s.logisticsDir==="sell"){const c=Math.min(n,t.keep);c>0&&(t.keep-=c,t.sell+=c,this.hasAutomatedChanges=!0)}else{const c=Math.min(n,t.sell);c>0&&(t.sell-=c,t.keep+=c,this.hasAutomatedChanges=!0)}}produceAuto(e,i,s){const t=this.lines.find(u=>u.id===e);if(!t)return;const o=t.productId,a=this.productInventory[o];if(!this.checkRecipe(o,i,s))return;let n=1;const c=t.slots.equipment;c&&m[c]&&(n+=m[c].effects.batch||0);const l=n*i,r=a.keep+a.sell;let d=l;r+d>a.cap&&(d=a.cap-r),d>0&&(this.consumeRecipe(o,i,s),o==="enzyme_vial"?this.enzyme+=d:a.keep+=d,this.hasAutomatedChanges=!0)}sellAuto(e,i,s){const t=this.lines.find(d=>d.id===e);if(!t)return;const o=t.productId,a=this.productInventory[o];let n=1;const c=t.slots.market;c&&m[c]&&(n+=m[c].effects.sellAmount||0);const l=n*i,r=this.getProductPrice(o);if(a.sell>=l)a.sell-=l,this.cash+=r*l,this.hasAutomatedChanges=!0;else if(a.sell>0){const d=a.sell;a.sell=0,this.cash+=r*d,this.hasAutomatedChanges=!0}}produce(e){const i=this.lines.find(r=>r.id===e);if(!i)return 0;const s=i.productId,t=this.productInventory[s],o=this.getAMBuffs();if(!this.checkRecipe(s,1,o))return-1;let a=1;const n=i.slots.equipment;n&&m[n]&&(a+=m[n].effects.batch||0);const c=t.keep+t.sell;if(c>=t.cap)return 0;let l=a;return c+l>t.cap&&(l=t.cap-c),l>0?(this.consumeRecipe(s,1,o),s==="enzyme_vial"?this.enzyme+=l:t.keep+=l,this.save(),l):0}moveLogistics(e,i){const s=this.lines.find(l=>l.id===e);if(!s)return;const t=s.productId,o=this.productInventory[t],a=this.getAMBuffs();let n=1;const c=s.slots.storage;if(c&&m[c]){let l=m[c].effects.moveBatch||0;l===0&&(l=1),n+=Math.floor(l*a.moveSpeedMult)}if(i==="sell"){if(o.keep>=n)return o.keep-=n,o.sell+=n,this.save(),!0}else if(i==="keep"&&o.sell>=n)return o.sell-=n,o.keep+=n,this.save(),!0;return!1}sell(e){const i=this.lines.find(n=>n.id===e);if(!i)return;const s=i.productId,t=this.productInventory[s];let o=1;const a=i.slots.market;if(a&&m[a]&&(o+=m[a].effects.sellAmount||0),t.sell>=o){t.sell-=o;const n=this.getProductPrice(s);return this.cash+=n*o,this.save(),n*o}return 0}prestige(){this.am+=1;const e=this.getAMBuffs();e.startCashMult>1?this.cash=1e6*e.startCashMult:this.cash=1e6,this.enzyme=0,this.completedResearch=[],this.productInventory={},this.itemInventory={},e.startBuffDuration&&e.startBuffDuration>0&&(this.startBuffEndTime=Date.now()+e.startBuffDuration),this.lines=[{id:1,productId:"kimchi_1",slots:{equipment:"eq_mom_fridge",worker:"wk_me",storage:"lg_box",transporter:"tr_hand",market:"mk_neighborhood",salesOrg:"so_solo"},logisticsDir:"keep"}],this.itemInventory.eq_mom_fridge=1,this.itemInventory.wk_me=1,this.itemInventory.lg_box=1,this.itemInventory.tr_hand=1,this.itemInventory.mk_neighborhood=1,this.itemInventory.so_solo=1,this.productInventory.kimchi_1={keep:0,sell:0,cap:100},alert("ìŠ¤íƒ€ê¹€ì¹˜ì‹­ì´ ë°œì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ì™¸ê³„ë¬¼ì§ˆ(AM) 1ì„ íšë“í–ˆìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ ê·œì¹™ì—ì„œ ë‹¤ì‹œ ì‹œì‘í•©ë‹ˆë‹¤."),this.save(),location.reload()}buyLine(){const e=this.getLineCost();if(this.cash>=e){this.cash-=e;const i=this.lines.reduce((s,t)=>Math.max(s,t.id),0)+1;return this.lines.push({id:i,productId:null,slots:{equipment:"eq_mom_fridge",worker:"wk_me",storage:"lg_box",transporter:"tr_hand",market:"mk_neighborhood",salesOrg:"so_solo"},logisticsDir:"sell"}),this.save(),!0}return!1}getAMBuffs(){const e={prodSpeedMult:1,costReduce:0,capMult:1,moveSpeedMult:1,sellSpeedMult:1,priceMult:1,researchEnzymeReduce:0,researchCashReduce:0,startCashMult:1,startBuffVal:1};if(this.amUpgrades.forEach(i=>{const s=_[i];s&&(s.effects.prodSpeedMult&&(e.prodSpeedMult*=s.effects.prodSpeedMult),s.effects.costReduce&&(e.costReduce+=s.effects.costReduce),s.effects.capMult&&(e.capMult*=s.effects.capMult),s.effects.moveSpeedMult&&(e.moveSpeedMult*=s.effects.moveSpeedMult),s.effects.sellSpeedMult&&(e.sellSpeedMult*=s.effects.sellSpeedMult),s.effects.priceMult&&(e.priceMult*=s.effects.priceMult),s.effects.researchEnzymeReduce&&(e.researchEnzymeReduce+=s.effects.researchEnzymeReduce),s.effects.researchCashReduce&&(e.researchCashReduce+=s.effects.researchCashReduce),s.effects.startCashMult&&(e.startCashMult*=s.effects.startCashMult))}),Date.now()<this.startBuffEndTime){const i=_.am_start_buff;this.amUpgrades.includes("am_start_buff")&&(e.startBuffVal=i.effects.startBuffVal)}return e}tick(e){const i=this.getAMBuffs(),s=i.prodSpeedMult*i.startBuffVal;this.lines.forEach(t=>{const o=t.productId;if(!o)return;let a=100;this.productInventory[o].cap=Math.floor(a*i.capMult);const n=t.slots.worker;if(n&&m[n]){let r=(m[n].effects.prodSpeed||0)*s;if(r>0&&(t.prodAccumulator||(t.prodAccumulator=0),t.prodAccumulator+=r*e,t.prodAccumulator>=1)){const d=Math.floor(t.prodAccumulator);this.produceAuto(t.id,d,i),t.prodAccumulator-=d}}const c=t.slots.market;if(c&&m[c]){let r=(m[c].effects.sellSpeed||0)*i.sellSpeedMult;if(r>0&&(t.sellAccumulator||(t.sellAccumulator=0),t.sellAccumulator+=r*e,t.sellAccumulator>=1)){const d=Math.floor(t.sellAccumulator);this.sellAuto(t.id,d,i),t.sellAccumulator-=d}}const l=t.slots.logistics;if(l&&m[l]){let r=(m[l].effects.moveSpeed||0)*i.moveSpeedMult;if(r>0&&(t.logiAccumulator||(t.logiAccumulator=0),t.logiAccumulator+=r*e,t.logiAccumulator>=1)){const d=Math.floor(t.logiAccumulator);this.moveAuto(t.id,d),t.logiAccumulator-=d}}}),this.checkAchievements()}checkAchievements(){Object.values(L).forEach(e=>{if(this.completedAchievements.includes(e.id))return;let i=!1;e.id==="a01"?(this.productInventory.kimchi_1.keep>0||this.productInventory.kimchi_1.sell>0)&&(i=!0):e.id==="a02"?this.cash>=5e4&&(i=!0):e.id==="a03"?(this.itemInventory.eq_dimchae>0||this.isItemEquipped("eq_dimchae"))&&(i=!0):e.id==="a04"?(this.itemInventory.mk_supermarket>0||this.isItemEquipped("mk_supermarket"))&&(i=!0):e.id==="a05"?Object.keys(this.itemInventory).some(s=>m[s]&&m[s].type==="logistics")&&(i=!0):e.id==="a07"?this.completedResearch.includes("fermentation_lab")&&(i=!0):e.id==="a08"?this.completedResearch.includes("unlock_sauce")&&(i=!0):e.id==="a09"?this.completedResearch.includes("unlock_fusion")&&(i=!0):e.id==="a10"?this.completedResearch.includes("unlock_dining")&&(i=!0):e.id==="a14"?this.completedResearch.includes("star_kimchi_ship")&&(i=!0):e.id==="a16"&&this.am>=1&&(i=!0),i&&(this.completedAchievements.push(e.id),this.save(),window.dispatchEvent(new CustomEvent("achievement-unlocked",{detail:e})))})}hasAchievement(e){return this.completedAchievements.includes(e)}isItemEquipped(e){return this.lines.some(i=>Object.values(i.slots).includes(e))}checkRecipe(e,i=1,s=null){const t=g[e];if(!t.recipe)return!0;const o=s?1-s.costReduce:1;for(const[a,n]of Object.entries(t.recipe)){const c=Math.ceil(n*i*o),l=this.productInventory[a];if(!l||l.keep<c)return!1}return!0}consumeRecipe(e,i=1,s=null){const t=g[e];if(!t.recipe)return;const o=s?1-s.costReduce:1;for(const[a,n]of Object.entries(t.recipe)){const c=Math.ceil(n*i*o);this.productInventory[a].keep-=c}}moveAuto(e,i){const s=this.lines.find(o=>o.id===e);if(!s)return;const t=this.productInventory[s.productId];if(s.logisticsDir==="sell"){const o=Math.min(i,t.keep);o>0&&(t.keep-=o,t.sell+=o,this.hasAutomatedChanges=!0)}else{const o=Math.min(i,t.sell);o>0&&(t.sell-=o,t.keep+=o,this.hasAutomatedChanges=!0)}}produceAuto(e,i,s){const t=this.lines.find(u=>u.id===e);if(!t)return;const o=t.productId,a=this.productInventory[o];if(!this.checkRecipe(o,i,s))return;let n=1;const c=t.slots.equipment;c&&m[c]&&(n+=m[c].effects.batch||0);const l=n*i,r=a.keep+a.sell;let d=l;r+d>a.cap&&(d=a.cap-r),d>0&&(this.consumeRecipe(o,i,s),o==="enzyme_vial"?this.enzyme+=d:a.keep+=d,this.hasAutomatedChanges=!0)}sellAuto(e,i,s){const t=this.lines.find(d=>d.id===e);if(!t)return;const o=t.productId,a=this.productInventory[o];let n=1;const c=t.slots.salesOrg;c&&m[c]&&(n+=m[c].effects.sellAmount||0);const l=n*i,r=this.getProductPrice(o);if(a.sell>=l)a.sell-=l,this.cash+=r*l,this.hasAutomatedChanges=!0;else if(a.sell>0){const d=a.sell;a.sell=0,this.cash+=r*d,this.hasAutomatedChanges=!0}}getProductPrice(e){let s=g[e].price;return this.completedResearch.forEach(t=>{const o=I[t];o&&o.type==="buff"&&o.effects.priceMult&&(s*=o.effects.priceMult)}),this.amUpgrades.forEach(t=>{const o=_[t];o.effects.priceMult&&(s*=o.effects.priceMult)}),s}produce(e){const i=this.lines.find(r=>r.id===e);if(!i)return 0;const s=i.productId,t=this.productInventory[s],o=this.getAMBuffs();if(!this.checkRecipe(s,1,o))return-1;let a=1;const n=i.slots.equipment;n&&m[n]&&(a+=m[n].effects.batch||0);const c=t.keep+t.sell;if(c>=t.cap)return 0;let l=a;return c+l>t.cap&&(l=t.cap-c),l>0?(this.consumeRecipe(s,1,o),s==="enzyme_vial"?this.enzyme+=l:t.keep+=l,this.save(),l):0}moveLogistics(e,i){const s=this.lines.find(l=>l.id===e);if(!s)return;const t=s.productId,o=this.productInventory[t],a=this.getAMBuffs();let n=1;const c=s.slots.logistics;if(c&&m[c]){let l=m[c].effects.moveSpeed||0;l===0&&(l=1),n+=Math.floor(l*a.moveSpeedMult)}if(i==="sell"){if(o.keep>=n)return o.keep-=n,o.sell+=n,this.save(),!0}else if(i==="keep"&&o.sell>=n)return o.sell-=n,o.keep+=n,this.save(),!0;return!1}sell(e){const i=this.lines.find(n=>n.id===e);if(!i)return;const s=i.productId,t=this.productInventory[s];this.getAMBuffs();let o=1;const a=i.slots.salesOrg;if(a&&m[a]&&(o+=m[a].effects.sellAmount||0),t.sell>=o){t.sell-=o;const n=this.getProductPrice(s);return this.cash+=n*o,this.save(),n*o}return 0}initItems(){this.itemInventory={}}buyItem(e){const i=m[e];return i&&this.cash>=i.cost?(this.cash-=i.cost,this.itemInventory[e]=(this.itemInventory[e]||0)+1,this.save(),!0):!1}equipItem(e,i,s){const t=this.lines.find(a=>a.id===e);return!t||!this.itemInventory[s]||this.itemInventory[s]<=0?!1:(t.slots[i]&&this.unequipItem(e,i),this.itemInventory[s]--,t.slots[i]=s,this.save(),!0)}unequipItem(e,i){const s=this.lines.find(o=>o.id===e);if(!s)return!1;const t=s.slots[i];return t?(this.itemInventory[t]=(this.itemInventory[t]||0)+1,s.slots[i]=null,this.save(),!0):!1}buyResearch(e){const i=I[e];if(!i||this.completedResearch.includes(e))return!1;const s=this.getAMBuffs();let t=i.cost||0;s.researchCashReduce>0&&(t=Math.floor(t*(1-s.researchCashReduce)));let o=i.costEnzyme||0;if(s.researchEnzymeReduce>0&&(o=Math.floor(o*(1-s.researchEnzymeReduce))),this.cash<t||this.enzyme<o)return!1;if(i.costItems){for(const[a,n]of Object.entries(i.costItems))if(!this.productInventory[a]||this.productInventory[a].keep<n)return!1}if(this.cash-=t,this.enzyme-=o,i.costItems)for(const[a,n]of Object.entries(i.costItems))this.productInventory[a].keep-=n;return this.completedResearch.push(e),this.checkAchievements(),i.type==="prestige"&&(this.prestige(),this.checkAchievements()),this.save(),!0}buyAMUpgrade(e){const i=_[e];return!i||this.amUpgrades.includes(e)?!1:this.am>=i.cost?(this.am-=i.cost,this.amUpgrades.push(e),this.save(),!0):!1}prestige(){this.am+=1;const e=this.getAMBuffs();this.cash=1e6*(e.startCashMult-1),e.startCashMult>1?this.cash=1e6*e.startCashMult:this.cash=1e6,this.enzyme=0,this.completedResearch=[],this.productInventory={},this.itemInventory={},e.startBuffDuration&&e.startBuffDuration>0&&(this.startBuffEndTime=Date.now()+e.startBuffDuration),this.lines=[{id:1,productId:"kimchi_1",slots:{equipment:"eq_mom_fridge",worker:"wk_me",logistics:null,market:null,salesOrg:null},logisticsDir:"keep"}],this.itemInventory.eq_mom_fridge=1,this.itemInventory.wk_me=1,this.productInventory.kimchi_1={keep:0,sell:0,cap:100},alert("ìŠ¤íƒ€ê¹€ì¹˜ì‹­ì´ ë°œì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ì™¸ê³„ë¬¼ì§ˆ(AM) 1ì„ íšë“í–ˆìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ ê·œì¹™ì—ì„œ ë‹¤ì‹œ ì‹œì‘í•©ë‹ˆë‹¤."),this.save(),location.reload()}getInventoryValue(){let e=0;for(const i in this.productInventory){const s=this.productInventory[i],t=g[i];t&&t.price?e+=(s.keep+s.sell)*t.price:i==="enzyme_vial"&&(e+=(s.keep+s.sell)*5e4)}return e+=this.enzyme*5e4,e}getAssetValue(){let e=0;const i=this.lines.length;for(let s=0;s<i;s++){const t=v.line_base_cost*Math.pow(v.line_cost_growth,s);e+=t*v.refund_rate}this.lines.forEach(s=>{Object.values(s.slots).forEach(t=>{t&&m[t]&&(e+=m[t].cost)})});for(const s in this.itemInventory)m[s]&&(e+=m[s].cost*this.itemInventory[s]);return e}getEnterpriseValue(){return this.cash+this.getInventoryValue()+this.getAssetValue()}getLineCost(){const e=this.lines?this.lines.length:0;return v.line_base_cost*Math.pow(v.line_cost_growth,e-1)}buyLine(){const e=this.getLineCost();if(this.cash>=e){this.cash-=e;const i=this.lines.reduce((s,t)=>Math.max(s,t.id),0)+1;return this.lines.push({id:i,productId:null,slots:{equipment:"eq_mom_fridge",worker:"wk_me",logistics:"lg_hand",market:"mk_neighborhood",salesOrg:"so_solo"},logisticsDir:"sell"}),this.save(),!0}return!1}removeLine(e){if(this.lines.length<=1)return alert("ìµœì†Œ í•˜ë‚˜ì˜ ìƒì‚° ë¼ì¸ì€ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤."),!1;const i=this.lines.findIndex(o=>o.id===e);if(i===-1)return!1;const s=this.lines[i];Object.values(s.slots).forEach(o=>{o&&(this.itemInventory[o]=(this.itemInventory[o]||0)+1)});const t=v.line_base_cost*Math.pow(v.line_cost_growth,this.lines.length-2);return this.cash+=t*v.refund_rate,this.lines.splice(i,1),this.save(),!0}assignProduct(e,i){const s=this.lines.find(t=>t.id===e);s&&(s.productId=i,this.productInventory[i]||(this.productInventory[i]={keep:0,sell:0,cap:100}),this.save())}toggleLogisticsDir(e){const i=this.lines.find(s=>s.id===e);i&&(i.logisticsDir=i.logisticsDir==="keep"?"sell":"keep",this.save())}unlockLine(e){this.productInventory[e]||(this.productInventory[e]={keep:0,sell:0,cap:100})}save(){if(this.isResetting)return;const e={cash:this.cash,enzyme:this.enzyme,am:this.am,lines:this.lines,productInventory:this.productInventory,itemInventory:this.itemInventory,completedResearch:this.completedResearch,amUpgrades:this.amUpgrades,completedAchievements:this.completedAchievements,startBuffEndTime:this.startBuffEndTime};localStorage.setItem("kimchi_invasion_save_v1",JSON.stringify(e)),window.dispatchEvent(new CustomEvent("kimchi-saved"))}load(){const e=localStorage.getItem("kimchi_invasion_save_v1");if(e){const i=JSON.parse(e);this.cash=i.cash||0,this.enzyme=i.enzyme||0,this.am=i.am||0,this.lines=i.lines||[],this.lines.forEach(s=>{s.slots||(s.slots={}),s.slots.equipment||(s.slots.equipment="eq_mom_fridge"),s.slots.worker||(s.slots.worker="wk_me"),s.slots.storage||(s.slots.storage="lg_box"),s.slots.transporter||(s.slots.transporter="tr_hand"),s.slots.market||(s.slots.market="mk_neighborhood"),s.slots.salesOrg||(s.slots.salesOrg="so_solo"),s.id||(s.id=Date.now()+Math.random().toString(36).substr(2,5))}),this.productInventory=i.productInventory||{},this.itemInventory=i.itemInventory||{},this.completedResearch=i.completedResearch||[],this.amUpgrades=i.amUpgrades||[],this.completedAchievements=i.completedAchievements||[],this.startBuffEndTime=i.startBuffEndTime||0}}}class M{constructor(e){var i,s;this.game=e,this.els={cash:document.getElementById("res-cash"),enzyme:document.getElementById("res-enzyme"),enzymeContainer:(i=document.getElementById("res-enzyme"))==null?void 0:i.parentElement,am:document.getElementById("res-am"),amContainer:(s=document.getElementById("res-am"))==null?void 0:s.parentElement,prodList:document.getElementById("prod-list"),logiList:document.getElementById("logi-list"),salesList:document.getElementById("sales-list"),researchList:document.getElementById("research-list"),statsList:document.getElementById("stats-list"),tabs:document.querySelectorAll(".tab-btn"),cols:document.querySelectorAll(".col")},this.setupTabs(),this.setupGlobalButtons(),this.setupAchievementListener(),this.displayCash=0}getImageUrl(e,i){return e==="prod"?"src/assets/images/prod_base.png":e==="logi"?"src/assets/images/logi_base.png":e==="sales"?"src/assets/images/sales_base.png":null}init(){this.renderLines(),this.renderResearch(),this.renderStats(),this.update(),window.addEventListener("kimchi-saved",()=>this.showAutoSaveIndicator()),this.game.lines.length===1&&!this.game.completedAchievements.length&&this.game.lines[0].slots.worker===null&&(this.game.completedResearch.includes("unlock_kkakdugi")||this.showModal("START_GAME"))}setupTabs(){document.body.setAttribute("data-active-tab","prod"),this.els.tabs.forEach(e=>{e.addEventListener("click",()=>{const i=e.dataset.tab;this.els.tabs.forEach(t=>t.classList.remove("active")),e.classList.add("active"),document.body.setAttribute("data-active-tab",i);const s={prod:"col-prod",logi:"col-logi",sales:"col-sales",research:"col-research",stats:"col-stats"};this.els.cols.forEach(t=>{t.classList.remove("active"),t.id===s[i]&&t.classList.add("active")})})})}setupGlobalButtons(){const e=document.getElementById("btn-add-line-global");e&&e.addEventListener("click",()=>{const c=this.game.getLineCost();confirm(`ìƒì‚° ë¼ì¸ì„ ì¶”ê°€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
ë¹„ìš©: ${c.toLocaleString()}ì›`)&&(this.game.buyLine()?(this.renderLines(),this.update()):alert("í˜„ê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤."))});const i=document.getElementById("btn-settings");i&&i.addEventListener("click",()=>{this.showModal("SETTINGS")});const s=document.getElementById("btn-help");s&&s.addEventListener("click",()=>this.showModal("HELP"));const t=document.querySelector(".favorite-btn");t&&t.addEventListener("click",()=>alert("Ctrl+Dë¥¼ ëˆŒëŸ¬ ì¦ê²¨ì°¾ê¸°ì— ì¶”ê°€í•˜ì„¸ìš”!"));const o=document.querySelector(".share-btn");o&&o.addEventListener("click",async()=>{if(navigator.share)try{await navigator.share({title:"Kimchi Invasion",text:"ê¹€ì¹˜ë¡œ ìš°ì£¼ë¥¼ ì •ë³µí•˜ë¼! Kimchi Invasion",url:location.href}),this.showToast("ê³µìœ  ì°½ì´ ì—´ë ¸ìŠµë‹ˆë‹¤.")}catch(c){console.log("Share canceled or failed",c)}else navigator.clipboard.writeText(location.href),this.showToast("ë§í¬ ë³µì‚¬ ì™„ë£Œ!")});const a=document.querySelector(".account-btn"),n=document.querySelector(".account-dropdown");a&&n&&(a.addEventListener("click",c=>{c.stopPropagation(),n.style.display=n.style.display==="block"?"none":"block"}),document.addEventListener("click",()=>n.style.display="none"),n.addEventListener("click",c=>c.stopPropagation()))}setupAchievementListener(){window.addEventListener("achievement-unlocked",e=>{const i=e.detail;this.showToast(`ğŸ† ì—…ì  ë‹¬ì„±: ${i.title}`),this.renderStats();const s=Object.values(S).find(t=>t.condition(this.game)&&t.id===i.rewardLog);s&&(["l01","l10","l08"].includes(s.id)?this.showModal("LOGBOOK_ENTRY",s):this.showToast(`ğŸ“– ë¡œê·¸ë¶ ê¸°ë¡ë¨: ${s.title}`),this.renderStats())})}renderLines(){try{this.els.prodList.innerHTML="",this.els.logiList.innerHTML="",this.els.salesList.innerHTML="",(this.game.lines||[]).forEach((s,t)=>{const o=this.renderProdCard(s,t);this.els.prodList.appendChild(o);const a=this.renderLogiCard(s,t);this.els.logiList.appendChild(a);const n=this.renderSalesCard(s,t);this.els.salesList.appendChild(n)});const i=this.createAddLineBtn();this.els.prodList.appendChild(i),this.update()}catch(e){console.error("RenderLines Error:",e),this.showToast("Render Error: "+e.message,"error")}}createAddLineBtn(){const e=document.createElement("button");e.className="btn btn-add-line-main",e.style.width="100%",e.style.marginTop="10px";const i=this.game.getLineCost();return e.innerHTML=`+ ìƒˆ ë¼ì¸ í™•ë³´ (â‚©${i.toLocaleString()})`,e.onclick=()=>{this.game.buyLine()?(this.renderLines(),this.update()):this.showToast("ìê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤.","error")},e}renderProdCard(e,i){var l,r;const s=document.createElement("div");s.className="card prod-card animate-fade-in",s.id=`card-prod-${e.id}`,s.dataset.lineId=e.id;const t=g[e.productId];if(!t)return s.innerHTML=`
                <div class="card-comp-header">
                    <span class="card-comp-title">LINE #${i+1}</span>
                </div>
                <div class="card-body" style="align-items:center; justify-content:center; min-height:100px; display:flex; flex-direction:column;">
                    <button class="btn btn-sm btn-assign">ìƒì‚° í’ˆëª© í• ë‹¹</button>
                    <div style="font-size:10px; color:var(--text-muted); margin-top:8px;">Ready to Start</div>
                </div>
            `,s.querySelector(".btn-assign").onclick=d=>this.showProductPicker(d,e.id),s;const o=this.game.getAMBuffs(),a=(d,u)=>{if(!e.slots[d])return 0;const f=m[e.slots[d]];return f&&f.effects[u]||0};let n=a("worker","prodSpeed")*o.prodSpeedMult*o.startBuffVal,c=1+a("equipment","batch");return n>0&&s.classList.add("producing"),s.innerHTML=`
            <div class="card-comp-header">
                <span class="card-comp-title">${t.name} ìƒì‚°</span>
                <span class="card-comp-badge">T1</span>
            </div>
            <div class="image-area">
                <img src="${this.getImageUrl("prod",e)}" onerror="this.style.display='none'; this.nextElementSibling.style.display='block'" style="width:100%; height:100%; object-fit:contain;">
                <span class="image-placeholder-text" style="display:none;">${t.emoji} ${t.name} Factory<br>T${(l=m[e.slots.equipment])==null?void 0:l.tier}-W${(r=m[e.slots.worker])==null?void 0:r.tier}</span>
            </div>
            <div class="card-body">
                <div class="slots-grid">
                    ${this.renderSlotHTML(e.id,"equipment",e.slots.equipment)}
                    ${this.renderSlotHTML(e.id,"worker",e.slots.worker)}
                </div>
                
                <button class="btn btn-produce" id="btn-prod-${e.id}" style="margin-bottom: 0;">
                    <span style="font-size:18px;">${t.emoji}</span> ìƒì‚° ê°œì‹œ (+${c})
                </button>
                <div class="progress-bar-container" style="margin-top: -6px; margin-bottom: 8px;">
                    <div class="progress-bar-fill" id="prog-fill-prod-${e.id}"></div>
                </div>
                
                <div style="display:flex; flex-direction:column; gap:4px; font-size:11px; color:var(--text-muted);">
                    <div style="display:flex; justify-content:space-between;">
                        <span>Batch Size</span>
                        <span style="color:var(--text-main); font-weight:700;">${c.toLocaleString()}ê°œ</span>
                    </div>
                    <div style="display:flex; justify-content:space-between;">
                        <span>Auto Rate</span>
                        <span style="color:var(--accent-primary); font-weight:700;">${n.toFixed(1)}/s</span>
                    </div>
                </div>
            </div>
            <button class="btn-remove-line-top">&times;</button>
        `,this.bindSlotEvent(s,e.id,"equipment"),this.bindSlotEvent(s,e.id,"worker"),s.querySelector(".btn-remove-line-top").onclick=d=>{d.stopPropagation(),confirm("ì´ ìƒì‚°ë¼ì¸ì„ ì² ê±°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&(this.game.removeLine(e.id),this.renderLines())},s.querySelector(`#btn-prod-${e.id}`).onclick=d=>{const u=this.game.produce(e.id);u>0?(this.spawnParticles(d.clientX,d.clientY,"#ef4444"),this.createFloatingText(d.clientX,d.clientY,`+${u}`,"item")):u===-1&&this.createFloatingText(d.clientX,d.clientY,"ì¬ë£Œ ë¶€ì¡±","err")},s}renderLogiCard(e,i){var o,a;const s=document.createElement("div");return s.className="card logi-card animate-fade-in",s.id=`card-logi-${e.id}`,g[e.productId]?(this.game.getAMBuffs(),s.innerHTML=`
            <div class="card-comp-header">
                <span class="card-comp-title">ë¬¼ë¥˜ ìŠ¤í…Œì´ì…˜</span>
                <span class="card-comp-badge">L${i+1}</span>
            </div>
            <div class="image-area">
                <img src="${this.getImageUrl("logi",e)}" onerror="this.style.display='none'; this.nextElementSibling.style.display='block'" style="width:100%; height:100%; object-fit:contain;">
                <span class="image-placeholder-text" style="display:none;">ğŸ“¦ Logistics Hub<br>T${((o=m[e.slots.storage])==null?void 0:o.tier)||"?"}-W${((a=m[e.slots.transporter])==null?void 0:a.tier)||"?"}</span>
            </div>
            <div class="card-body">
                <div class="slots-grid">
                    ${this.renderSlotHTML(e.id,"storage",e.slots.storage)}
                    ${this.renderSlotHTML(e.id,"transporter",e.slots.transporter)}
                </div>

                <div class="tank-container">
                    <div class="tank tank-keep">
                        <div class="tank-label">ë³´ê´€ (Storage)</div>
                        <div class="tank-bar-bg"><div class="tank-bar-fill" id="fill-keep-${e.id}"></div></div>
                        <div class="tank-value" id="val-keep-${e.id}">0</div>
                        <button class="btn btn-pump btn-pump-keep" id="btn-pump-keep-${e.id}">PUMP</button>
                    </div>
                    <div class="tank tank-sell">
                        <div class="tank-label">ì¶œí•˜ (Shipping)</div>
                        <div class="tank-bar-bg"><div class="tank-bar-fill" id="fill-sell-logi-${e.id}"></div></div>
                        <div class="tank-value" id="val-sell-logi-${e.id}">0</div>
                        <button class="btn btn-pump btn-pump-sell" id="btn-pump-sell-${e.id}">PUMP</button>
                    </div>
                </div>

                <div class="priority-toggle">
                     <button class="priority-btn ${e.logisticsDir==="keep"?"active":""}" data-mode="keep" id="toggle-keep-${e.id}">STORAGE</button>
                     <button class="priority-btn ${e.logisticsDir!=="keep"?"active":""}" data-mode="sell" id="toggle-sell-${e.id}">SHIPPING</button>
                </div>
            </div>
        `,this.bindSlotEvent(s,e.id,"storage"),this.bindSlotEvent(s,e.id,"transporter"),s.querySelector(`#toggle-keep-${e.id}`).onclick=()=>{e.logisticsDir!=="keep"&&(this.game.toggleLogisticsDir(e.id),this.renderLines())},s.querySelector(`#toggle-sell-${e.id}`).onclick=()=>{e.logisticsDir!=="sell"&&(this.game.toggleLogisticsDir(e.id),this.renderLines())},s.querySelector(`#btn-pump-sell-${e.id}`).onclick=n=>{var l,r;const c=((l=this.game.productInventory[e.productId])==null?void 0:l.sell)||0;this.game.moveLogistics(e.id,"sell"),(((r=this.game.productInventory[e.productId])==null?void 0:r.sell)||0)>c&&(this.spawnParticles(n.clientX,n.clientY,"#0ea5e9"),this.update())},s.querySelector(`#btn-pump-keep-${e.id}`).onclick=n=>{this.game.moveLogistics(e.id,"keep"),this.update()},s):(s.innerHTML='<div class="card-body muted" style="text-align:center; padding:40px;">Waiting for Production...</div>',s)}renderSalesCard(e,i){var f,y;const s=document.createElement("div");if(s.className="card sales-card animate-fade-in",s.id=`card-sales-${e.id}`,!g[e.productId])return s.innerHTML='<div class="card-body muted" style="text-align:center; padding:40px;">Market Closed</div>',s;const o=this.game.getAMBuffs(),a=m[e.slots.market],n=m[e.slots.salesOrg];let c=1+(a&&a.effects.sellAmount||0),l=(n&&n.effects.sellSpeed||0)*o.sellSpeedMult;const d=this.game.getProductPrice(e.productId)*(o.priceMult||1),u=l;return s.innerHTML=`
            <div class="card-comp-header">
                <span class="card-comp-title">ê¸€ë¡œë²Œ ë§ˆì¼“</span>
                <span class="card-comp-badge">S${i+1}</span>
            </div>
            <div class="image-area">
                <img src="${this.getImageUrl("sales",e)}" onerror="this.style.display='none'; this.nextElementSibling.style.display='block'" style="width:100%; height:100%; object-fit:contain;">
                <span class="image-placeholder-text" style="display:none;">ğŸª Street Store<br>T${((f=m[e.slots.market])==null?void 0:f.tier)||"?"}-W${((y=m[e.slots.salesOrg])==null?void 0:y.tier)||"?"}</span>
            </div>
            <div class="card-body">
                <div class="slots-grid">
                    ${this.renderSlotHTML(e.id,"market",e.slots.market)}
                    ${this.renderSlotHTML(e.id,"salesOrg",e.slots.salesOrg)}
                </div>

                <div class="tank-container" style="flex:initial; margin-bottom:12px;">
                    <div class="tank tank-sell">
                        <div class="tank-label">ì¶œí•˜ (Shipping)</div>
                        <div class="tank-bar-bg"><div class="tank-bar-fill" id="fill-sell-${e.id}"></div></div>
                        <div class="tank-value" id="val-sell-${e.id}">0</div>
                    </div>
                </div>

                <div class="price-tag-lg">
                    <div style="font-size:10px; color:var(--text-muted); margin-bottom:4px;">UNIT PRICE</div>
                    <span class="price-val">${Math.floor(d).toLocaleString()}</span>
                    <span class="currency">ì›</span>
                </div>

                <div class="progress-bar-container" style="margin-bottom:8px;">
                    <div class="progress-bar-fill" id="prog-fill-sell-${e.id}"></div>
                </div>

                <div class="rate-info">${u>0?"ìë™: "+u.toFixed(1)+"/s":""}</div>
                <button class="btn btn-sell-action" id="btn-sell-${e.id}" style="margin-bottom: 0;">
                    <span style="font-size:18px;">ğŸ’°</span> ì¦‰ì‹œ íŒë§¤ (+${c})
                </button>
            </div>
        `,this.bindSlotEvent(s,e.id,"market"),this.bindSlotEvent(s,e.id,"salesOrg"),s.querySelector(`#btn-sell-${e.id}`).onclick=b=>{const k=this.game.sell(e.id);k>0?(this.spawnParticles(b.clientX,b.clientY,"#fbbf24"),this.createFloatingText(b.clientX,b.clientY,`+${Math.floor(k).toLocaleString()}ì›`,"cash"),this.update()):this.showToast("íŒë§¤í•  ì¬ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.","error")},s}renderAchievements(){const e=document.getElementById("achievement-grid"),i=document.getElementById("achievement-detail");e&&Object.values(L).forEach(s=>{const t=this.game.completedAchievements.includes(s.id),o=document.createElement("div");o.className=`ach-icon ${t?"unlocked":"locked"}`,o.textContent=t?"ğŸ†":"ğŸ”’",o.style.width="30px",o.style.height="30px",o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.background=t?"var(--accent)":"#333",o.style.color=t?"#000":"#555",o.style.borderRadius="4px",o.style.cursor="pointer",o.addEventListener("mouseenter",()=>{i.innerHTML=`<span style="color:#fff">${s.title}</span><br>${s.desc}`}),o.addEventListener("mouseleave",()=>{i.innerHTML=""}),e.appendChild(o)})}renderLogbook(){const e=document.getElementById("logbook-list");e&&(e.innerHTML="",Object.values(S).forEach(i=>{const s=i.condition(this.game),t=document.createElement("div");t.className="log-item animate-fade-in",t.style.borderLeftColor=s?"var(--accent)":"#333",t.style.opacity=s?"1":"0.5",t.style.cursor=s?"pointer":"default",s?t.innerHTML=`
                    <div class="log-title" style="color:var(--accent)">[í•´ê¸ˆ] ${i.title}</div>
                    <div class="log-content">${i.content}</div>
                `:(t.classList.add("locked"),t.innerHTML=`
                    <div class="log-title" style="color:#555">ğŸ”’ ì ê¹€: ${i.title}</div>
                `),e.appendChild(t)}))}renderAMUpgrades(){const e=document.getElementById("am-upgrade-list");e&&(e.innerHTML="",Object.values(_).forEach(i=>{const s=this.game.amUpgrades.includes(i.id),t=document.createElement("div");t.className=`card res-card am-upg-card ${s?"completed":""}`,t.style.minHeight="auto",t.style.marginBottom="8px",t.style.borderColor=s?"var(--accent)":"var(--card-border)",t.innerHTML=`
                <div class="card-title" style="color:var(--accent); font-size:14px;">${i.name}</div>
                <div class="card-desc" style="font-size:11px;">${i.desc}</div>
                <div class="card-footer" style="margin-top:8px;">
                    <span class="res-cost" style="font-size:12px;">${s?"íšë“ ì™„ë£Œ":"âš›ï¸ "+i.cost}</span>
                    ${s?"":`<button class="btn btn-xs btn-buy-am" data-id="${i.id}">íšë“</button>`}
                </div>
            `,s||t.querySelector(".btn-buy-am").addEventListener("click",()=>{this.game.buyAMUpgrade(i.id)?(this.renderAMUpgrades(),this.update()):alert("ì™¸ê³„ ë¬¼ì§ˆ(AM)ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.")}),e.appendChild(t)}))}renderFlash(e){e.classList.add("flash"),setTimeout(()=>e.classList.remove("flash"),150)}createFloatingText(e,i,s,t="#fff"){const o=document.createElement("div");o.textContent=s,o.className="floating-text",["cash","item","err"].includes(t)?o.classList.add(t):o.style.color=t,o.style.left=e+"px",o.style.top=i+"px",document.body.appendChild(o),requestAnimationFrame(()=>{o.style.transform="translateY(-50px)",o.style.opacity="0",o.style.transition="all 0.8s cubic-bezier(0.22, 1, 0.36, 1)"}),setTimeout(()=>o.remove(),800)}showToast(e,i="info"){let s=document.querySelector(".toast-container");s||(s=document.createElement("div"),s.className="toast-container",document.body.appendChild(s));const t=document.createElement("div");t.className="toast",t.dataset.type=i;let o="â„¹ï¸";i==="success"&&(o="âœ…"),i==="error"&&(o="âš ï¸"),t.innerHTML=`<span style="font-size:16px;">${o}</span> <span>${e}</span>`,s.appendChild(t),setTimeout(()=>{t.style.opacity="0",t.style.transform="translateY(-20px)",setTimeout(()=>t.remove(),300)},3e3)}showModal(e,i){const s=document.createElement("div");s.className="modal-overlay animate-fade-in",s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100vh",s.style.background="rgba(0,0,0,0.9)",s.style.zIndex="10000",s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="center";let t="";e==="START_GAME"?t=`
                <div class="modal-content" style="max-width:300px; text-align:center;">
                    <h2 style="color:var(--accent); margin-bottom:15px;">SEOUL 2033:<br>Kimchi Invasion</h2>
                    <p style="font-size:14px; line-height:1.6; color:#ccc; margin-bottom:20px;">
                        "ì—„ë§ˆ, ëƒ‰ì¥ê³ ì— ê¹€ì¹˜ê°€ ë„ˆë¬´ ë§ì•„..."<br><br>
                        ì„œìš¸ì˜ ìƒì¡´ì€ ëŠ˜ í•˜ë‚˜ì˜€ìŠµë‹ˆë‹¤.<br>
                        ë‚¨ê¸°ëŠ” ê²Œ ì•„ë‹ˆë¼, ìŒ“ëŠ” ê²ƒ.<br>
                        ì´ì œ ë‹¹ì‹ ì˜ ê¹€ì¹˜ ì œêµ­ì´ ì‹œì‘ë©ë‹ˆë‹¤.
                    </p>
                    <button class="btn btn-action" id="modal-close">íŒë§¤ ì‹œì‘</button>
                </div>
             `:e==="LOGBOOK_ENTRY"?t=`
                <div class="modal-content" style="max-width:400px; text-align:left; border: 1px solid var(--accent); padding:20px; background:#111;">
                    <h3 style="color:var(--accent); font-size:16px; margin-bottom:10px;">${i.title}</h3>
                    <p style="font-size:14px; line-height:1.6; color:#ddd; white-space:pre-wrap;">${i.content}</p>
                    <div style="text-align:right; margin-top:20px;">
                        <button class="btn btn-sm" id="modal-close">í™•ì¸</button>
                    </div>
                </div>
             `:e==="HELP"?t=`
                <div class="modal-content" style="max-width:500px; text-align:left; max-height:80vh; overflow-y:auto;">
                    <h2 style="color:var(--accent); border-bottom:1px solid #333; padding-bottom:10px;">ê²Œì„ ê°€ì´ë“œ</h2>
                    <div style="font-size:14px; line-height:1.6; color:#ddd; margin-top:10px;">
                        <p style="margin-bottom:10px;"><strong>1. ìƒì‚° (Production)</strong><br>
                        ê¹€ì¹˜ë¥¼ ìƒì‚°í•©ë‹ˆë‹¤. 'ì¥ë¹„'ì™€ 'ì‘ì—…ì'ë¥¼ ì—…ê·¸ë ˆì´ë“œí•˜ì—¬ ì†ë„ì™€ ë°°ì¹˜ í¬ê¸°ë¥¼ ëŠ˜ë¦¬ì„¸ìš”.</p>
                        
                        <p style="margin-bottom:10px;"><strong>2. ë¬¼ë¥˜ (Logistics)</strong><br>
                        ìƒì‚°ëœ ê¹€ì¹˜ëŠ” ì¼ë‹¨ 'ë³´ê´€'ë©ë‹ˆë‹¤. ë¬¼ë¥˜ ì¹´ë“œì˜ ë°¸ë¸Œë¥¼ <span style="color:#f59e0b">ğŸ“¤ ì¶œí•˜</span>ë¡œ ëŒë ¤ì•¼ íŒë§¤ ë‹¨ê³„ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.<br>
                        <em>íŒ: ë¬¼ë¥˜ íš¨ìœ¨ì´ ë‚®ìœ¼ë©´ ìƒì‚°ì´ ë©ˆì¶¥ë‹ˆë‹¤!</em></p>
                        
                        <p style="margin-bottom:10px;"><strong>3. íŒë§¤ (Sales)</strong><br>
                        ì¶œí•˜ëœ ê¹€ì¹˜ë¥¼ ì‹œì¥ì— íŒë‹ˆë‹¤. 'ë§ˆì¼€íŒ…'ê³¼ 'ì˜ì—…ì¡°ì§'ì´ íŒë§¤ ì†ë„ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.</p>
                        
                        <p style="margin-bottom:10px;"><strong>4. ì—°êµ¬ & AM</strong><br>
                        'íš¨ì†Œ'ë¥¼ ëª¨ì•„ ì—°êµ¬ë¥¼ ì§„í–‰í•˜ê³ , ì¬ì„¤ì •(Prestige)ì„ í†µí•´ 'ì™¸ê³„ ë¬¼ì§ˆ(AM)'ì„ íšë“í•˜ì—¬ ì˜êµ¬ì ì¸ ê°•í•¨ì„ ì–»ìœ¼ì„¸ìš”.</p>
                    </div>
                    <div style="text-align:right; margin-top:20px;">
                        <button class="btn btn-action" id="modal-close">ë‹«ê¸°</button>
                    </div>
                </div>
             `:e==="SETTINGS"&&(t=`
                <div class="modal-content" style="max-width:320px; text-align:center;">
                    <h3 style="color:var(--text-main); font-size:18px; margin-bottom:20px; border-bottom:1px solid var(--glass-border); padding-bottom:10px;">SETTINGS</h3>
                    
                    <div style="display:flex; flex-direction:column; gap:10px;">
                        <button class="btn" id="btn-save-manual" style="width:100%; padding:12px;">ğŸ’¾ ê²Œì„ ì €ì¥ (Save)</button>
                        <!-- <button class="btn" id="btn-lang" style="width:100%; padding:12px;">ğŸŒ Language: KO</button> -->
                        <div style="border-top:1px solid var(--glass-border); margin:10px 0;"></div>
                        <button class="btn" id="btn-hard-reset" style="width:100%; padding:12px; border-color:var(--accent); color:var(--accent);">âš ï¸ ë°ì´í„° ì´ˆê¸°í™” (Hard Reset)</button>
                    </div>

                    <div style="margin-top:20px;">
                        <button class="btn btn-sm" id="modal-close">ë‹«ê¸°</button>
                    </div>
                    
                    <div style="margin-top:20px; font-size:10px; color:var(--text-muted);">
                        Kimchi Invasion v0.68<br>
                        Powered by ClickSurvivor Universe
                    </div>
                </div>
             `),s.innerHTML=t,document.body.appendChild(s),e==="SETTINGS"&&(s.querySelector("#btn-save-manual").addEventListener("click",()=>{this.game.save(),this.showToast("âœ… ê²Œì„ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")}),s.querySelector("#btn-hard-reset").addEventListener("click",()=>{confirm(`ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³  ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)&&confirm("ì§„ì§œë¡œ ì‚­ì œí•©ë‹ˆê¹Œ? í´ë¼ìš°ë“œ ì €ì¥ì´ ì—†ë‹¤ë©´ ë³µêµ¬ê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.")&&(this.game.isResetting=!0,localStorage.removeItem("kimchi_invasion_save_v1"),localStorage.clear(),window.location.reload())})),s.querySelector("#modal-close").addEventListener("click",()=>{s.remove()})}update(){const e=this.game.cash-this.displayCash;if(Math.abs(e)<1?this.displayCash=this.game.cash:this.displayCash+=e*.15,this.els.cash.textContent=Math.floor(this.displayCash).toLocaleString()+"ì›",e>.1?this.els.cash.classList.add("gaining"):this.els.cash.classList.remove("gaining"),this.els.enzymeContainer&&(this.game.completedResearch.includes("fermentation_lab")||this.game.enzyme>0)?(this.els.enzymeContainer.style.display="flex",this.els.enzyme&&(this.els.enzyme.textContent=Math.floor(this.game.enzyme).toLocaleString())):this.els.enzymeContainer&&(this.els.enzymeContainer.style.display="none"),this.els.amContainer&&(this.game.am>0||this.game.amUpgrades.length>0)){this.els.amContainer.style.display="flex",this.els.am&&(this.els.am.textContent=Math.floor(this.game.am).toLocaleString());const t=document.getElementById("am-upgrades-container");t&&(t.style.display="block")}else this.els.amContainer&&(this.els.amContainer.style.display="none");this.els.nextLineCost&&(this.els.nextLineCost.textContent=`(ë¹„ìš©: ${this.game.getLineCost().toLocaleString()}ì›)`);const i=document.getElementById("stat-ev");i&&(i.textContent=Math.floor(this.game.getEnterpriseValue()).toLocaleString()+"ì›",document.getElementById("stat-cash-val").textContent=Math.floor(this.game.cash).toLocaleString()+"ì›",document.getElementById("stat-inv-val").textContent=Math.floor(this.game.getInventoryValue()).toLocaleString()+"ì›",document.getElementById("stat-asset-val").textContent=Math.floor(this.game.getAssetValue()).toLocaleString()+"ì›");const s=Date.now();(!this.lastLogUpdate||s-this.lastLogUpdate>5e3)&&(this.renderLogbook(),this.lastLogUpdate=s),this.game.lines.forEach(t=>{if(!t.productId)return;const o=this.game.productInventory[t.productId],a=document.getElementById(`card-logi-${t.id}`),n=document.getElementById(`prog-fill-prod-${t.id}`);n&&t.prodAccumulator!==void 0&&(n.style.width=Math.min(t.prodAccumulator*100,100)+"%");const c=document.getElementById(`prog-fill-sell-${t.id}`);if(c&&t.sellAccumulator!==void 0&&(c.style.width=Math.min(t.sellAccumulator*100,100)+"%"),a){const l=o.keep||0,r=o.sell||0,d=o.cap||100,u=document.getElementById(`val-keep-${t.id}`),f=document.getElementById(`val-sell-${t.id}`),y=document.getElementById(`val-sell-logi-${t.id}`);u&&(u.textContent=l.toLocaleString()),f&&(f.textContent=r.toLocaleString()),y&&(y.textContent=r.toLocaleString());const b=document.getElementById(`fill-keep-${t.id}`),k=document.getElementById(`fill-sell-${t.id}`),E=document.getElementById(`fill-sell-logi-${t.id}`);if(b&&(b.style.height=Math.min(l/d*100,100)+"%"),k&&(k.style.height=Math.min(r/d*100,100)+"%"),E&&(E.style.height=Math.min(r/d*100,100)+"%"),l+r>=d){const p=document.getElementById(`card-prod-${t.id}`);p&&!p.classList.contains("status-halted")&&p.classList.add("status-halted")}else{const p=document.getElementById(`card-prod-${t.id}`);p&&p.classList.remove("status-halted")}if(r>0){const p=document.getElementById(`card-sales-${t.id}`);p&&!p.classList.contains("status-rich")&&p.classList.add("status-rich")}else{const p=document.getElementById(`card-sales-${t.id}`);p&&p.classList.remove("status-rich")}}})}renderSlotHTML(e,i,s){if(s&&m[s]){const t=m[s];return`<button class="btn btn-slot equipped ${`tier-${t.tier||1}`}" data-line="${e}" data-type="${i}">${t.name}</button>`}else return`<button class="btn btn-slot empty" data-line="${e}" data-type="${i}">âœš</button>`}bindSlotEvent(e,i,s){e.querySelectorAll(".btn-slot").forEach(o=>{o.dataset.line==i&&o.dataset.type===s&&(o.onclick=a=>{a.stopPropagation(),this.showPopover(a,i,s)})})}showPopover(e,i,s){this.hidePopover();const t=document.createElement("div");t.className="popover animate-fade-in",t.id="active-popover";const a=this.game.lines.find(r=>r.id===i).slots[s];let n=`<div class="popover-title">${s} ì•„ì´í…œ ê´€ë¦¬ <button id="close-pop" style="float:right; background:none; border:none; color:#fff;">&times;</button></div>`;Object.values(m).filter(r=>r.type===s).forEach(r=>{const d=(this.game.itemInventory[r.id]||0)>0,u=a===r.id,f=this.game.cash>=r.cost,y=this.getEffectString(r);n+=`
                <div class="item-row ${u?"active":""}">
                    <div class="item-info">
                        <strong>${r.name}</strong> 
                        <span>Tier ${r.tier} - ${r.desc}</span>
                        <div style="font-size:11px; color:#10b981;">[íš¨ê³¼] ${y}</div>
                        <div style="font-size:10px; color:#aaa; margin-top:2px;">
                            ${r.cost>0?r.cost.toLocaleString()+"ì›":"ë¬´ë£Œ"} 
                            ${!d&&!f?"(ìê¸ˆ ë¶€ì¡±)":""}
                        </div>
                    </div>
                    <div class="item-actions">
                        ${u?`<button class="btn btn-xs btn-unequip" data-id="${r.id}" disabled>ì¥ì°©ì¤‘</button>`:d?`<button class="btn btn-xs btn-equip" data-id="${r.id}">ì¥ì°©</button>`:`<button class="btn btn-xs btn-buy" data-id="${r.id}" ${f?"":"disabled"}>êµ¬ë§¤</button>`}
                    </div>
                </div>
            `}),t.innerHTML=n,document.body.appendChild(t);let c=e.clientX+10,l=e.clientY+10;c+300>window.innerWidth&&(c=window.innerWidth-300),l+400>window.innerHeight&&(l=window.innerHeight-400),t.style.left=c+"px",t.style.top=l+"px",t.querySelectorAll(".btn-buy").forEach(r=>r.addEventListener("click",d=>{d.stopPropagation();const u=r.dataset.id;this.game.buyItem(u)&&(this.showPopover(e,i,s),this.update())})),t.querySelectorAll(".btn-equip").forEach(r=>r.addEventListener("click",()=>{this.game.equipItem(i,s,r.dataset.id),this.hidePopover(),this.renderLines(),this.update()})),t.querySelector("#close-pop").addEventListener("click",()=>this.hidePopover()),setTimeout(()=>{const r=d=>{t.contains(d.target)||(this.hidePopover(),window.removeEventListener("click",r))};window.addEventListener("click",r)},100)}showProductPicker(e,i){this.hidePopover();const s=document.createElement("div");s.className="popover animate-fade-in",s.id="active-popover";let t='<div class="popover-title">ìƒì‚° í’ˆëª© ì„ íƒ</div>';Object.values(g).forEach(o=>{t+=`
                <div class="item-row">
                    <div class="item-info">
                        <strong>${o.name}</strong>
                        <span>${o.desc}</span>
                    </div>
                    <button class="btn btn-xs btn-buy" data-id="${o.id}">í• ë‹¹</button>
                </div>
            `}),t+='<button class="btn btn-sm btn-close-pop">ë‹«ê¸°</button>',s.innerHTML=t,document.body.appendChild(s),s.style.left=Math.min(e.clientX,window.innerWidth-320)+"px",s.style.top=Math.min(e.clientY,window.innerHeight-350)+"px",s.querySelectorAll(".btn-buy").forEach(o=>o.addEventListener("click",()=>{this.game.assignProduct(i,o.dataset.id),this.hidePopover(),this.renderLines(),this.update()})),s.querySelector(".btn-close-pop").addEventListener("click",()=>this.hidePopover())}hidePopover(){const e=document.getElementById("active-popover");e&&e.remove()}showAutoSaveIndicator(){this.els.autoSave||(this.els.autoSave=document.createElement("div"),this.els.autoSave.id="auto-save-indicator",document.body.appendChild(this.els.autoSave)),this.els.autoSave.classList.add("saving"),setTimeout(()=>this.els.autoSave.classList.remove("saving"),1e3)}renderResearch(){const e=this.els.researchList;if(!e)return;e.innerHTML="",Object.values(I).forEach(t=>{const o=this.game.completedResearch.includes(t.id);if(!(!t.prereq||this.game.completedResearch.includes(t.prereq))&&!o)return;const n=document.createElement("div");n.className=`card res-card ${o?"completed":""}`;let c="";o||(t.cost&&(c+=`â‚©${t.cost.toLocaleString()} `),t.costItems&&(c+=Object.entries(t.costItems).map(([l,r])=>`${g[l].emoji}${r}`).join(", ")),t.costEnzyme&&(c+=`ğŸ§ª${t.costEnzyme}`)),n.innerHTML=`
                <div class="card-comp-header">
                    <span class="card-comp-title">${t.name}</span>
                    <span class="card-comp-badge">${o?"COMPLETED":"RESEARCH"}</span>
                </div>
                <div class="card-body">
                    <p style="font-size:12px; color:var(--text-muted); margin-bottom:10px;">${t.desc}</p>
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <span style="font-size:11px; color:var(--accent-primary);">${o?"ê¸°ìˆ  í™•ë³´ ì™„ë£Œ":c}</span>
                        ${o?"":`<button class="btn btn-sm btn-research-buy" data-id="${t.id}">ì—°êµ¬ê°œì‹œ</button>`}
                    </div>
                </div>
            `,o||(n.querySelector(".btn-research-buy").onclick=()=>{this.game.buyResearch(t.id)?(this.renderResearch(),this.renderLines(),this.update()):this.showToast("ìì›ì´ë‚˜ ì„ í–‰ ì—°êµ¬ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.","error")}),e.appendChild(n)});const i=document.createElement("h3");i.className="section-title",i.textContent="Extra-Terrestrial Lab",i.id="am-upgrades-container",i.style.display=this.game.am>0||this.game.amUpgrades.length>0?"block":"none",e.appendChild(i);const s=document.createElement("div");s.id="am-upgrade-list",e.appendChild(s),this.renderAMUpgrades()}renderStats(){const e=this.els.statsList;e&&(e.innerHTML=`
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-label">ê¸°ì—…ê°€ì¹˜</span>
                    <span class="stat-val" id="stat-ev">0ì›</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">ë³´ìœ í˜„ê¸ˆ</span>
                    <span class="stat-val" id="stat-cash-val">0ì›</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">ì¬ê³ ê°€ì¹˜</span>
                    <span class="stat-val" id="stat-inv-val">0ì›</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">ì„¤ë¹„ìì‚°</span>
                    <span class="stat-val" id="stat-asset-val">0ì›</span>
                </div>
            </div>
            
            <h3 class="section-title">Achievements</h3>
            <div class="achievement-grid" id="achievement-grid" style="display:flex; flex-wrap:wrap; gap:5px; margin-bottom:10px;"></div>
            <div id="achievement-detail" style="font-size:11px; color:var(--text-muted); margin-bottom:20px; min-height:30px;"></div>
            
            <h3 class="section-title">Logbook</h3>
            <div id="logbook-list" class="logbook-list"></div>
        `,this.renderAchievements(),this.renderLogbook())}getEffectString(e){if(!e||!e.effects)return"No Effect";const i=[];return e.effects.prodSpeed&&i.push(`ìƒì‚°ì†ë„ +${e.effects.prodSpeed}`),e.effects.batch&&i.push(`ë°°ì¹˜ëŸ‰ +${e.effects.batch}`),e.effects.moveSpeed&&i.push(`ë¬¼ë¥˜ì†ë„ +${e.effects.moveSpeed}`),e.effects.moveBatch&&i.push(`ì´ì†¡ëŸ‰ +${e.effects.moveBatch}`),e.effects.sellSpeed&&i.push(`íŒë§¤ì†ë„ +${e.effects.sellSpeed}`),e.effects.sellAmount&&i.push(`íŒë§¤ëŸ‰ +${e.effects.sellAmount}`),i.length>0?i.join(", "):"íŠ¹ìˆ˜ íš¨ê³¼"}spawnParticles(e,i,s){for(let t=0;t<8;t++){const o=document.createElement("div");o.className="particle",o.style.backgroundColor=s,o.style.left=e+"px",o.style.top=i+"px";const a=(Math.random()-.5)*100,n=(Math.random()-.5)*100;o.style.setProperty("--tx",`${a}px`),o.style.setProperty("--ty",`${n}px`),document.body.appendChild(o),setTimeout(()=>o.remove(),800)}}animateConveyor(e,i,s){const t=document.getElementById(`conveyor-${s}-${e}`);if(!t)return;const o=t.querySelector(".conveyor-track");if(!o)return;const a=document.createElement("div");a.className="conveyor-item",a.textContent=i,o.appendChild(a),setTimeout(()=>a.remove(),2e3)}}window.addEventListener("DOMContentLoaded",()=>{const h=new w,e=new M(h);window.game=h,window.ui=e,e.init();let i=performance.now();function s(t){const o=(t-i)/1e3;if(i=t,h.tick(o),e.update(),h.hasAutomatedChanges){const a=Date.now();(!h.lastSaveTime||a-h.lastSaveTime>1e3)&&(h.save(),h.lastSaveTime=a,h.hasAutomatedChanges=!1)}requestAnimationFrame(s)}requestAnimationFrame(s)});
