import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css               */const b={kimchi_1:{id:"kimchi_1",name:"ë°°ì¶”ê¹€ì¹˜",emoji:"ğŸ¥¬",price:5e3,desc:"ì—„ë§ˆì˜ ì†ë§›ì´ ë‹´ê¸´ ê¸°ë³¸ ê¹€ì¹˜"},kimchi_2:{id:"kimchi_2",name:"ê¹ë‘ê¸°",emoji:"ğŸ§Š",price:8e3,recipe:{kimchi_1:2},desc:"ì•„ì‚­ì•„ì‚­í•œ ì‹ê°ì˜ ë¬´ê¹€ì¹˜"},kimchi_3:{id:"kimchi_3",name:"ì´ê°ê¹€ì¹˜",emoji:"ğŸ¥•",price:15e3,recipe:{kimchi_1:5},desc:"ì•Œì‹¸í•œ ë§›ì˜ ë¬´ì²­ ê¹€ì¹˜"},kimchi_4:{id:"kimchi_4",name:"ë¬µì€ì§€",emoji:"ğŸº",price:25e3,recipe:{kimchi_1:3,kimchi_2:3},desc:"ê¹Šì€ ë§›ì´ ìš°ëŸ¬ë‚˜ëŠ” ìˆ™ì„± ê¹€ì¹˜"},kimchi_5:{id:"kimchi_5",name:"100ë…„ ìˆ™ì„±",emoji:"ğŸ’",price:5e4,recipe:{kimchi_1:5,kimchi_2:5,kimchi_3:2,kimchi_4:1},desc:"ë°•ë¬¼ê´€ì— ê°€ì•¼ í•  ê²ƒ ê°™ì€ ì „ì„¤ì˜ ê¹€ì¹˜"},enzyme_vial:{id:"enzyme_vial",name:"íš¨ì†Œ ì•°í”Œ",emoji:"ğŸ§ª",price:0,recipe:{kimchi_1:50},desc:"ì—°êµ¬ì— ì“°ì´ëŠ” ê³ ë†ì¶• ìœ ì‚°ê·  íš¨ì†Œ"},kimchi_sauce:{id:"kimchi_sauce",name:"ë§ŒëŠ¥ ê¹€ì¹˜ì†ŒìŠ¤",emoji:"ğŸ¥£",price:25e3,recipe:{kimchi_1:3,enzyme_vial:1},desc:"ì–´ë–¤ ìŒì‹ë„ ì„œìš¸ì˜ ë§›ìœ¼ë¡œ ë°”ê¾¸ëŠ” ë§ˆë²•ì˜ ì†ŒìŠ¤"},kimchi_fried_rice:{id:"kimchi_fried_rice",name:"ê¹€ì¹˜ë³¶ìŒë°¥",emoji:"ğŸ³",price:45e3,recipe:{kimchi_sauce:1,kimchi_2:1},desc:"ê°€ì¥ ëŒ€ì¤‘ì ì´ì§€ë§Œ ê°€ì¥ ì•ˆì •ì ì¸ ìˆ˜ìµì›"},kimchi_tangsuyuk:{id:"kimchi_tangsuyuk",name:"ê¹€ì¹˜ íƒ•ìˆ˜ìœ¡",emoji:"ğŸ–",price:12e4,recipe:{kimchi_sauce:2,kimchi_3:1},desc:"ê³ ê¸°ì™€ í•œ ëª¸ì´ ëœ ê¹€ì¹˜. í“¨ì „ ë¬¸ëª…ì˜ ì •ì ."},kimchi_pasta:{id:"kimchi_pasta",name:"ê¹€ì¹˜ íŒŒìŠ¤íƒ€",emoji:"ğŸ",price:25e4,recipe:{kimchi_sauce:2,kimchi_tangsuyuk:1},desc:"ë™ì„œì–‘ì˜ ëŒ€í™”í•©. ì´íƒˆë¦¬ì•„ë„ ì¸ì •í–ˆë‹¤."},kimchi_dining:{id:"kimchi_dining",name:"ê¹€ì¹˜ íŒŒì¸ë‹¤ì´ë‹",emoji:"ğŸ½ï¸",price:1e6,recipe:{kimchi_sauce:5,kimchi_fried_rice:2,kimchi_tangsuyuk:1,kimchi_pasta:1,kimchi_1:10},desc:"ì½”ìŠ¤ ìš”ë¦¬ì˜ ì‹œì‘ë¶€í„° ëê¹Œì§€ ê¹€ì¹˜ë‹¤."}},E={line_base_cost:1e5,line_cost_growth:2,refund_rate:.8},n={eq_mom_fridge:{id:"eq_mom_fridge",act:1,type:"equipment",name:"ìš°ë¦¬ì§‘ ì£¼ë°©",tier:1,cost:0,effects:{batch:1},desc:"ë¹Œë¼ì˜ ì¢ì€ ì£¼ë°©. ê¹€ì¹˜ë¥¼ ê²¨ìš° ë‹´ê·¸ëŠ” ì‹œì‘ì ."},eq_dimchae:{id:"eq_dimchae",act:1,type:"equipment",name:"ê³µìœ  ì£¼ë°©",tier:2,cost:5e4,effects:{batch:5},desc:"ì‹œê°„ì œë¡œ ë¹Œë¦¬ëŠ” ë„“ì€ ì£¼ë°©. ì‘ì—… íš¨ìœ¨ì´ ì˜¬ë¼ê°„ë‹¤."},eq_community_work:{id:"eq_community_work",act:1,type:"equipment",name:"ì†Œê·œëª¨ ì‹í’ˆê³µì¥",tier:3,cost:2e5,effects:{batch:15},desc:"ì •ì‹ ì‹í’ˆ ì œì¡° í—ˆê°€ë¥¼ ë°›ì€ ì‘ì€ ê³µì¥."},eq_small_workshop:{id:"eq_small_workshop",act:1,type:"equipment",name:"í˜„ëŒ€ì‹ ì„¼íŠ¸ëŸ´ í‚¤ì¹œ",tier:4,cost:8e5,effects:{batch:40},desc:"ìµœì‹  ì¥ë¹„ë¡œ ë¬´ì¥í•œ ì „ë¬¸ ìš”ë¦¬ ê±°ì ."},eq_haccp_factory:{id:"eq_haccp_factory",act:1,type:"equipment",name:"ê¸€ë¡œë²Œ HACCP ê³µì¥",tier:5,cost:25e5,effects:{batch:100},desc:"ì² ì €í•œ ìœ„ìƒ ê´€ë¦¬ì™€ ìë™í™” ë¼ì¸ì˜ ì •ì ."},wk_me:{id:"wk_me",act:1,type:"worker",name:"ë‚˜ í˜¼ì",tier:1,cost:0,effects:{prodSpeed:0},desc:"ë°°ì¶” ì ˆì´ê¸°ë¶€í„° í¬ì¥ê¹Œì§€ ì „ë¶€ í˜¼ì í•œë‹¤."},wk_mom:{id:"wk_mom",act:1,type:"worker",name:"ê°€ì¡±ì˜ ë„ì›€",tier:2,cost:3e4,effects:{prodSpeed:1},desc:"ì—„ë§ˆì˜ ë¹„ë²•ê³¼ ê°€ì¡±ì˜ ì†ê¸¸ì´ ë”í•´ì§„ë‹¤."},wk_alba:{id:"wk_alba",act:1,type:"worker",name:"ì—´ì •ì ì¸ ì•Œë°”ìƒë“¤",tier:3,cost:15e4,effects:{prodSpeed:3},desc:"íŒ¨ê¸° ë„˜ì¹˜ëŠ” ì•Œë°”ìƒë“¤ì´ í™œê¸°ë¥¼ ë¶ˆì–´ë„£ëŠ”ë‹¤."},wk_team:{id:"wk_team",act:1,type:"worker",name:"ì˜ë¦¬ì˜ ìƒì‚°íŒ€",tier:4,cost:5e5,effects:{prodSpeed:8},desc:"ëˆˆë¹›ë§Œ ë´ë„ í†µí•˜ëŠ” ë² í…Œë‘ ìƒì‚° ì •ì˜ˆë°˜."},wk_shift:{id:"wk_shift",act:1,type:"worker",name:"24ì‹œê°„ ë² í…Œë‘ êµëŒ€ì¡°",tier:5,cost:2e6,effects:{prodSpeed:20},desc:"ìˆ™ë ¨ëœ ì¸ë ¥ë“¤ì´ 3êµëŒ€ë¡œ ëŠì„ì—†ì´ ìƒì‚°í•œë‹¤."},lg_box:{id:"lg_box",act:1,type:"storage",name:"ìš°ë¦¬ì§‘ ê±°ì‹¤",tier:1,cost:0,effects:{moveBatch:1},desc:"í¬ì¥ëœ ê¹€ì¹˜ê°€ ìŒ“ì—¬ê°€ëŠ” ì¢ì€ ê±°ì‹¤."},lg_pallet:{id:"lg_pallet",act:1,type:"storage",name:"í—ˆë¦„í•œ ëƒ‰ì¥ì°½ê³ ",tier:2,cost:2e4,effects:{moveBatch:5},desc:"ì‹ ì„ ë„ ìœ ì§€ê°€ ê°€ëŠ¥í•œ ì‘ì€ ì €ì¥ ì°½ê³ ."},lg_cont_small:{id:"lg_cont_small",act:1,type:"storage",name:"ì™¸ê³½ ì„ëŒ€ ì»¨í…Œì´ë„ˆ",tier:3,cost:1e5,effects:{moveBatch:15},desc:"ë³¸ê²©ì ì¸ ë¬¼ë¥˜ ì´ë™ì„ ìœ„í•œ ê·œê²©í™” ê³µê°„."},lg_warehouse:{id:"lg_warehouse",act:1,type:"storage",name:"ëŒ€í˜• ë¬¼ë¥˜ ì°½ê³ ",tier:4,cost:5e5,effects:{moveBatch:40},desc:"ì²´ê³„ì ì¸ ì„ ì…ì„ ì¶œì´ ì´ë£¨ì–´ì§€ëŠ” ëŒ€í˜• ê¸°ì§€."},lg_center_hub:{id:"lg_center_hub",act:1,type:"storage",name:"ìµœì²¨ë‹¨ ìŠ¤ë§ˆíŠ¸ í—ˆë¸Œ",tier:5,cost:2e6,effects:{moveBatch:100},desc:"ëª¨ë“  ë°ì´í„°ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ê´€ë¦¬ë˜ëŠ” ë¬¼ë¥˜ ê±°ì ."},tr_hand:{id:"tr_hand",act:1,type:"transporter",name:"ë‚˜ í˜¼ì",tier:1,cost:0,effects:{moveSpeed:0},desc:"ì§ì ‘ ìƒìë¥¼ ë“¤ê³  ê³„ë‹¨ì„ ì˜¤ë¥´ë‚´ë¦°ë‹¤."},tr_cart:{id:"tr_cart",act:1,type:"transporter",name:"ìš°ì²´êµ­ ì§‘ë°°ì›",tier:2,cost:3e4,effects:{moveSpeed:1},desc:"ë“ ë“ í•œ ìš°ì²´êµ­ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ ì•ˆì •ì ìœ¼ë¡œ ë°°ì†¡í•œë‹¤."},tr_truck:{id:"tr_truck",act:1,type:"transporter",name:"ë‹¹ì¼ë°°ì†¡ íƒë°°",tier:3,cost:15e4,effects:{moveSpeed:3},desc:"ì „êµ­ ì–´ë””ë“  í•˜ë£¨ ë§Œì— ë„ë‹¬í•˜ëŠ” íƒë°° ì‹œìŠ¤í…œ."},tr_fleet:{id:"tr_fleet",act:1,type:"transporter",name:"ì§ì˜ ë°°ì†¡ ë„¤íŠ¸ì›Œí¬",tier:4,cost:5e5,effects:{moveSpeed:8},desc:"ìš°ë¦¬ ë¸Œëœë“œë§Œì˜ ì „ìš© ì°¨ëŸ‰ê³¼ ë°°ì†¡ ì¸ë ¥íŒ€."},tr_auto_sys:{id:"tr_auto_sys",act:1,type:"transporter",name:"AI ìë™í™” ë¡œë´‡",tier:5,cost:2e6,effects:{moveSpeed:20},desc:"ë¬´ì¸ ììœ¨ ì£¼í–‰ ë¡œë´‡ì´ ìµœì ì˜ ê²½ë¡œë¡œ ìš´ì†¡í•œë‹¤."},mk_neighborhood:{id:"mk_neighborhood",act:1,type:"market",name:"ì§‘ ê·¼ì²˜ ì§ê±°ë˜",tier:1,cost:0,effects:{sellAmount:1},desc:"ì´ì›ƒ ì‚¬ëŒë“¤ì—ê²Œ ì§ì ‘ ë§Œë‚˜ì„œ íŒë§¤í•œë‹¤."},mk_supermarket:{id:"mk_supermarket",act:1,type:"market",name:"ë™ë„¤ ìŠˆí¼ ë§¤ëŒ€",tier:2,cost:5e4,effects:{sellAmount:5},desc:"ìŠˆí¼ë§ˆì¼“ ì…êµ¬ ì¢‹ì€ ìë¦¬ë¥¼ ì°¨ì§€í–ˆë‹¤."},mk_online:{id:"mk_online",act:1,type:"market",name:"ì˜¨ë¼ì¸ ìŠ¤í† ì–´ ì…ì ",tier:3,cost:2e5,effects:{sellAmount:15},desc:"ì „ êµ­ë¯¼ì„ ìƒëŒ€ë¡œ í•œ 24ì‹œê°„ ì˜¤í”ˆ ë§¤ì¥."},mk_franchise:{id:"mk_franchise",act:1,type:"market",name:"ë¼ì´ë¸Œì»¤ë¨¸ìŠ¤ ì§„ì¶œ",tier:4,cost:8e5,effects:{sellAmount:40},desc:"ë°©ì†¡ ì¦‰ì‹œ ì£¼ë¬¸ì´ ìŸì•„ì§€ëŠ” ì‹¤ì‹œê°„ íŒë§¤ ì±„ë„."},mk_enterprise:{id:"mk_enterprise",act:1,type:"market",name:"ê°•ë‚¨ ê¸€ë¡œë²Œ ì‚¬ì˜¥",tier:5,cost:25e5,effects:{sellAmount:100},desc:"ê¸°ì—… ê°„ ëŒ€ê·œëª¨ ê³„ì•½ì´ ì„±ì‚¬ë˜ëŠ” ëŸ­ì…”ë¦¬ ì‚¬ë¬´ì‹¤."},so_solo:{id:"so_solo",act:1,type:"salesOrg",name:"ë‚˜ í˜¼ì",tier:1,cost:0,effects:{sellSpeed:0},desc:"ì „ë‹¨ì§€ë¥¼ ëŒë¦¬ë©° ì§ì ‘ êµ¬ë§¤ìë¥¼ ì°¾ì•„ë‹¤ë‹Œë‹¤."},so_alba:{id:"so_alba",act:1,type:"salesOrg",name:"ì¹œì ˆí•œ ì‹œì‹ íŒë§¤ì›",tier:2,cost:3e4,effects:{sellSpeed:1},desc:"ë§›ì„ ë³¸ ì‚¬ëŒë“¤ì´ ì§€ê°‘ì„ ì—´ê²Œ ë§Œë“œëŠ” íŒë§¤ ì¥ì¸."},so_contract:{id:"so_contract",act:1,type:"salesOrg",name:"ê³„ì•½ì§ ì˜ì—…ì‚¬ì›",tier:3,cost:15e4,effects:{sellSpeed:3},desc:"ì‹¤ì  ê¸°ë°˜ìœ¼ë¡œ ê¹€ì¹˜ë¥¼ ì „êµ­ì— ì•Œë¦¬ëŠ” ì „ë¬¸ê°€."},so_team:{id:"so_team",act:1,type:"salesOrg",name:"ì†Œìˆ˜ì •ì˜ˆ ì˜ì—…íŒ€",tier:4,cost:5e5,effects:{sellSpeed:8},desc:"ê¸°ì—… í™ë³´ì™€ ë§ˆì¼€íŒ… ì „ëµì„ ì‹¤í–‰í•˜ëŠ” ì •ì˜ˆ ë©¤ë²„."},so_hq:{id:"so_hq",act:1,type:"salesOrg",name:"ê¸€ë¡œë²Œ ì˜ì—…ë³¸ë¶€",tier:5,cost:2e6,effects:{sellSpeed:20},desc:"ì „ ì„¸ê³„ ìœ í†µë§ì„ ê´€ë¦¬í•˜ëŠ” ê±°ëŒ€ íŒë§¤ ì¡°ì§."}},M={unlock_kkakdugi:{id:"unlock_kkakdugi",name:"ê¹ë‘ê¸° ë ˆì‹œí”¼ ì—°êµ¬",cost:1e5,costItems:{kimchi_1:50},type:"unlock",productId:"kimchi_2",desc:"ë¬´ë¥¼ ì°ì–´ ë§µê²Œ ë²„ë¬´ë¦¬ëŠ” ë²•ì„ ë°°ìš´ë‹¤."},unlock_chonggak:{id:"unlock_chonggak",name:"ì´ê°ê¹€ì¹˜ ë ˆì‹œí”¼ ì—°êµ¬",cost:5e5,costItems:{kimchi_2:100},prereq:"unlock_kkakdugi",type:"unlock",productId:"kimchi_3",desc:"ì‘ì€ ë¬´ì˜ ì•„ì‚­í•¨ì„ ì‚´ë¦¬ëŠ” ë¹„ë²•."},unlock_muegenji:{id:"unlock_muegenji",name:"ë¬µì€ì§€ ìˆ™ì„±ë²•",cost:1e6,costItems:{kimchi_3:100},prereq:"unlock_chonggak",type:"unlock",productId:"kimchi_4",desc:"ê¹Šì€ ë§›ì„ ë‚´ëŠ” ì¥ê¸° ìˆ™ì„± ê¸°ìˆ ."},unlock_100y:{id:"unlock_100y",name:"100ë…„ ìˆ™ì„± ë¹„ê¸°",cost:5e6,costItems:{kimchi_4:200},prereq:"unlock_muegenji",type:"unlock",productId:"kimchi_5",desc:"ê°€ë¬¸ì˜ ë¹„ë²•ì„ ë³µì›í•œë‹¤."},fermentation_lab:{id:"fermentation_lab",name:"ë°œíš¨ ì‹¤í—˜ì‹¤ êµ¬ì¶•",cost:1e6,costItems:{kimchi_1:500},prereq:"unlock_kkakdugi",type:"unlock",productId:"enzyme_vial",desc:"ê¹€ì¹˜ì—ì„œ íš¨ì†Œë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆê²Œ ëœë‹¤."},global_efficiency:{id:"global_efficiency",name:"ìœ ì‚°ê·  ê°•í™” ì—°êµ¬",cost:2e6,costEnzyme:50,prereq:"fermentation_lab",type:"buff",effects:{priceMult:1.2},desc:"ëª¨ë“  ê¹€ì¹˜ì˜ íŒë§¤ ê°€ê²©ì´ 20% ìƒìŠ¹í•œë‹¤."},unlock_sauce:{id:"unlock_sauce",name:"ë§ŒëŠ¥ ì†ŒìŠ¤ ê°œë°œ",cost:15e5,costEnzyme:30,prereq:"fermentation_lab",type:"unlock",productId:"kimchi_sauce",desc:"ëª¨ë“  ìš”ë¦¬ì˜ ë² ì´ìŠ¤ê°€ ë  ì†ŒìŠ¤ë¥¼ ê°œë°œí•œë‹¤."},unlock_rice:{id:"unlock_rice",name:"K-ë³¶ìŒë°¥ ë ˆì‹œí”¼",cost:25e5,costEnzyme:60,prereq:"unlock_sauce",type:"unlock",productId:"kimchi_fried_rice",desc:"ê¹€ì¹˜ì†ŒìŠ¤ì™€ ë°¥ì˜ ì™„ë²½í•œ ì¡°í™”."},unlock_fusion:{id:"unlock_fusion",name:"í“¨ì „ ì¤‘ì‹ ì—°êµ¬",cost:5e6,costEnzyme:100,prereq:"unlock_rice",type:"unlock",productId:"kimchi_tangsuyuk",desc:"ê¹€ì¹˜ì™€ íŠ€ê¸´ ê³ ê¸°ì˜ ë¬´ì‹œë¬´ì‹œí•œ ê²°í•©."},unlock_pasta:{id:"unlock_pasta",name:"ê¹€ì¹˜ íŒŒìŠ¤íƒ€ ì—°êµ¬",cost:1e7,costEnzyme:200,type:"unlock",productId:"kimchi_pasta",desc:"ì´íƒˆë¦¬ì•„ì˜ ë©´ê³¼ ì„œìš¸ì˜ ì†ŒìŠ¤ê°€ ë§Œë‚¬ë‹¤."},unlock_dining:{id:"unlock_dining",name:"íŒŒì¸ë‹¤ì´ë‹ ëŸ°ì¹­",cost:5e7,costEnzyme:500,type:"unlock",productId:"kimchi_dining",desc:"ê¹€ì¹˜ë¥¼ ì˜ˆìˆ ì˜ ê²½ì§€ë¡œ ëŒì–´ì˜¬ë¦°ë‹¤."},star_kimchi_ship:{id:"star_kimchi_ship",name:"ìŠ¤íƒ€ê¹€ì¹˜ì‹­ í”„ë¡œì íŠ¸",cost:1e8,costEnzyme:1e3,costItems:{kimchi_dining:10},type:"prestige",desc:"ì„œìš¸íƒ€ì›Œë¥¼ ë°œì‚¬ëŒ€ë¡œ ê°œì¡°í•˜ì—¬ ìš°ì£¼ë¡œ ê¹€ì¹˜ë¥¼ ì‹¤ì–´ ë‚˜ë¥¸ë‹¤. (ë°œì‚¬ ì‹œ ê²Œì„ ì´ˆê¸°í™” ë° AM íšë“)"}},I={am_prod_speed:{id:"am_prod_speed",name:"A1. ë” ë¹ ë¥¸ ì†",cost:1,desc:"ëª¨ë“  ìƒì‚° ë¼ì¸ ìƒì‚°ì†ë„ +25%",effects:{prodSpeedMult:1.25}},am_cost_reduce:{id:"am_cost_reduce",name:"A2. ì›ê°€ ì ˆê°",cost:1,desc:"ë ˆì‹œí”¼ ì…ë ¥ ì†Œëª¨ëŸ‰ -10%",effects:{costReduce:.1}},am_warehouse:{id:"am_warehouse",name:"B1. ë” í° ì°½ê³ ",cost:1,desc:"Keep ìˆ˜ìš©ëŸ‰(Cap) +50%",effects:{capMult:1.5}},am_auto_logi:{id:"am_auto_logi",name:"B2. ë¶„ë¥˜ ìë™í™”",cost:1,desc:"ë¬¼ë¥˜ ì†ë„ +40% (ë¶„ë¥˜ ìµœì í™”)",effects:{moveSpeedMult:1.4}},am_sales_org:{id:"am_sales_org",name:"C1. íŒë§¤ ì¡°ì§",cost:1,desc:"íŒë§¤ ì²˜ë¦¬ ì†ë„ +40%",effects:{sellSpeedMult:1.4}},am_premium:{id:"am_premium",name:"C2. ë¸Œëœë“œ í”„ë¦¬ë¯¸ì—„",cost:1,desc:"íŒë§¤ ë‹¨ê°€ +10%",effects:{priceMult:1.1}},am_res_eff:{id:"am_res_eff",name:"D1. ì—°êµ¬ íš¨ìœ¨",cost:1,desc:"ì—°êµ¬ íš¨ì†Œ ìš”êµ¬ëŸ‰ -20%",effects:{researchEnzymeReduce:.2}},am_res_cost:{id:"am_res_cost",name:"D2. ì—°êµ¬ë¹„ ì ˆê°",cost:1,desc:"ì—°êµ¬ í˜„ê¸ˆ ë¹„ìš© -15%",effects:{researchCashReduce:.15}},am_start_cash:{id:"am_start_cash",name:"E1. ì‹œì‘ ìë³¸",cost:1,desc:"í”„ë ˆìŠ¤í‹°ì§€ í›„ ì‹œì‘ í˜„ê¸ˆ +50%",effects:{startCashMult:1.5}},am_start_buff:{id:"am_start_buff",name:"E2. ì´ˆë°˜ ê°€ì†",cost:1,desc:"ì‹œì‘ í›„ 5ë¶„ê°„ ìƒì‚°ì†ë„ +25%",effects:{startBuffDuration:3e5,startBuffVal:1.25}}},x={a01:{id:"a01",title:"ì—„ë§ˆì˜ ëƒ‰ì¥ê³ ",desc:"ê²Œì„ ì‹œì‘ (ì²« ìƒì‚° 1íšŒ)",rewardLog:"l01"},a02:{id:"a02",title:"ì²« íŒë§¤",desc:"ë°°ì¶”ê¹€ì¹˜ 10ê°œ íŒë§¤",rewardBanner:"ì¥ì‚¬ ì‹œì‘"},a03:{id:"a03",title:"ë¶€ë…€íšŒ ê°€ì…",desc:"ê¹€ì¹˜ ëƒ‰ì¥ê³ (ì„¤ë¹„ T2) êµ¬ë§¤",rewardLog:"l02"},a04:{id:"a04",title:"ì¢ŒíŒ ê°œì‹œ",desc:"ë™ë„¤ ì‹œì¥(ì‹œì¥ T2) í•´ê¸ˆ",rewardLog:"l03"},a05:{id:"a05",title:"ë¬¼ë¥˜ì˜ ì‹œì‘",desc:"ë¬¼ë¥˜ ì¸ë ¥ 1ëª… ê³ ìš©",rewardLog:"l04"},a06:{id:"a06",title:"ìë™íŒë§¤ì˜ ì‹œì‘",desc:"íŒë§¤ ì•Œë°”(ì¡°ì§ T2) ê³ ìš©",rewardCheck:"íŒë§¤ ìë™í™”"},a07:{id:"a07",title:"ë°œíš¨ì‹¤í—˜ì‹¤ 1í˜¸",desc:"ë°œíš¨ì‹¤í—˜ì‹¤ í•´ê¸ˆ (íš¨ì†Œ ì˜¤í”ˆ)",rewardLog:"l05"},a08:{id:"a08",title:"ì†ŒìŠ¤ëŠ” ë² ì´ìŠ¤ë‹¤",desc:"ê¹€ì¹˜ì†ŒìŠ¤ í•´ê¸ˆ",rewardLog:"l06"},a09:{id:"a09",title:"ì²« í“¨ì „",desc:"ê¹€ì¹˜ íƒ•ìˆ˜ìœ¡ í•´ê¸ˆ",rewardCheck:"í“¨ì „ ì¹´ìš´íŠ¸"},a10:{id:"a10",title:"íŒŒì¸ë‹¤ì´ë‹ ì˜¤í”ˆ",desc:"ê¹€ì¹˜ íŒŒì¸ë‹¤ì´ë‹ í•´ê¸ˆ",rewardCheck:"ë°œì‚¬ ì¤€ë¹„"},a11:{id:"a11",title:"ë¯¸ë˜ ì¬ë£Œ 1í˜¸",desc:"ì‹ ì†Œì¬ í•´ê¸ˆ (Act3 í”„ë¦¬ë·°)",rewardLog:"l07"},a12:{id:"a12",title:"í´ë¦°ë£¸ ì…ì„±",desc:"ë°˜ë„ì²´ SoC í•´ê¸ˆ (Act3)",rewardCheck:"ë¯¸ë˜ì‚°ì—… ìƒì‚°"},a13:{id:"a13",title:"ì—°ì‚°ì˜ ì‹œëŒ€",desc:"GPU í•´ê¸ˆ (Act3)",rewardBanner:"ë°œì‚¬ ë ˆì‹œí”¼"},a14:{id:"a14",title:"íƒ€ì›Œì˜ ë¬¸ì„œ",desc:"ë°œì‚¬ëŒ€ ì—°êµ¬(ì‚¬ì‹¤ìƒ ìŠ¤íƒ€ê¹€ì¹˜ì‹­)",rewardLog:"l08"},a15:{id:"a15",title:"ìµœì¢… ì¡°ë¦½ ë§¤ë‰´ì–¼",desc:"ìŠ¤íƒ€ê¹€ì¹˜ì‹­ ì œì‘ ê°€ëŠ¥",rewardLog:"l09"},a16:{id:"a16",title:"ì²« ë°œì‚¬",desc:"ìŠ¤íƒ€ê¹€ì¹˜ì‹­ ë°œì‚¬ 1íšŒ",rewardLog:"l10",rewardAM:1},a17:{id:"a17",title:"ë‘ ë²ˆì§¸ ë°œì‚¬",desc:"ë°œì‚¬ 2íšŒ ë‹¬ì„±",rewardLog:"l11"},a18:{id:"a18",title:"ë‹¤ì„¯ ë²ˆì§¸ ë°œì‚¬",desc:"ë°œì‚¬ 5íšŒ ë‹¬ì„±",rewardLog:"l12"},a19:{id:"a19",title:"ê³µì • ìµœì í™”",desc:"ì¡°ê±´ë¶€ ë¶„ë¥˜ í™œì„±í™” + ëª¨ë“ˆ ì œì‘",rewardMedal:"ë¬¼ë¥˜ ì¥ì¸"},a20:{id:"a20",title:"ê·¼ë³¸ì€ ë°°ì¶”ê¹€ì¹˜",desc:"ë°œì‚¬ ì§ì „ ë°°ì¶”ê¹€ì¹˜ ìƒì‚° ìœ ì§€",rewardMedal:"ê·¼ë³¸"}},$={l01:{id:"l01",title:"ì—„ë§ˆì˜ ëƒ‰ì¥ê³ ",content:'ì„œìš¸ì˜ ìƒì¡´ì€ ëŠ˜ í•˜ë‚˜ì˜€ë‹¤. ë‚¨ê¸°ëŠ” ê²Œ ì•„ë‹ˆë¼, ìŒ“ëŠ” ê²ƒ. ê±°ì°½í•œ ê³„íšì€ ì—†ë‹¤. "ì—„ë§ˆê¹€ì¹˜... íŒ”ì•„ë³¼ê¹Œ?"',condition:()=>!0},l02:{id:"l02",title:"ë¶€ë…€íšŒ ê³µë™êµ¬ë§¤ ì „ë‹¨ì§€",content:"ê¹€ì¹˜ê°€ ì§„ì§œë¡œ íŒ”ë¦¬ê¸° ì‹œì‘í–ˆë‹¤. ë¶€ë…€íšŒì—ì„œ ì¥ë¹„ë¥¼ ê°™ì´ ì‚¬ìê³  í•œë‹¤. ì´ê±´ ì¥ì‚¬ê°€ ë  ê²ƒ ê°™ë‹¤.",condition:m=>m.hasAchievement("a03")},l03:{id:"l03",title:"ì‹œì¥ ì¢ŒíŒì˜ ê·œì¹™",content:'ì§‘ ì•ì—ì„œ íŒ”ë˜ ê¹€ì¹˜ê°€ ì‹œì¥ìœ¼ë¡œ ë“¤ì–´ì™”ë‹¤. ì´ì œëŠ” "ë§Œë“œëŠ” ì†ë„"ë³´ë‹¤ "íŒŒëŠ” êµ¬ì¡°"ê°€ ì¤‘ìš”í•´ì§„ë‹¤.',condition:m=>m.hasAchievement("a04")},l04:{id:"l04",title:"ë‚©í’ˆì€ ê¹€ì¹˜ê°€ ì•„ë‹ˆë¼ ë¬¼ë¥˜ë‹¤",content:'ì‹ë‹¹ì—ì„œ ì—°ë½ì´ ì˜¨ë‹¤. ë¬¸ì œëŠ” í•˜ë‚˜ë‹¤. ê¹€ì¹˜ê°€ ì•„ë‹ˆë¼ "ë¬¼ë¥˜"ê°€ ë„ˆë¥¼ ì£½ì´ê¸° ì‹œì‘í•œë‹¤.',condition:m=>m.hasAchievement("a05")},l05:{id:"l05",title:"ë°œíš¨ì‹¤í—˜ì‹¤ ê¸°ë¡ 1í˜¸",content:"ê¹€ì¹˜ëŠ” ì‹œê°„ì´ ë§Œë“ ë‹¤. ê·¸ë¦¬ê³  ì‹œê°„ì€ ì—°êµ¬í•  ìˆ˜ ìˆë‹¤. ì‹¤í—˜ì‹¤ì´ ì—´ë ¸ê³ , íš¨ì†Œê°€ ë³´ì´ê¸° ì‹œì‘í•œë‹¤.",condition:m=>m.hasAchievement("a07")},l06:{id:"l06",title:"ê¹€ì¹˜ì†ŒìŠ¤ëŠ” ë² ì´ìŠ¤ë‹¤",content:"ê¹€ì¹˜ëŠ” íŒ”ë¦¬ëŠ” ìŒì‹ì´ ì•„ë‹ˆë¼, ì•ˆì •ì ì¸ ê¸ˆìœµìƒí’ˆì´ë‹¤. ê¹€ì¹˜ì†ŒìŠ¤ê°€ ê·¸ ì¦ê±°ë‹¤.",condition:m=>m.hasAchievement("a08")},l07:{id:"l07",title:"ë¯¸ë˜ì‚°ì—…ì˜ ì²« ì¬ë£Œ",content:"ëˆ„êµ°ê°€ ê¹€ì¹˜ ìœ ì‚°ê· ìœ¼ë¡œ ì‹ ì†Œì¬ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤ê³  í–ˆë‹¤. ë§ë„ ì•ˆ ë˜ì§€ë§Œ, ì„œìš¸ì´ë‹ˆê¹Œ ê°€ëŠ¥í• ì§€ë„ ëª¨ë¥¸ë‹¤.",condition:m=>m.hasAchievement("a11")},l08:{id:"l08",title:"ì„œìš¸íƒ€ì›Œ ê¸°ìˆ ë¬¸ì„œ",content:"ì„œìš¸íƒ€ì›ŒëŠ” ì›ë˜ í†µì‹ íƒ‘ì´ ì•„ë‹ˆì—ˆë‹¤. ê·¸ êµ¬ì¡°ëŠ” ì²˜ìŒë¶€í„° ë°œì‚¬ëŒ€ë¥¼ ì—¼ë‘ì— ë‘ê³  ìˆì—ˆë‹¤.",condition:m=>m.hasAchievement("a14")},l09:{id:"l09",title:"ìŠ¤íƒ€ê¹€ì¹˜ì‹­: ì¡°ë¦½ ë§¤ë‰´ì–¼",content:"ì´ ìš°ì£¼ì„ ì€ ì—°ë£Œê°€ ì•„ë‹ˆë¼ ë°œíš¨ ê°€ìŠ¤ë¡œ ì›€ì§ì¸ë‹¤. ë†ë‹´ ê°™ì§€ë§Œ ì§„ì§œë‹¤.",condition:m=>m.hasAchievement("a15")},l10:{id:"l10",title:"ì™¸ê³„ë¬¼ì§ˆ(AM) íšŒìˆ˜ ë³´ê³ ì„œ",content:'ìŠ¤íƒ€ê¹€ì¹˜ì‹­ì´ ê·€í™˜í–ˆë‹¤. ì™¸ê³„ë¬¼ì§ˆ 1ì„ í™•ë³´í–ˆë‹¤. ì—°êµ¬ íƒ­ì—ì„œ "ì™¸ê³„ë¬¼ì§ˆ ì—°êµ¬ì†Œ"ë¥¼ ì—´ì–´ë³´ì.',condition:m=>m.hasAchievement("a16")},l11:{id:"l11",title:"ë‘ ë²ˆì§¸ ë°œì‚¬: ì‹ í˜¸ê°€ ë˜ëŒì•„ì˜¤ë‹¤",content:"ë¬´ì–¸ê°€ê°€ ë‹µì¥ì„ ë³´ëƒˆë‹¤. ë‹¨ìˆœí•œ ë°˜ì‚¬ê°€ ì•„ë‹ˆë‹¤. ëª…ë°±í•œ ì˜ë„ê°€ ë‹´ê¸´ ì‹ í˜¸ë‹¤.",condition:m=>m.hasAchievement("a17")},l12:{id:"l12",title:"ë‹¤ì„¯ ë²ˆì§¸ ë°œì‚¬: ëˆ„êµ°ê°€ ë“£ê³  ìˆë‹¤",content:"ê·œì¹™ì„ ë°”ê¾¸ëŠ” ìë¥¼... ëˆ„êµ°ê°€ê°€ ë³´ê³  ìˆë‹¤. ì´ì œ ë˜ëŒë¦´ ìˆ˜ ì—†ë‹¤.",condition:m=>m.hasAchievement("a18")}};class A{constructor(){this.cash=0,this.enzyme=0,this.am=0,this.lines=[],this.productInventory={},this.itemInventory={},this.completedResearch=[],this.amUpgrades=[],this.completedAchievements=[],this.startBuffEndTime=0,this.isResetting=!1}init(){this.load(),this.lines.length===0&&this.initNewGame(),this.ensureStarterLine()}ensureStarterLine(){this.lines.length===0&&this.cash<this.getLineCost()&&(console.warn("Softlock detected: No lines and insufficient cash. Forcing starter line."),this.lines.push({id:Date.now(),productId:"kimchi_1",slots:{equipment:"eq_mom_fridge",worker:"wk_me",storage:"lg_box",transporter:"tr_hand",market:"mk_neighborhood",salesOrg:"so_solo"},logisticsDir:"keep",prodAccumulator:0,sellAccumulator:0}),this.productInventory.kimchi_1||(this.productInventory.kimchi_1={keep:0,sell:0,cap:100}),this.save(),alert("ê¸´ê¸‰ êµ¬ì¡°: ìƒì‚° ë¼ì¸ì´ ìœ ì‹¤ë˜ì–´ ë³µêµ¬ë˜ì—ˆìŠµë‹ˆë‹¤."))}initNewGame(){this.cash=0,this.enzyme=0,this.completedResearch=[],this.productInventory={},this.itemInventory={},this.itemInventory.eq_mom_fridge=1,this.itemInventory.wk_me=1,this.itemInventory.lg_box=1,this.itemInventory.tr_hand=1,this.itemInventory.mk_neighborhood=1,this.itemInventory.so_solo=1,this.lines=[{id:Date.now(),productId:"kimchi_1",slots:{equipment:"eq_mom_fridge",worker:"wk_me",storage:"lg_box",transporter:"tr_hand",market:"mk_neighborhood",salesOrg:"so_solo"},logisticsDir:"keep",prodAccumulator:0,sellAccumulator:0}],this.productInventory.kimchi_1={keep:0,sell:0,cap:100},this.save()}save(){if(this.isResetting)return;const t={cash:this.cash,enzyme:this.enzyme,am:this.am,lines:this.lines,productInventory:this.productInventory,itemInventory:this.itemInventory,completedResearch:this.completedResearch,amUpgrades:this.amUpgrades,completedAchievements:this.completedAchievements,startBuffEndTime:this.startBuffEndTime};localStorage.setItem("kimchi_invasion_save_v1",JSON.stringify(t)),window.dispatchEvent(new CustomEvent("kimchi-saved"))}load(){let t=null;try{t=localStorage.getItem("kimchi_invasion_save_v1")}catch(i){console.error("Storage Access Error:",i)}if(t)try{const i=JSON.parse(t);this.cash=i.cash||0,this.enzyme=i.enzyme||0,this.am=i.am||0,this.lines=i.lines||[],this.lines.forEach(e=>{e.slots||(e.slots={}),e.slots.logistics&&!e.slots.transporter&&(e.slots.transporter=e.slots.logistics,delete e.slots.logistics),e.slots.equipment||(e.slots.equipment="eq_mom_fridge"),e.slots.worker||(e.slots.worker="wk_me"),e.slots.storage||(e.slots.storage="lg_box"),e.slots.transporter||(e.slots.transporter="tr_hand"),e.slots.market||(e.slots.market="mk_neighborhood"),e.slots.salesOrg||(e.slots.salesOrg="so_solo"),"logistics"in e.slots&&delete e.slots.logistics,e.id||(e.id=Date.now()+Math.random().toString(36).substr(2,5)),e.prodAccumulator===void 0&&(e.prodAccumulator=0),e.sellAccumulator===void 0&&(e.sellAccumulator=0)}),this.productInventory=i.productInventory||{},this.itemInventory=i.itemInventory||{},this.completedResearch=i.completedResearch||[],this.amUpgrades=i.amUpgrades||[],this.completedAchievements=i.completedAchievements||[],this.startBuffEndTime=i.startBuffEndTime||0}catch(i){console.error("Save File Corrupted:",i),localStorage.setItem(`kimchi_invasion_save_broken_${Date.now()}`,t),alert("ì €ì¥ëœ ë°ì´í„°ê°€ ì†ìƒë˜ì–´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤. (ë°±ì—… ì™„ë£Œ)"),this.initNewGame()}}tick(t){const i=this.getAMBuffs(),e=i.prodSpeedMult*i.startBuffVal;this.lines.forEach(s=>{const o=s.productId;if(!o)return;this.productInventory[o]||(this.productInventory[o]={keep:0,sell:0,cap:100});let a=100;s.slots.storage&&n[s.slots.storage],this.productInventory[o].cap=Math.floor(a*i.capMult),this.produceAuto(s,t*e,i),this.sellAuto(s,t*i.sellSpeedMult,i),this.moveAuto(s,t*i.moveSpeedMult)}),this.checkAchievements()}produceAuto(t,i,e){const s=t.productId,o=this.productInventory[s];let a=0;if(t.slots.worker&&n[t.slots.worker]&&(a=n[t.slots.worker].effects.prodSpeed||0),a<=0)return;const c=a*i;if(t.prodAccumulator+=c,t.prodAccumulator>=1){if(!this.checkRecipe(s,1,e)){t.prodAccumulator=1;return}let l=1;t.slots.equipment&&n[t.slots.equipment]&&(l+=n[t.slots.equipment].effects.batch||0);const d=o.keep+o.sell;let r=l;d+r>o.cap&&(r=o.cap-d),r>0?(this.consumeRecipe(s,1,e),s==="enzyme_vial"?this.enzyme+=r:o.keep+=r,t.prodAccumulator-=1):t.prodAccumulator=1}}sellAuto(t,i,e){const s=t.productId,o=this.productInventory[s];let a=0;if(t.slots.salesOrg&&n[t.slots.salesOrg]&&(a=n[t.slots.salesOrg].effects.sellSpeed||0),!(a<=0)&&(t.sellAccumulator+=a*i,t.sellAccumulator>=1)){let c=1;if(t.slots.market&&n[t.slots.market]&&(c+=n[t.slots.market].effects.sellAmount||0),o.sell>=c)o.sell-=c,this.cash+=this.getProductPrice(s)*c,t.sellAccumulator-=1;else if(o.sell>0){const l=o.sell;o.sell=0,this.cash+=this.getProductPrice(s)*l,t.sellAccumulator-=1}else t.sellAccumulator=1}}moveAuto(t,i){let e=0;t.slots.transporter&&n[t.slots.transporter]&&(e=n[t.slots.transporter].effects.moveSpeed||0);let s=1;t.slots.storage&&n[t.slots.storage]&&(s+=n[t.slots.storage].effects.moveBatch||0);const o=e*i*s;if(o<=0)return;const a=this.productInventory[t.productId];if(a)if(t.logisticsDir==="sell"){const c=Math.min(o,a.keep);c>0&&(a.keep-=c,a.sell+=c)}else{const c=Math.min(o,a.sell);c>0&&(a.sell-=c,a.keep+=c)}}produce(t){const i=this.lines.find(d=>d.id===t);if(!i)return 0;const e=i.productId,s=this.productInventory[e],o=this.getAMBuffs();if(!this.checkRecipe(e,1,o))return-1;let a=1;i.slots.equipment&&n[i.slots.equipment]&&(a+=n[i.slots.equipment].effects.batch||0);const c=s.keep+s.sell;let l=a;return c+l>s.cap&&(l=s.cap-c),l>0?(this.consumeRecipe(e,1,o),e==="enzyme_vial"?this.enzyme+=l:s.keep+=l,this.save(),l):0}sell(t){const i=this.lines.find(l=>l.id===t);if(!i)return 0;const e=i.productId,s=this.productInventory[e];let o=1;i.slots.market&&n[i.slots.market]&&(o+=n[i.slots.market].effects.sellAmount||0);const a=this.getProductPrice(e);let c=0;return s.sell>=o?(s.sell-=o,c=a*o):s.sell>0&&(c=a*s.sell,s.sell=0),c>0&&(this.cash+=c,this.save()),c}moveLogistics(t,i){const e=this.lines.find(a=>a.id===t);if(!e)return;let s=1;e.slots.storage&&n[e.slots.storage]&&(s+=n[e.slots.storage].effects.moveBatch||0),s*=5;const o=this.productInventory[e.productId];if(i==="sell"){const a=Math.min(s,o.keep);o.keep-=a,o.sell+=a}else{const a=Math.min(s,o.sell);o.sell-=a,o.keep+=a}this.save()}toggleLogisticsDir(t){const i=this.lines.find(e=>e.id===t);i&&(i.logisticsDir=i.logisticsDir==="keep"?"sell":"keep",this.save())}buyLine(){const t=this.getLineCost();if(this.cash>=t){this.cash-=t;const i=Date.now()+Math.floor(Math.random()*1e3);return this.lines.push({id:i,productId:null,slots:{equipment:"eq_mom_fridge",worker:"wk_me",storage:"lg_box",transporter:"tr_hand",market:"mk_neighborhood",salesOrg:"so_solo"},logisticsDir:"sell",prodAccumulator:0,sellAccumulator:0}),this.save(),!0}return!1}removeLine(t){const i=this.lines.findIndex(e=>e.id===t);if(i>-1){const e=this.lines.length,o=E.line_base_cost*Math.pow(E.line_cost_growth,e-1)*E.refund_rate;this.cash+=o,this.lines.splice(i,1),this.save()}}buyAMUpgrade(t){const i=I[t];return!i||this.amUpgrades.includes(t)?!1:this.am>=i.cost?(this.am-=i.cost,this.amUpgrades.push(t),this.save(),!0):!1}getLineCost(){return E.line_base_cost*Math.pow(E.line_cost_growth,this.lines.length)}getProductPrice(t){if(!b[t])return 0;const i=this.getAMBuffs();return b[t].price*i.priceMult}checkRecipe(t,i,e){const s=b[t].recipe;if(!s)return!0;for(const[o,a]of Object.entries(s)){const c=a*i*(1-e.costReduce);if(!this.productInventory[o]||this.productInventory[o].keep<c)return!1}return!0}consumeRecipe(t,i,e){const s=b[t].recipe;if(s)for(const[o,a]of Object.entries(s)){const c=a*i*(1-e.costReduce);this.productInventory[o]&&(this.productInventory[o].keep-=c)}}getAMBuffs(){const t={prodSpeedMult:1,costReduce:0,capMult:1,moveSpeedMult:1,sellSpeedMult:1,priceMult:1,researchEnzymeReduce:0,researchCashReduce:0,startCashMult:1,startBuffVal:1};return this.amUpgrades.forEach(i=>{const e=I[i];e&&e.effects&&(e.effects.prodSpeedMult&&(t.prodSpeedMult*=e.effects.prodSpeedMult),e.effects.costReduce&&(t.costReduce+=e.effects.costReduce),e.effects.capMult&&(t.capMult*=e.effects.capMult),e.effects.moveSpeedMult&&(t.moveSpeedMult*=e.effects.moveSpeedMult),e.effects.sellSpeedMult&&(t.sellSpeedMult*=e.effects.sellSpeedMult),e.effects.priceMult&&(t.priceMult*=e.effects.priceMult))}),this.startBuffEndTime>Date.now()&&(t.startBuffVal=1.25),t}checkAchievements(){Object.values(x).forEach(t=>{if(this.completedAchievements.includes(t.id))return;let i=!1;if(t.id==="a01"){const e=this.productInventory.kimchi_1;e&&(e.keep>0||e.sell>0)&&(i=!0)}t.id==="a02"&&this.cash>5e4&&(i=!0),i&&(this.completedAchievements.push(t.id),this.save(),window.dispatchEvent(new CustomEvent("achievement-unlocked",{detail:t})))})}hasAchievement(t){return this.completedAchievements.includes(t)}prestige(){this.am+=1,this.getAMBuffs(),this.cash=0,this.amUpgrades.includes("am_start_cash")&&(this.cash=1e6),this.enzyme=0,this.completedResearch=[],this.productInventory={},this.itemInventory={},this.amUpgrades.includes("am_start_buff")&&(this.startBuffEndTime=Date.now()+3e5),this.initNewGame(),alert("Prestige Successful! Earned 1 AM."),location.reload()}getEnterpriseValue(){return this.cash+this.getInventoryValue()+this.getAssetValue()}getInventoryValue(){return Object.entries(this.productInventory).reduce((t,[i,e])=>{var s;return t+(e.keep+e.sell)*(((s=b[i])==null?void 0:s.price)||0)},0)}getAssetValue(){return this.lines.length*1e5}}class C{constructor(t){var i,e;this.game=t,this.els={cash:document.getElementById("res-cash"),enzyme:document.getElementById("res-enzyme"),enzymeContainer:(i=document.getElementById("res-enzyme"))==null?void 0:i.parentElement,am:document.getElementById("res-am"),amContainer:(e=document.getElementById("res-am"))==null?void 0:e.parentElement,prodList:document.getElementById("prod-list"),logiList:document.getElementById("logi-list"),salesList:document.getElementById("sales-list"),researchList:document.getElementById("research-list"),statsList:document.getElementById("stats-list"),tabs:document.querySelectorAll(".tab-btn"),cols:document.querySelectorAll(".col")},this.setupTabs(),this.setupGlobalButtons(),this.setupAchievementListener(),this.displayCash=0}getImageUrl(t,i){var a,c,l,d,r,p;if(!i||!i.slots)return"src/assets/images/placeholder.png";let e=1,s=1,o="base";return t==="prod"?(e=((a=n[i.slots.equipment])==null?void 0:a.tier)||1,s=((c=n[i.slots.worker])==null?void 0:c.tier)||1,o="prod"):t==="logi"?(e=((l=n[i.slots.storage])==null?void 0:l.tier)||1,s=((d=n[i.slots.transporter])==null?void 0:d.tier)||1,o="logi"):t==="sales"&&(e=((r=n[i.slots.market])==null?void 0:r.tier)||1,s=((p=n[i.slots.salesOrg])==null?void 0:p.tier)||1,o="sales"),`src/assets/images/${o}/${o}_t${e}_t${s}.jpg`}init(){this.renderLines(),this.renderResearch(),this.renderStats(),this.update(),window.addEventListener("kimchi-saved",()=>this.showAutoSaveIndicator()),this.game.lines.length===1&&!this.game.completedAchievements.length&&this.game.lines[0].slots.worker===null&&(this.game.completedResearch.includes("unlock_kkakdugi")||this.showModal("START_GAME"))}setupTabs(){document.body.setAttribute("data-active-tab","prod"),this.els.tabs.forEach(t=>{t.addEventListener("click",()=>{const i=t.dataset.tab;this.els.tabs.forEach(s=>s.classList.remove("active")),t.classList.add("active"),document.body.setAttribute("data-active-tab",i);const e={prod:"col-prod",logi:"col-logi",sales:"col-sales",research:"col-research",stats:"col-stats"};this.els.cols.forEach(s=>{s.classList.remove("active"),s.id===e[i]&&s.classList.add("active")})})})}setupGlobalButtons(){const t=document.getElementById("btn-add-line-global");t&&t.addEventListener("click",()=>{const l=this.game.getLineCost();confirm(`ìƒì‚° ë¼ì¸ì„ ì¶”ê°€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
ë¹„ìš©: ${l.toLocaleString()}ì›`)&&(this.game.buyLine()?(this.renderLines(),this.update()):alert("í˜„ê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤."))});const i=document.getElementById("btn-settings");i&&i.addEventListener("click",()=>{this.showModal("SETTINGS")});const e=document.getElementById("btn-help");e&&e.addEventListener("click",()=>this.showModal("HELP"));const s=document.querySelector(".favorite-btn");s&&s.addEventListener("click",()=>alert("Ctrl+Dë¥¼ ëˆŒëŸ¬ ì¦ê²¨ì°¾ê¸°ì— ì¶”ê°€í•˜ì„¸ìš”!"));const o=document.querySelector(".share-btn");o&&o.addEventListener("click",async()=>{const l=location.href;try{if(navigator.share)await navigator.share({title:"Kimchi Invasion",text:"ê¹€ì¹˜ë¡œ ìš°ì£¼ë¥¼ ì •ë³µí•˜ë¼! Kimchi Invasion",url:l}),this.showToast("ê³µìœ  ì°½ì´ ì—´ë ¸ìŠµë‹ˆë‹¤.");else throw new Error("No Share API")}catch{try{await navigator.clipboard.writeText(l),this.showToast("ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!")}catch{prompt("URLì„ ë³µì‚¬í•˜ì„¸ìš”:",l)}}});const a=document.querySelector(".account-btn"),c=document.querySelector(".account-dropdown");a&&c&&(a.addEventListener("click",l=>{l.stopPropagation(),c.style.display=c.style.display==="block"?"none":"block"}),document.addEventListener("click",()=>c.style.display="none"),c.addEventListener("click",l=>l.stopPropagation()))}setupAchievementListener(){window.addEventListener("achievement-unlocked",t=>{const i=t.detail;this.showToast(`ğŸ† ì—…ì  ë‹¬ì„±: ${i.title}`),this.renderStats();const e=Object.values($).find(s=>s.condition(this.game)&&s.id===i.rewardLog);e&&(["l01","l10","l08"].includes(e.id)?this.showModal("LOGBOOK_ENTRY",e):this.showToast(`ğŸ“– ë¡œê·¸ë¶ ê¸°ë¡ë¨: ${e.title}`),this.renderStats())})}renderLines(){try{this.els.prodList.innerHTML="",this.els.logiList.innerHTML="",this.els.salesList.innerHTML="",(this.game.lines||[]).forEach((e,s)=>{const o=this.renderProdCard(e,s);this.els.prodList.appendChild(o);const a=this.renderLogiCard(e,s);this.els.logiList.appendChild(a);const c=this.renderSalesCard(e,s);this.els.salesList.appendChild(c)});const i=this.createAddLineBtn();this.els.prodList.appendChild(i),this.update()}catch(t){console.error("RenderLines Error:",t),this.showToast("Render Error: "+t.message,"error")}}createAddLineBtn(){const t=document.createElement("button");t.className="btn btn-add-line-main",t.style.width="100%",t.style.marginTop="10px";const i=this.game.getLineCost();return t.innerHTML=`+ ìƒˆ ë¼ì¸ í™•ë³´ (â‚©${i.toLocaleString()})`,t.onclick=()=>{this.game.buyLine()?(this.renderLines(),this.update()):this.showToast("ìê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤.","error")},t}renderCardShell({id:t,type:i,headTitle:e,headBadge:s,imageUrl:o,tierBadgeTR:a,tierBadgeBR:c,slotChipsHTML:l,ctaHTML:d,advancedHTML:r,footerHTML:p}){const h=document.createElement("div");h.className=`card-shell card--${i} animate-fade-in`,h.id=`card-${i}-${t}`,h.dataset.lineId=t;const u=a?`<div class="badge-tr">${a}</div>`:"",f=c?`<div class="badge-br">${c}</div>`:"";return h.innerHTML=`
            <div class="card-head">
                <div class="head-title">${e}</div>
                <div class="head-badge">${s}</div>
            </div>

            <div class="card-image">
                <img src="${o}" onerror="this.style.opacity='0.2'" alt="${e}">
                <div class="tier-badges">
                    ${u}
                    ${f}
                </div>
            </div>

            <div class="slot-chips">
                ${l}
            </div>

            <div class="cta-row">
                ${d}
            </div>

            <details class="advanced">
                <summary>ADVANCED OPTIONS â–¼</summary>
                <div class="advanced-content">
                    ${r||""}
                </div>
            </details>
            
            <div class="card-footer">
                ${p||""}
            </div>
            
            <button class="btn-remove-line-top" style="top:4px; right:4px;">&times;</button>
        `,h.querySelector(".btn-remove-line-top").onclick=g=>{g.stopPropagation(),confirm("ì´ ë¼ì¸ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ë³µêµ¬ ë¶ˆê°€)")&&(this.game.removeLine(t),this.update())},h}getTier(t,i){if(!t||!t.slots||!t.slots[i])return 1;const e=n[t.slots[i]];return e?e.tier:1}getMultiplier(t,i){let e=1;if(!t||!t.slots)return e;for(const[s,o]of Object.entries(t.slots))o&&n[o]&&n[o].effects&&(e+=n[o].effects[i]||0);return e}renderSlotHTML(t,i,e,s="Slot"){let o=`<span class="icon">â•</span> ${s}`,a='<span style="opacity:0.5;">Empty</span>',c="";if(e&&n[e]){const l=n[e];o=`<span class="icon">${this.getIconForType(i)}</span> ${l.name}`,a=`<span style="color:var(--accent-secondary);">T${l.tier}</span>`,c="active"}return`
            <div class="slot-item-wide btn-slot ${c}" data-line="${t}" data-type="${i}">
                <div class="slot-inner-left">${o}</div>
                <div class="slot-inner-right">${a}</div>
            </div>
        `}getIconForType(t){switch(t){case"equipment":return"ğŸ­";case"worker":return"ğŸ‘·";case"storage":return"ğŸ“¦";case"transporter":return"ğŸšš";case"market":return"ğŸª";case"salesOrg":return"ğŸ¤";default:return"ğŸ§©"}}renderProdCard(t){var p,h,u,f,g;const i=b[t.productId];if(!i){const v=document.createElement("div");return v.className="card card--prod card--empty",v.innerHTML=`
                <div class="card-empty-state">
                    <button class="btn-assign-product">ìƒì‚° í’ˆëª© ì„ íƒ</button>
                </div>
            `,v.querySelector(".btn-assign-product").onclick=y=>this.showProductPicker(y,t.id),v}this.game.lines.indexOf(t);const e=((p=n[t.slots.equipment])==null?void 0:p.tier)||1,s=((h=n[t.slots.worker])==null?void 0:h.tier)||1;let o=1;t.slots.equipment&&n[t.slots.equipment]&&(o+=n[t.slots.equipment].effects.batch||0);const a=this.game.getAMBuffs();let c=0;t.slots.worker&&n[t.slots.worker]&&(c=(n[t.slots.worker].effects.prodSpeed||0)*a.prodSpeedMult*a.startBuffVal);const l=Math.floor(((u=this.game.productInventory[t.productId])==null?void 0:u.keep)||0),d=document.createElement("div");d.className="card card--prod",d.dataset.lineId=t.id,d.innerHTML=`
            <div class="card-header">
                <span class="card-title">${i.name}</span>
                <span class="card-badge">T${Math.max(e,s)}</span>
            </div>
            
            <div class="card-image">
                <img src="${this.getImageUrl("prod",t)}" alt="${i.name}">
                <div class="badge-facility">T${e} ì‹œì„¤</div>
                <div class="badge-worker">W${s} ì§ì›</div>
            </div>
            
            <div class="slot-row">
                <button class="slot-btn slot-facility" data-slot-type="equipment">
                    <span class="slot-icon">${this.getIconForType("equipment")}</span>
                    <span class="slot-name">${((f=n[t.slots.equipment])==null?void 0:f.name)||"ì—†ìŒ"}</span>
                    <span class="slot-tier">T${e}</span>
                </button>
                <button class="slot-btn slot-worker" data-slot-type="worker">
                    <span class="slot-icon">${this.getIconForType("worker")}</span>
                    <span class="slot-name">${((g=n[t.slots.worker])==null?void 0:g.name)||"ì—†ìŒ"}</span>
                    <span class="slot-tier">W${s}</span>
                </button>
            </div>
            
            <button class="cta-main cta--prod" data-btn-type="produce">
                ${i.emoji} ìƒì‚°í•˜ê¸° +${o}
            </button>
            
            <div class="card-info">
                <div class="info-row">
                    <span>ìƒì‚°ëŸ‰: +${o} í´ë¦­ / ${c.toFixed(1)}ì´ˆë‹¹</span>
                </div>
                <div class="info-row">
                    <span>ì°½ê³  ì¬ê³ : <strong>${l.toLocaleString()}</strong></span>
                </div>
            </div>
            
            <div class="card-toggle">
                <label class="toggle-label">
                    <input type="checkbox" class="toggle-auto">
                    <span class="toggle-text">ğŸ” í† ì„ ë§Œìƒ</span>
                </label>
            </div>
        `;const r=d.querySelector('[data-btn-type="produce"]');return r.onclick=()=>{this.game.produce(t.id),this.update()},this.bindSlotEvent(d,t.id,"equipment"),this.bindSlotEvent(d,t.id,"worker"),d}renderLogiCard(t,i){var u,f,g,v,y,k;if(!b[t.productId])return document.createElement("div");const s=((u=n[t.slots.storage])==null?void 0:u.tier)||1,o=((f=n[t.slots.transporter])==null?void 0:f.tier)||1;let a=1;t.slots.storage&&n[t.slots.storage]&&(a+=n[t.slots.storage].effects.moveBatch||0);const c=this.game.getAMBuffs();t.slots.transporter&&n[t.slots.transporter]&&(n[t.slots.transporter].effects.moveSpeed||0)*c.moveSpeedMult;const l=Math.floor(((g=this.game.productInventory[t.productId])==null?void 0:g.keep)||0),d=Math.floor(((v=this.game.productInventory[t.productId])==null?void 0:v.sell)||0),r=document.createElement("div");r.className="card card--logi",r.dataset.lineId=t.id,r.innerHTML=`
            <div class="card-header">
                <span class="card-title">ë¬¼ë¥˜ íŠ¸ë ˆì´ì…˜</span>
                <span class="card-badge">T${Math.max(s,o)}</span>
            </div>
            
            <div class="card-image">
                <img src="${this.getImageUrl("logi",t)}" alt="ë¬¼ë¥˜">
                <div class="badge-facility">T${s} ì°½ê³ </div>
                <div class="badge-worker">W${o} ìš´ì†¡</div>
            </div>
            
            <div class="slot-row">
                <button class="slot-btn slot-facility" data-slot-type="storage">
                    <span class="slot-icon">${this.getIconForType("storage")}</span>
                    <span class="slot-name">${((y=n[t.slots.storage])==null?void 0:y.name)||"ì—†ìŒ"}</span>
                    <span class="slot-tier">T${s}</span>
                </button>
                <button class="slot-btn slot-worker" data-slot-type="transporter">
                    <span class="slot-icon">${this.getIconForType("transporter")}</span>
                    <span class="slot-name">${((k=n[t.slots.transporter])==null?void 0:k.name)||"ì—†ìŒ"}</span>
                    <span class="slot-tier">W${o}</span>
                </button>
            </div>
            
            <button class="cta-main cta--logi" data-btn-type="ship">
                ğŸšš ì¶œí•˜í•˜ê¸° +${a}
            </button>
            
            <div class="card-info">
                <div class="info-row">
                    <span>ì°½ê³  ì¬ê³ : <strong>${l.toLocaleString()}</strong></span>
                    <span>íŒë§¤ ì¬ê³ : <strong>${d.toLocaleString()}</strong></span>
                </div>
            </div>
            
            <div class="card-toggle">
                <label class="toggle-label toggle-label--priority">
                    <button class="priority-btn ${t.logisticsDir==="keep"?"is-active":""}" data-mode="keep">ğŸ§­ ì°½ê³  ìš°ì„ </button>
                    <button class="priority-btn ${t.logisticsDir!=="keep"?"is-active":""}" data-mode="sell">ğŸ§­ ì¶œí•˜ ìš°ì„ </button>
                </label>
            </div>
        `;const p=r.querySelector('[data-btn-type="ship"]');return p.onclick=()=>{this.game.moveLogistics(t.id,"sell"),this.update()},r.querySelectorAll(".priority-btn").forEach(w=>{w.onclick=()=>{const L=w.dataset.mode;t.logisticsDir!==L&&(this.game.toggleLogisticsDir(t.id),this.renderLines())}}),this.bindSlotEvent(r,t.id,"storage"),this.bindSlotEvent(r,t.id,"transporter"),r}renderSalesCard(t,i){var u,f,g,v,y;if(!b[t.productId])return document.createElement("div");const s=this.game.getAMBuffs(),o=((u=n[t.slots.market])==null?void 0:u.tier)||1,a=((f=n[t.slots.salesOrg])==null?void 0:f.tier)||1;let c=1;t.slots.market&&n[t.slots.market]&&(c+=n[t.slots.market].effects.sellAmount||0);let l=0;t.slots.salesOrg&&n[t.slots.salesOrg]&&(l=(n[t.slots.salesOrg].effects.sellSpeed||0)*s.sellSpeedMult);const d=this.game.getProductPrice(t.productId),r=Math.floor(((g=this.game.productInventory[t.productId])==null?void 0:g.sell)||0),p=document.createElement("div");p.className="card card--sales",p.dataset.lineId=t.id,p.innerHTML=`
            <div class="card-header">
                <span class="card-title">íŒë§¤</span>
                <span class="card-badge">T${Math.max(o,a)}</span>
            </div>
            
            <div class="card-image">
                <img src="${this.getImageUrl("sales",t)}" alt="íŒë§¤">
                <div class="badge-facility">T${o} ë§ˆì¼“</div>
                <div class="badge-worker">W${a} ì˜ì—…</div>
            </div>
            
            <div class="slot-row">
                <button class="slot-btn slot-facility" data-slot-type="market">
                    <span class="slot-icon">${this.getIconForType("market")}</span>
                    <span class="slot-name">${((v=n[t.slots.market])==null?void 0:v.name)||"ì—†ìŒ"}</span>
                    <span class="slot-tier">T${o}</span>
                </button>
                <button class="slot-btn slot-worker" data-slot-type="salesOrg">
                    <span class="slot-icon">${this.getIconForType("salesOrg")}</span>
                    <span class="slot-name">${((y=n[t.slots.salesOrg])==null?void 0:y.name)||"ì—†ìŒ"}</span>
                    <span class="slot-tier">W${a}</span>
                </button>
            </div>
            
            <button class="cta-main cta--sales" data-btn-type="sell">
                ğŸ’° íŒë§¤í•˜ê¸° +${Math.floor(d*c).toLocaleString()}ì›
            </button>
            
            <div class="card-info">
                <div class="info-row">
                    <span>ìë™ íŒë§¤: ${l.toFixed(1)}ì´ˆë‹¹</span>
                    <span>ë‹¨ê°€: <strong>${Math.floor(d).toLocaleString()}ì›</strong></span>
                </div>
                <div class="info-row">
                    <span>íŒë§¤ ì¬ê³ : <strong>${r.toLocaleString()}</strong></span>
                </div>
            </div>
            
            <div class="card-toggle">
                <label class="toggle-label">
                    <input type="checkbox" class="toggle-auto" checked disabled>
                    <span class="toggle-text">ğŸ” í† ì„ ë§Œìƒ</span>
                </label>
            </div>
        `;const h=p.querySelector('[data-btn-type="sell"]');return h.onclick=()=>{const k=this.game.sell(t.id);k>0?(this.createFloatingText(h.getBoundingClientRect().left+50,h.getBoundingClientRect().top,`+${Math.floor(k).toLocaleString()}ì›`,"cash"),this.update()):this.showToast("íŒë§¤í•  ì¬ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.","error")},this.bindSlotEvent(p,t.id,"market"),this.bindSlotEvent(p,t.id,"salesOrg"),p}renderAchievements(){const t=document.getElementById("achievement-grid"),i=document.getElementById("achievement-detail");t&&Object.values(x).forEach(e=>{const s=this.game.completedAchievements.includes(e.id),o=document.createElement("div");o.className=`ach-icon ${s?"unlocked":"locked"}`,o.textContent=s?"ğŸ†":"ğŸ”’",o.style.width="30px",o.style.height="30px",o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.background=s?"var(--accent)":"#333",o.style.color=s?"#000":"#555",o.style.borderRadius="4px",o.style.cursor="pointer",o.addEventListener("mouseenter",()=>{i.innerHTML=`<span style="color:#fff">${e.title}</span><br>${e.desc}`}),o.addEventListener("mouseleave",()=>{i.innerHTML=""}),t.appendChild(o)})}renderLogbook(){const t=document.getElementById("logbook-list");t&&(t.innerHTML="",Object.values($).forEach(i=>{const e=i.condition(this.game),s=document.createElement("div");s.className="log-item animate-fade-in",s.style.borderLeftColor=e?"var(--accent)":"#333",s.style.opacity=e?"1":"0.5",s.style.cursor=e?"pointer":"default",e?s.innerHTML=`
                    <div class="log-title" style="color:var(--accent)">[í•´ê¸ˆ] ${i.title}</div>
                    <div class="log-content">${i.content}</div>
                `:(s.classList.add("locked"),s.innerHTML=`
                    <div class="log-title" style="color:#555">ğŸ”’ ì ê¹€: ${i.title}</div>
                `),t.appendChild(s)}))}renderAMUpgrades(){const t=document.getElementById("am-upgrade-list");t&&(t.innerHTML="",Object.values(I).forEach(i=>{const e=this.game.amUpgrades.includes(i.id),s=document.createElement("div");s.className=`card res-card am-upg-card ${e?"completed":""}`,s.style.minHeight="auto",s.style.marginBottom="8px",s.style.borderColor=e?"var(--accent)":"var(--card-border)",s.innerHTML=`
                <div class="card-title" style="color:var(--accent); font-size:14px;">${i.name}</div>
                <div class="card-desc" style="font-size:11px;">${i.desc}</div>
                <div class="card-footer" style="margin-top:8px;">
                    <span class="res-cost" style="font-size:12px;">${e?"íšë“ ì™„ë£Œ":"âš›ï¸ "+i.cost}</span>
                    ${e?"":`<button class="btn btn-xs btn-buy-am" data-id="${i.id}">íšë“</button>`}
                </div>
            `,e||s.querySelector(".btn-buy-am").addEventListener("click",()=>{this.game.buyAMUpgrade(i.id)?(this.renderAMUpgrades(),this.update()):alert("ì™¸ê³„ ë¬¼ì§ˆ(AM)ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.")}),t.appendChild(s)}))}renderFlash(t){t.classList.add("flash"),setTimeout(()=>t.classList.remove("flash"),150)}createFloatingText(t,i,e,s="#fff"){const o=document.createElement("div");o.textContent=e,o.className="floating-text",["cash","item","err"].includes(s)?o.classList.add(s):o.style.color=s,o.style.left=t+"px",o.style.top=i+"px",document.body.appendChild(o),requestAnimationFrame(()=>{o.style.transform="translateY(-50px)",o.style.opacity="0",o.style.transition="all 0.8s cubic-bezier(0.22, 1, 0.36, 1)"}),setTimeout(()=>o.remove(),800)}showToast(t,i="info"){let e=document.querySelector(".toast-container");e||(e=document.createElement("div"),e.className="toast-container",document.body.appendChild(e));const s=document.createElement("div");s.className="toast",s.dataset.type=i;let o="â„¹ï¸";i==="success"&&(o="âœ…"),i==="error"&&(o="âš ï¸"),s.innerHTML=`<span style="font-size:16px;">${o}</span> <span>${t}</span>`,e.appendChild(s),setTimeout(()=>{s.style.opacity="0",s.style.transform="translateY(-20px)",setTimeout(()=>s.remove(),300)},3e3)}showModal(t,i){const e=document.createElement("div");e.className="modal-overlay animate-fade-in",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100vh",e.style.background="rgba(0,0,0,0.9)",e.style.zIndex="10000",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center";let s="";t==="START_GAME"?s=`
                <div class="modal-content" style="max-width:300px; text-align:center;">
                    <h2 style="color:var(--accent); margin-bottom:15px;">SEOUL 2033:<br>Kimchi Invasion</h2>
                    <p style="font-size:14px; line-height:1.6; color:#ccc; margin-bottom:20px;">
                        "ì—„ë§ˆ, ëƒ‰ì¥ê³ ì— ê¹€ì¹˜ê°€ ë„ˆë¬´ ë§ì•„..."<br><br>
                        ì„œìš¸ì˜ ìƒì¡´ì€ ëŠ˜ í•˜ë‚˜ì˜€ìŠµë‹ˆë‹¤.<br>
                        ë‚¨ê¸°ëŠ” ê²Œ ì•„ë‹ˆë¼, ìŒ“ëŠ” ê²ƒ.<br>
                        ì´ì œ ë‹¹ì‹ ì˜ ê¹€ì¹˜ ì œêµ­ì´ ì‹œì‘ë©ë‹ˆë‹¤.
                    </p>
                    <button class="btn btn-action" id="modal-close">íŒë§¤ ì‹œì‘</button>
                </div>
             `:t==="LOGBOOK_ENTRY"?s=`
                <div class="modal-content" style="max-width:400px; text-align:left; border: 1px solid var(--accent); padding:20px; background:#111;">
                    <h3 style="color:var(--accent); font-size:16px; margin-bottom:10px;">${i.title}</h3>
                    <p style="font-size:14px; line-height:1.6; color:#ddd; white-space:pre-wrap;">${i.content}</p>
                    <div style="text-align:right; margin-top:20px;">
                        <button class="btn btn-sm" id="modal-close">í™•ì¸</button>
                    </div>
                </div>
             `:t==="HELP"?s=`
                <div class="modal-content" style="max-width:500px; text-align:left; max-height:80vh; overflow-y:auto;">
                    <h2 style="color:var(--accent); border-bottom:1px solid #333; padding-bottom:10px;">ê²Œì„ ê°€ì´ë“œ</h2>
                    <div style="font-size:14px; line-height:1.6; color:#ddd; margin-top:10px;">
                        <p style="margin-bottom:10px;"><strong>1. ìƒì‚° (Production)</strong><br>
                        ê¹€ì¹˜ë¥¼ ìƒì‚°í•©ë‹ˆë‹¤. 'ì¥ë¹„'ì™€ 'ì‘ì—…ì'ë¥¼ ì—…ê·¸ë ˆì´ë“œí•˜ì—¬ ì†ë„ì™€ ë°°ì¹˜ í¬ê¸°ë¥¼ ëŠ˜ë¦¬ì„¸ìš”.</p>
                        
                        <p style="margin-bottom:10px;"><strong>2. ë¬¼ë¥˜ (Logistics)</strong><br>
                        ìƒì‚°ëœ ê¹€ì¹˜ëŠ” ì¼ë‹¨ 'ë³´ê´€'ë©ë‹ˆë‹¤. ë¬¼ë¥˜ ì¹´ë“œì˜ ë°¸ë¸Œë¥¼ <span style="color:#f59e0b">ğŸ“¤ ì¶œí•˜</span>ë¡œ ëŒë ¤ì•¼ íŒë§¤ ë‹¨ê³„ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.<br>
                        <em>íŒ: ë¬¼ë¥˜ íš¨ìœ¨ì´ ë‚®ìœ¼ë©´ ìƒì‚°ì´ ë©ˆì¶¥ë‹ˆë‹¤!</em></p>
                        
                        <p style="margin-bottom:10px;"><strong>3. íŒë§¤ (Sales)</strong><br>
                        ì¶œí•˜ëœ ê¹€ì¹˜ë¥¼ ì‹œì¥ì— íŒë‹ˆë‹¤. 'ë§ˆì¼€íŒ…'ê³¼ 'ì˜ì—…ì¡°ì§'ì´ íŒë§¤ ì†ë„ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.</p>
                        
                        <p style="margin-bottom:10px;"><strong>4. ì—°êµ¬ & AM</strong><br>
                        'íš¨ì†Œ'ë¥¼ ëª¨ì•„ ì—°êµ¬ë¥¼ ì§„í–‰í•˜ê³ , ì¬ì„¤ì •(Prestige)ì„ í†µí•´ 'ì™¸ê³„ ë¬¼ì§ˆ(AM)'ì„ íšë“í•˜ì—¬ ì˜êµ¬ì ì¸ ê°•í•¨ì„ ì–»ìœ¼ì„¸ìš”.</p>
                    </div>
                    <div style="text-align:right; margin-top:20px;">
                        <button class="btn btn-action" id="modal-close">ë‹«ê¸°</button>
                    </div>
                </div>
             `:t==="SETTINGS"&&(s=`
                <div class="modal-content" style="max-width:320px; text-align:center;">
                    <h3 style="color:var(--text-main); font-size:18px; margin-bottom:20px; border-bottom:1px solid var(--glass-border); padding-bottom:10px;">SETTINGS</h3>
                    
                    <div style="display:flex; flex-direction:column; gap:10px;">
                        <button class="btn" id="btn-save-manual" style="width:100%; padding:12px;">ğŸ’¾ ê²Œì„ ì €ì¥ (Save)</button>
                        <!-- <button class="btn" id="btn-lang" style="width:100%; padding:12px;">ğŸŒ Language: KO</button> -->
                        <div style="border-top:1px solid var(--glass-border); margin:10px 0;"></div>
                        <button class="btn" id="btn-hard-reset" style="width:100%; padding:12px; border-color:var(--accent); color:var(--accent);">âš ï¸ ë°ì´í„° ì´ˆê¸°í™” (Hard Reset)</button>
                    </div>

                    <div style="margin-top:20px;">
                        <button class="btn btn-sm" id="modal-close">ë‹«ê¸°</button>
                    </div>
                    
                    <div style="margin-top:20px; font-size:10px; color:var(--text-muted);">
                        Kimchi Invasion v0.68<br>
                        Powered by ClickSurvivor Universe
                    </div>
                </div>
             `),e.innerHTML=s,document.body.appendChild(e),t==="SETTINGS"&&(e.querySelector("#btn-save-manual").addEventListener("click",()=>{this.game.save(),this.showToast("âœ… ê²Œì„ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")}),e.querySelector("#btn-hard-reset").addEventListener("click",()=>{confirm(`ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³  ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)&&confirm("ì§„ì§œë¡œ ì‚­ì œí•©ë‹ˆê¹Œ? í´ë¼ìš°ë“œ ì €ì¥ì´ ì—†ë‹¤ë©´ ë³µêµ¬ê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.")&&(this.game.isResetting=!0,localStorage.removeItem("kimchi_invasion_save_v1"),localStorage.clear(),window.location.reload())})),e.querySelector("#modal-close").addEventListener("click",()=>{e.remove()})}update(){const t=this.game.cash-this.displayCash;if(Math.abs(t)<1?this.displayCash=this.game.cash:this.displayCash+=t*.15,this.els.cash.textContent=Math.floor(this.displayCash).toLocaleString()+"ì›",t>.1?this.els.cash.classList.add("gaining"):this.els.cash.classList.remove("gaining"),this.els.enzymeContainer&&(this.game.completedResearch.includes("fermentation_lab")||this.game.enzyme>0)?(this.els.enzymeContainer.style.display="flex",this.els.enzyme&&(this.els.enzyme.textContent=Math.floor(this.game.enzyme).toLocaleString())):this.els.enzymeContainer&&(this.els.enzymeContainer.style.display="none"),this.els.amContainer&&(this.game.am>0||this.game.amUpgrades.length>0)){this.els.amContainer.style.display="flex",this.els.am&&(this.els.am.textContent=Math.floor(this.game.am).toLocaleString());const s=document.getElementById("am-upgrades-container");s&&(s.style.display="block")}else this.els.amContainer&&(this.els.amContainer.style.display="none");this.els.nextLineCost&&(this.els.nextLineCost.textContent=`(ë¹„ìš©: ${this.game.getLineCost().toLocaleString()}ì›)`);const i=document.getElementById("stat-ev");i&&(i.textContent=Math.floor(this.game.getEnterpriseValue()).toLocaleString()+"ì›",document.getElementById("stat-cash-val").textContent=Math.floor(this.game.cash).toLocaleString()+"ì›",document.getElementById("stat-inv-val").textContent=Math.floor(this.game.getInventoryValue()).toLocaleString()+"ì›",document.getElementById("stat-asset-val").textContent=Math.floor(this.game.getAssetValue()).toLocaleString()+"ì›");const e=Date.now();(!this.lastLogUpdate||e-this.lastLogUpdate>5e3)&&(this.renderLogbook(),this.lastLogUpdate=e),this.game.lines.forEach(s=>{if(!s.productId)return;const o=this.game.productInventory[s.productId],a=document.getElementById(`prog-fill-prod-${s.id}`);a&&s.prodAccumulator!==void 0&&(a.style.width=Math.min(s.prodAccumulator*100,100)+"%");const c=document.getElementById(`prog-fill-sell-${s.id}`);if(c&&s.sellAccumulator!==void 0&&(c.style.width=Math.min(s.sellAccumulator*100,100)+"%"),o){const l=o.keep||0,d=o.sell||0,r=o.cap||100,p=document.getElementById(`val-keep-status-${s.id}`),h=document.getElementById(`val-sell-logi-status-${s.id}`),u=document.getElementById(`val-sell-status-${s.id}`);p&&(p.textContent=Math.floor(l).toLocaleString()),h&&(h.textContent=Math.floor(d).toLocaleString()),u&&(u.textContent=Math.floor(d).toLocaleString());const f=document.getElementById(`val-keep-${s.id}`),g=document.getElementById(`val-sell-${s.id}`),v=document.getElementById(`val-sell-logi-${s.id}`);f&&(f.textContent=Math.floor(l).toLocaleString()),g&&(g.textContent=Math.floor(d).toLocaleString()),v&&(v.textContent=Math.floor(d).toLocaleString());const y=document.getElementById(`fill-keep-${s.id}`),k=document.getElementById(`fill-sell-${s.id}`),w=document.getElementById(`fill-sell-logi-${s.id}`);y&&(y.style.height=Math.min(l/r*100,100)+"%"),k&&(k.style.height=Math.min(d/r*100,100)+"%"),w&&(w.style.height=Math.min(d/r*100,100)+"%");const L=document.getElementById(`btn-ship-${s.id}`),S=document.getElementById(`btn-sell-${s.id}`);if(L&&(l>0?L.classList.add("cta-glow"):L.classList.remove("cta-glow")),S&&(d>0?S.classList.add("cta-glow"):S.classList.remove("cta-glow")),l+d>=r){const _=document.getElementById(`card-prod-${s.id}`);_&&!_.classList.contains("status-halted")&&_.classList.add("status-halted")}else{const _=document.getElementById(`card-prod-${s.id}`);_&&_.classList.remove("status-halted")}}})}renderSlotHTML(t,i,e){if(e&&n[e]){const s=n[e];return`<button class="btn btn-slot equipped ${`tier-${s.tier||1}`}" data-line="${t}" data-type="${i}">${s.name}</button>`}else return`<button class="btn btn-slot empty" data-line="${t}" data-type="${i}">âœš</button>`}bindSlotEvent(t,i,e){t.querySelectorAll(".btn-slot").forEach(o=>{o.dataset.line==i&&o.dataset.type===e&&(o.onclick=a=>{a.stopPropagation(),this.showPopover(a,i,e)})})}showPopover(t,i,e){this.hidePopover();const s=document.createElement("div");s.className="popover animate-fade-in",s.id="active-popover";const a=this.game.lines.find(r=>r.id===i).slots[e];let c=`<div class="popover-title">${e} ì•„ì´í…œ ê´€ë¦¬ <button id="close-pop" style="float:right; background:none; border:none; color:#fff;">&times;</button></div>`;Object.values(n).filter(r=>r.type===e).forEach(r=>{const p=(this.game.itemInventory[r.id]||0)>0,h=a===r.id,u=this.game.cash>=r.cost,f=this.getEffectString(r);c+=`
                <div class="item-row ${h?"active":""}">
                    <div class="item-info">
                        <strong>${r.name}</strong> 
                        <span>Tier ${r.tier} - ${r.desc}</span>
                        <div style="font-size:11px; color:#10b981;">[íš¨ê³¼] ${f}</div>
                        <div style="font-size:10px; color:#aaa; margin-top:2px;">
                            ${r.cost>0?r.cost.toLocaleString()+"ì›":"ë¬´ë£Œ"} 
                            ${!p&&!u?"(ìê¸ˆ ë¶€ì¡±)":""}
                        </div>
                    </div>
                    <div class="item-actions">
                        ${h?`<button class="btn btn-xs btn-unequip" data-id="${r.id}" disabled>ì¥ì°©ì¤‘</button>`:p?`<button class="btn btn-xs btn-equip" data-id="${r.id}">ì¥ì°©</button>`:`<button class="btn btn-xs btn-buy" data-id="${r.id}" ${u?"":"disabled"}>êµ¬ë§¤</button>`}
                    </div>
                </div>
            `}),s.innerHTML=c,document.body.appendChild(s);let l=t.clientX+10,d=t.clientY+10;l+300>window.innerWidth&&(l=window.innerWidth-300),d+400>window.innerHeight&&(d=window.innerHeight-400),s.style.left=l+"px",s.style.top=d+"px",s.querySelectorAll(".btn-buy").forEach(r=>r.addEventListener("click",p=>{p.stopPropagation();const h=r.dataset.id;this.game.buyItem(h)&&(this.showPopover(t,i,e),this.update())})),s.querySelectorAll(".btn-equip").forEach(r=>r.addEventListener("click",()=>{this.game.equipItem(i,e,r.dataset.id),this.hidePopover(),this.renderLines(),this.update()})),s.querySelector("#close-pop").addEventListener("click",()=>this.hidePopover()),setTimeout(()=>{const r=p=>{s.contains(p.target)||(this.hidePopover(),window.removeEventListener("click",r))};window.addEventListener("click",r)},100)}showProductPicker(t,i){this.hidePopover();const e=document.createElement("div");e.className="popover animate-fade-in",e.id="active-popover";let s='<div class="popover-title">ìƒì‚° í’ˆëª© ì„ íƒ</div>';Object.values(b).forEach(o=>{s+=`
                <div class="item-row">
                    <div class="item-info">
                        <strong>${o.name}</strong>
                        <span>${o.desc}</span>
                    </div>
                    <button class="btn btn-xs btn-buy" data-id="${o.id}">í• ë‹¹</button>
                </div>
            `}),s+='<button class="btn btn-sm btn-close-pop">ë‹«ê¸°</button>',e.innerHTML=s,document.body.appendChild(e),e.style.left=Math.min(t.clientX,window.innerWidth-320)+"px",e.style.top=Math.min(t.clientY,window.innerHeight-350)+"px",e.querySelectorAll(".btn-buy").forEach(o=>o.addEventListener("click",()=>{this.game.assignProduct(i,o.dataset.id),this.hidePopover(),this.renderLines(),this.update()})),e.querySelector(".btn-close-pop").addEventListener("click",()=>this.hidePopover())}hidePopover(){const t=document.getElementById("active-popover");t&&t.remove()}showAutoSaveIndicator(){this.els.autoSave||(this.els.autoSave=document.createElement("div"),this.els.autoSave.id="auto-save-indicator",document.body.appendChild(this.els.autoSave)),this.els.autoSave.classList.add("saving"),setTimeout(()=>this.els.autoSave.classList.remove("saving"),1e3)}renderResearch(){const t=this.els.researchList;if(!t)return;t.innerHTML="",Object.values(M).forEach(s=>{const o=this.game.completedResearch.includes(s.id);if(!(!s.prereq||this.game.completedResearch.includes(s.prereq))&&!o)return;const c=document.createElement("div");c.className=`card res-card ${o?"completed":""}`;let l="";o||(s.cost&&(l+=`â‚©${s.cost.toLocaleString()} `),s.costItems&&(l+=Object.entries(s.costItems).map(([d,r])=>`${b[d].emoji}${r}`).join(", ")),s.costEnzyme&&(l+=`ğŸ§ª${s.costEnzyme}`)),c.innerHTML=`
                <div class="card-comp-header">
                    <span class="card-comp-title">${s.name}</span>
                    <span class="card-comp-badge">${o?"COMPLETED":"RESEARCH"}</span>
                </div>
                <div class="card-body">
                    <p style="font-size:12px; color:var(--text-muted); margin-bottom:10px;">${s.desc}</p>
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <span style="font-size:11px; color:var(--accent-primary);">${o?"ê¸°ìˆ  í™•ë³´ ì™„ë£Œ":l}</span>
                        ${o?"":`<button class="btn btn-sm btn-research-buy" data-id="${s.id}">ì—°êµ¬ê°œì‹œ</button>`}
                    </div>
                </div>
            `,o||(c.querySelector(".btn-research-buy").onclick=()=>{this.game.buyResearch(s.id)?(this.renderResearch(),this.renderLines(),this.update()):this.showToast("ìì›ì´ë‚˜ ì„ í–‰ ì—°êµ¬ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.","error")}),t.appendChild(c)});const i=document.createElement("h3");i.className="section-title",i.textContent="Extra-Terrestrial Lab",i.id="am-upgrades-container",i.style.display=this.game.am>0||this.game.amUpgrades.length>0?"block":"none",t.appendChild(i);const e=document.createElement("div");e.id="am-upgrade-list",t.appendChild(e),this.renderAMUpgrades()}renderStats(){const t=this.els.statsList;t&&(t.innerHTML=`
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-label">ê¸°ì—…ê°€ì¹˜</span>
                    <span class="stat-val" id="stat-ev">0ì›</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">ë³´ìœ í˜„ê¸ˆ</span>
                    <span class="stat-val" id="stat-cash-val">0ì›</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">ì¬ê³ ê°€ì¹˜</span>
                    <span class="stat-val" id="stat-inv-val">0ì›</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">ì„¤ë¹„ìì‚°</span>
                    <span class="stat-val" id="stat-asset-val">0ì›</span>
                </div>
            </div>
            
            <h3 class="section-title">Achievements</h3>
            <div class="achievement-grid" id="achievement-grid" style="display:flex; flex-wrap:wrap; gap:5px; margin-bottom:10px;"></div>
            <div id="achievement-detail" style="font-size:11px; color:var(--text-muted); margin-bottom:20px; min-height:30px;"></div>
            
            <h3 class="section-title">Logbook</h3>
            <div id="logbook-list" class="logbook-list"></div>
        `,this.renderAchievements(),this.renderLogbook())}getEffectString(t){if(!t||!t.effects)return"No Effect";const i=[];return t.effects.prodSpeed&&i.push(`ìƒì‚°ì†ë„ +${t.effects.prodSpeed}`),t.effects.batch&&i.push(`ë°°ì¹˜ëŸ‰ +${t.effects.batch}`),t.effects.moveSpeed&&i.push(`ë¬¼ë¥˜ì†ë„ +${t.effects.moveSpeed}`),t.effects.moveBatch&&i.push(`ì´ì†¡ëŸ‰ +${t.effects.moveBatch}`),t.effects.sellSpeed&&i.push(`íŒë§¤ì†ë„ +${t.effects.sellSpeed}`),t.effects.sellAmount&&i.push(`íŒë§¤ëŸ‰ +${t.effects.sellAmount}`),i.length>0?i.join(", "):"íŠ¹ìˆ˜ íš¨ê³¼"}spawnParticles(t,i,e){for(let s=0;s<8;s++){const o=document.createElement("div");o.className="particle",o.style.backgroundColor=e,o.style.left=t+"px",o.style.top=i+"px";const a=(Math.random()-.5)*100,c=(Math.random()-.5)*100;o.style.setProperty("--tx",`${a}px`),o.style.setProperty("--ty",`${c}px`),document.body.appendChild(o),setTimeout(()=>o.remove(),800)}}animateConveyor(t,i,e){const s=document.getElementById(`conveyor-${e}-${t}`);if(!s)return;const o=s.querySelector(".conveyor-track");if(!o)return;const a=document.createElement("div");a.className="conveyor-item",a.textContent=i,o.appendChild(a),setTimeout(()=>a.remove(),2e3)}}window.addEventListener("DOMContentLoaded",()=>{const m=new A,t=new C(m);window.game=m,window.ui=t,m.init(),t.init();let i=performance.now();function e(s){const o=(s-i)/1e3;if(i=s,m.tick(o),t.update(),m.hasAutomatedChanges){const a=Date.now();(!m.lastSaveTime||a-m.lastSaveTime>1e3)&&(m.save(),m.lastSaveTime=a,m.hasAutomatedChanges=!1)}requestAnimationFrame(e)}requestAnimationFrame(e)});
