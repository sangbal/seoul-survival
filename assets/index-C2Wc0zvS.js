import{createClient as Y}from"https://esm.sh/@supabase/supabase-js@2.49.1";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const D={"hub.brand.tag":"오늘도 서울에서 살아남기","hub.header.about":"소개","hub.header.account":"계정","hub.header.login":"로그인","hub.hero.badge":"FEATURED","hub.hero.subtitle":"서울 생존 클리커 — 노동·투자·승진, 그리고 시장 이벤트","hub.hero.cta.play":"플레이","hub.hero.cta.details":"자세히","hub.hero.ssoNote":"계정 연동(저장·업적·랭킹)은 준비 중입니다.","hub.about.title":"한 판 요약","hub.about.lead":"클릭(노동)으로 시작해 투자로 성장하고, 승진과 이벤트로 다음 목표가 열립니다.","hub.about.b1":"클릭(노동)으로 시작해 투자로 성장","hub.about.b2":"승진하며 새로운 단계와 보상을 해금","hub.about.b3":"시장 이벤트로 타이밍 플레이","hub.about.b4":"자동 저장으로 언제든 이어하기","hub.screenshots.title":"스크린샷","hub.screenshots.cap1":"도트 감성의 서울 야경 속에서, 오늘도 생존.","hub.screenshots.cap2":"알바에서 CEO까지 — 승진이 다음 행동을 안내합니다.","hub.screenshots.cap3":"투자와 이벤트로 “지금”의 선택을 만들어요.","hub.screenshots.alt1":"Seoul Survival 도트 야경 배경","hub.screenshots.alt2":"Seoul Survival 도트 야경 배경","hub.screenshots.alt3":"Seoul Survival 공유 이미지","hub.account.title":"계정 하나로 이어하기","hub.account.head":"저장·통계·업적·리더보드를 한 계정에","hub.account.body":"허브와 모든 게임에서 공통으로 동작하는 소셜 로그인으로 여러 기기에서 진행 상황을 동기화하세요.","hub.account.faq.q1":"로그인하면 무엇을 할 수 있나요?","hub.account.faq.a1":"클라우드 저장으로 여러 기기에서 진행 상황을 동기화할 수 있습니다. 탭을 닫을 때 자동으로 클라우드에 저장됩니다.","hub.account.faq.q2":"로그인 전엔 저장이 안 되나요?","hub.account.faq.a2":"브라우저에 로컬 저장은 5초마다 자동으로 됩니다. 로그인하면 클라우드 저장도 사용할 수 있어 기기 간 이어하기가 가능합니다.","hub.footer.note":"루트(/)는 허브, 게임은 /seoulsurvival/에서 플레이합니다.","hub.footer.terms":"이용약관","hub.footer.privacy":"개인정보처리방침","hub.footer.contact":"문의","hub.footer.game.title":"게임","hub.footer.game.play":"Seoul Survival 플레이","hub.footer.game.about":"게임 소개","hub.footer.game.screenshots":"스크린샷","hub.footer.support.title":"지원","hub.footer.support.account":"계정 관리","hub.footer.support.faq":"자주 묻는 질문","hub.footer.legal.title":"법적 고지","hub.toast.loginSoon":"로그인(SSO) 준비 중","hub.toast.langKo":"언어: 한국어"},F={"hub.brand.tag":"Survive Seoul, one click at a time","hub.header.about":"About","hub.header.account":"Account","hub.header.login":"Sign in","hub.hero.badge":"FEATURED","hub.hero.subtitle":"A Seoul survival clicker — work, invest, rank up, and time the market","hub.hero.cta.play":"Play","hub.hero.cta.details":"Details","hub.hero.ssoNote":"Account sync (saves, achievements, leaderboards) is coming soon.","hub.about.title":"At a glance","hub.about.lead":"Start with work, grow through investing, and unlock goals through ranks and events.","hub.about.b1":"Start with work, grow through investing","hub.about.b2":"Rank up to unlock new stages and rewards","hub.about.b3":"Time your moves with market events","hub.about.b4":"Auto-save so you can pick up anytime","hub.screenshots.title":"Screenshots","hub.screenshots.cap1":"Survive another night in pixel-lit Seoul.","hub.screenshots.cap2":"From part-time to CEO — ranks guide your next move.","hub.screenshots.cap3":"Investing and events create meaningful choices “right now”.","hub.screenshots.alt1":"Seoul Survival pixel night scene","hub.screenshots.alt2":"Seoul Survival pixel night scene","hub.screenshots.alt3":"Seoul Survival share image","hub.account.title":"Continue anywhere with one account","hub.account.head":"Saves, stats, achievements, and leaderboards—unified","hub.account.body":"Sign in with social login to sync your progress across devices on the hub and all games.","hub.account.faq.q1":"What can I do when signed in?","hub.account.faq.a1":"You can sync your progress across devices with cloud saves. Your progress is automatically saved to the cloud when you close the tab.","hub.account.faq.q2":"Do I lose progress without signing in?","hub.account.faq.a2":"Your browser saves locally every 5 seconds. When signed in, you can also use cloud saves to continue on any device.","hub.footer.note":"The hub lives at /, the game is at /seoulsurvival/.","hub.footer.terms":"Terms","hub.footer.privacy":"Privacy","hub.footer.contact":"Contact","hub.footer.game.title":"Games","hub.footer.game.play":"Play Seoul Survival","hub.footer.game.about":"About","hub.footer.game.screenshots":"Screenshots","hub.footer.support.title":"Support","hub.footer.support.account":"Account","hub.footer.support.faq":"FAQ","hub.footer.legal.title":"Legal","hub.toast.loginSoon":"SSO is coming soon","hub.toast.langEn":"Language: English"},B="clicksurvivor_lang",v={ko:D,en:F},W=Object.keys(v);function A(e){const t=String(e||"").toLowerCase();return W.includes(t)?t:null}function K(){const e=new URL(window.location.href);return A(e.searchParams.get("lang"))}function G(){const e=K();if(e)return e;const t=A(localStorage.getItem(B));return t||(String(navigator.language||"").toLowerCase().startsWith("ko")?"ko":"en")}function P(e){const t=A(e)||"ko";document.documentElement.lang=t;const n=v[t]||v.ko;document.querySelectorAll("[data-i18n]").forEach(r=>{const i=r.getAttribute("data-i18n");if(!i)return;const c=n[i];typeof c=="string"&&(r.textContent=c)}),document.querySelectorAll("[data-i18n-alt]").forEach(r=>{const i=r.getAttribute("data-i18n-alt");if(!i)return;const c=n[i];typeof c=="string"&&r.setAttribute("alt",c)}),localStorage.setItem(B,t);const a=new URL(window.location.href);a.searchParams.set("lang",t),history.replaceState(null,"",a.toString());const o=document.querySelector("#langSelect");return o&&(o.value=t),t}const L=e=>document.querySelector(e);function S(e){const t=L("#toast");t&&(t.textContent=e,t.classList.add("show"),window.clearTimeout(S._t),S._t=window.setTimeout(()=>t.classList.remove("show"),1400))}function V(){const e=L("#version");e&&(e.textContent="1.0.0")}function J(){const e=L("#langSelect");e&&e.addEventListener("change",t=>{const n=String(t.target.value||"").toLowerCase(),a=P(n);S(a==="ko"?"언어: 한국어":"Language: English")})}P(G());V();initLoginBtn();J();const O={VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im52eGR3YWNxbWlvZnBlbm51a2VvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4OTMwNDYsImV4cCI6MjA4MTQ2OTA0Nn0.v2UoOk7xdmascY10Oy8fT3kYTWm9gWKSC9C4wH4nwP4",VITE_SUPABASE_URL:"https://nvxdwacqmiofpennukeo.supabase.co"},T=typeof import.meta<"u"&&O?O:{},m=T.VITE_SUPABASE_URL??"",y=T.VITE_SUPABASE_ANON_KEY??"",$="clicksurvivor-auth";function q(){return typeof m=="string"&&typeof y=="string"&&m.startsWith("https://")&&m.length>8&&y.length>0}function M(){return q()?Y(m,y,{auth:{storageKey:$,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}):null}let g=null;function d(){return g||(g=M(),g)}function p(){return q()}async function j(){const e=d();if(!e)return{ok:!1,reason:"not_configured"};if(!(typeof location<"u"&&/[?&]code=/.test(location.search)))return{ok:!0,exchanged:!1};try{const{error:n}=await e.auth.exchangeCodeForSession(location.href);if(n)return{ok:!1,reason:"exchange_failed",error:n};const a=new URL(location.href);return a.searchParams.delete("code"),a.searchParams.delete("state"),history.replaceState(null,"",a.toString()),{ok:!0,exchanged:!0}}catch(n){return{ok:!1,reason:"exchange_failed",error:n}}}async function Z(){const e=d();if(!e)return null;const{data:t}=await e.auth.getUser();return(t==null?void 0:t.user)||null}async function z(e){const t=d();if(!t)return{ok:!1,reason:"not_configured"};const n=location.origin+location.pathname+location.search.replace(/([?&])code=[^&]+(&|$)/,"$1").replace(/[?&]state=[^&]+(&|$)/,"$1"),{error:a}=await t.auth.signInWithOAuth({provider:e,options:{redirectTo:n}});return a?{ok:!1,reason:"oauth_failed",error:a}:{ok:!0}}async function Q(){const e=d();if(!e)return{ok:!1,reason:"not_configured"};const{error:t}=await e.auth.signOut();return t?{ok:!1,reason:"signout_failed",error:t}:{ok:!0}}function X(e){const t=d();if(!t)return()=>{};const{data:n}=t.auth.onAuthStateChange((a,o)=>{e((o==null?void 0:o.user)||null)});return()=>n.subscription.unsubscribe()}function H(e){var t,n,a,o;return e?((t=e.user_metadata)==null?void 0:t.full_name)||((n=e.user_metadata)==null?void 0:n.name)||((a=e.user_metadata)==null?void 0:a.preferred_username)||e.email||((o=e.id)==null?void 0:o.slice(0,8)):null}async function tt(e){const{scope:t="hub",providerButtons:n=[],defaultProvider:a="google",loginBtn:o,logoutBtn:r,userLabel:i,statusLabel:c,toast:k}=e||{},h=typeof k=="function"?k:()=>{};await j();function E(u){const s=H(u);i&&(i.textContent=s||(t==="hub"?"Guest":"게스트"),i.hidden=!1),c&&(p()?s?(c.textContent=t==="hub"?"Signed in":"로그인됨",c.style.color="rgba(52, 211, 153, .95)"):(c.textContent=t==="hub"?"Not signed in":"로그인 안 됨",c.style.color="rgba(148, 163, 184, .95)"):(c.textContent=t==="hub"?"Guest mode (로그인 준비 중)":"게스트 모드 (로그인 준비 중)",c.style.color="rgba(148, 163, 184, .95)")),o&&(o.hidden=!!s),r&&(r.hidden=!s);const f=document.getElementById("authProviderButtons");f&&(f.style.display=s?"none":"flex");const b=document.getElementById("logoutButtonContainer");b&&(b.style.display=s?"flex":"none");const I=document.getElementById("authUserInfo");I&&(I.style.display=s?"block":"none");const C=document.getElementById("cloudSaveSection");C&&(C.style.display=s?"block":"none");const U=document.getElementById("guestSaveInfo");U&&(U.style.display=s?"none":"block")}const x=await Z();E(x);const N=X(u=>E(u));async function _(u){if(!p()){h("현재는 게스트 모드입니다. 로그인 기능은 준비 중입니다.");return}h(t==="hub"?"Redirecting…":"이동 중…"),(await z(u)).ok||h(t==="hub"?"Login failed":"로그인 실패")}async function R(){if(!p())return;(await Q()).ok?h(t==="hub"?"Signed out":"로그아웃"):h(t==="hub"?"Logout failed":"로그아웃 실패")}return o&&o.addEventListener("click",u=>{u.preventDefault(),_(a)}),n.forEach(u=>{var f;const s=(f=u==null?void 0:u.dataset)==null?void 0:f.authProvider;s&&u.addEventListener("click",b=>{b.preventDefault(),_(s)})}),r&&r.addEventListener("click",u=>{u.preventDefault(),R()}),{off:N}}function l(e){return document.querySelector(e)}function w(e){const t=l("#toast");t&&(t.textContent=e,t.classList.add("show"),window.clearTimeout(w._t),w._t=window.setTimeout(()=>t.classList.remove("show"),1400))}function et(){return location.pathname.includes("/seoulsurvival/")?"game":"hub"}window.addEventListener("DOMContentLoaded",async()=>{const e=l("#loginBtn")||l("#authLoginBtn"),t=l("#logoutBtn")||l("#authLogoutBtn"),n=l("#authUserLabel"),a=l("#authStatusLabel"),o=Array.from(document.querySelectorAll("[data-auth-provider]"));!e&&o.length===0||await tt({scope:et(),providerButtons:o,defaultProvider:"google",loginBtn:e,logoutBtn:t,userLabel:n,statusLabel:a,toast:w})});
