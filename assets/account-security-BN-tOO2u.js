const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ui-BV5JZo7K.js","./preload-helper-Bo3zgFBI.js","./preload-helper-DFlHEO2w.css","./core-Cq47966W.js","./supabaseClient-DfMY2obf.js"])))=>i.map(i=>d[i]);
import"./modulepreload-polyfill-B5Qt9EMX.js";import{_ as g}from"./preload-helper-Bo3zgFBI.js";/* empty css               *//* empty css            */import{r as U,a as D}from"./footer-BCqG-Vg5.js";function b(p,_="info"){const r=document.createElement("div");r.textContent=p,r.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg-panel);
    color: var(--text);
    padding: 12px 24px;
    border-radius: 8px;
    border: 1px solid var(--border);
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    z-index: 10000;
    font-size: 14px;
  `,document.body.appendChild(r),setTimeout(()=>{r.style.opacity="0",r.style.transition="opacity 0.3s",setTimeout(()=>r.remove(),300)},2e3)}document.addEventListener("DOMContentLoaded",async()=>{const p=document.getElementById("header-mount"),_=document.getElementById("footer-mount");if(p){U(p);try{const{initAuthUI:e}=await g(async()=>{const{initAuthUI:t}=await import("./ui-BV5JZo7K.js");return{initAuthUI:t}},__vite__mapDeps([0,1,2]),import.meta.url),{getUser:s,onAuthStateChange:a}=await g(async()=>{const{getUser:t,onAuthStateChange:l}=await import("./core-Cq47966W.js");return{getUser:t,onAuthStateChange:l}},__vite__mapDeps([3,1,2,4]),import.meta.url),o=document.getElementById("headerLoginBtn"),i=document.getElementById("headerLogoutBtn"),c=document.getElementById("headerAccountMenu"),m=document.getElementById("headerAccountNicknameMobile");if(!o&&!i)return;o&&(o.style.display="block"),c&&c.style.setProperty("display","none","important");async function y(t){var v,C,E,I,P,A,B,L,k;const l=!!t;if(o&&(o.style.display=l?"none":"block"),c&&(l?c.style.setProperty("display","block","important"):c.style.setProperty("display","none","important")),m&&l)try{const{getUserProfile:x}=await g(async()=>{const{getUserProfile:h}=await import("./core-Cq47966W.js");return{getUserProfile:h}},__vite__mapDeps([3,1,2,4]),import.meta.url),u=await x("seoulsurvival");if(u.success&&((v=u.user)!=null&&v.nickname))m.textContent=u.user.nickname;else{const h=((C=t==null?void 0:t.user_metadata)==null?void 0:C.full_name)||((E=t==null?void 0:t.user_metadata)==null?void 0:E.name)||((I=t==null?void 0:t.user_metadata)==null?void 0:I.preferred_username)||((P=t==null?void 0:t.email)==null?void 0:P.split("@")[0])||"Guest";m.textContent=h}}catch(x){console.warn("[Header] Failed to get nickname:",x);const u=((A=t==null?void 0:t.user_metadata)==null?void 0:A.full_name)||((B=t==null?void 0:t.user_metadata)==null?void 0:B.name)||((L=t==null?void 0:t.user_metadata)==null?void 0:L.preferred_username)||((k=t==null?void 0:t.email)==null?void 0:k.split("@")[0])||"Guest";m.textContent=u}}const d=await s();await y(d),await e({scope:"hub",providerButtons:[],defaultProvider:"google",loginBtn:o,logoutBtn:i,userLabel:m,statusLabel:null,toast:t=>console.log("[Header]",t)}),a(async t=>{await y(t)})}catch(e){console.warn("[Header] Auth init failed:",e)}}_&&D(_);const{getUser:r,signOut:M}=await g(async()=>{const{getUser:e,signOut:s}=await import("./core-Cq47966W.js");return{getUser:e,signOut:s}},__vite__mapDeps([3,1,2,4]),import.meta.url),f=await r(),w=!!f;function T(){const e=document.getElementById("current-device"),s=document.getElementById("current-location"),a=document.getElementById("current-last-activity");if(!w){e&&(e.textContent="-"),s&&(s.textContent="-"),a&&(a.textContent="-");return}const o=navigator.userAgent;let i="알 수 없음";if(/Mobile|Android|iPhone|iPad/.test(o)?/iPhone/.test(o)?i="iPhone":/iPad/.test(o)?i="iPad":/Android/.test(o)?i="Android 기기":i="모바일 기기":i="데스크톱",e&&(e.textContent=i),s&&(s.textContent="현재 위치"),f!=null&&f.last_sign_in_at)try{const c=new Date(f.last_sign_in_at),y=new Date-c,d=Math.floor(y/6e4);let t="방금 전";d<1?t="방금 전":d<60?t=`${d}분 전`:d<1440?t=`${Math.floor(d/60)}시간 전`:t=`${Math.floor(d/1440)}일 전`,a&&(a.textContent=t)}catch{a&&(a.textContent="알 수 없음")}else a&&(a.textContent="방금 전")}T();const n=document.getElementById("logout-btn");n&&(w?(n.disabled=!1,n.textContent="모든 기기에서 로그아웃",n.addEventListener("click",async()=>{if(confirm("로그아웃하시겠습니까?")){n.disabled=!0,n.textContent="로그아웃 중...";try{(await M()).ok?(b("로그아웃되었습니다","success"),setTimeout(()=>{window.location.href="../../"},500)):(b("로그아웃에 실패했습니다","error"),n.disabled=!1,n.textContent="모든 기기에서 로그아웃")}catch(e){console.error("Logout error:",e),b("로그아웃 중 오류가 발생했습니다","error"),n.disabled=!1,n.textContent="모든 기기에서 로그아웃"}}})):(n.disabled=!0,n.textContent="로그인 필요"))});
