import"./preload-helper-WPMeT1xN.js";/* empty css            */import{g as p}from"./supabaseClient-BZSWgoCJ.js";document.addEventListener("DOMContentLoaded",async()=>{const w=document.getElementById("loading-state"),u=document.getElementById("error-state"),f=document.getElementById("error-message"),d=document.getElementById("retry-btn"),a=new URLSearchParams(window.location.search),c=new URLSearchParams(window.location.hash.substring(1)),g=a.get("code")||c.get("code"),h=c.get("access_token"),i=a.get("error")||c.get("error"),m=a.get("error_description")||c.get("error_description")||i,l=a.get("next")||"/";if(i){r(`로그인 실패: ${m}`),console.error("Login error params:",i,m);return}if(!g&&!h){console.warn("No login code or access token found. URL:",window.location.href),r("로그인 정보를 찾을 수 없습니다. 다시 로그인해주세요.");return}try{const o=await p();if(!o){r("인증 서비스가 설정되지 않았습니다.");return}let t=null,n=null;if(g){console.log("Processing PKCE flow with code...");const{data:e,error:s}=await o.auth.exchangeCodeForSession(window.location.href);t=e,n=s}else if(h){console.log("Processing Implicit flow with access_token...");const{data:e,error:s}=await o.auth.getSession();t=e,n=s,!(t!=null&&t.session)&&!n&&console.log("Session not detected automatically, verifying token...")}if(n){console.error("Session error:",n),r(`로그인 처리 중 오류가 발생했습니다: ${n.message}`);return}if(t!=null&&t.session){const e=new URL(window.location.href);e.searchParams.delete("code"),e.searchParams.delete("state"),e.searchParams.delete("access_token"),history.replaceState(null,"",e.pathname+e.search);const s=l.startsWith("http")?l:new URL(l,window.location.origin).pathname;setTimeout(()=>{window.location.href=s},500)}else r("세션을 가져오지 못했습니다. 다시 로그인해주세요.")}catch(o){console.error("Callback error:",o),r(`예기치 않은 오류가 발생했습니다: ${o.message}`)}function r(o){w.style.display="none",u.style.display="block",f.textContent=o}d&&d.addEventListener("click",()=>{window.location.href="/"})});
